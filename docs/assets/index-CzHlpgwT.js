(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function hi(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function h0(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(h){try{c(n.next(h))}catch(p){a(p)}}function l(h){try{c(n.throw(h))}catch(p){a(p)}}function c(h){h.done?s(h.value):i(h.value).then(o,l)}c((n=n.apply(t,e||[])).next())})}const u0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class ss extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class f0 extends ss{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class js extends ss{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ws extends ss{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Vi;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Vi||(Vi={}));class d0{constructor(e,{headers:r={},customFetch:n,region:i=Vi.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=u0(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return h0(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:c,signal:h,timeout:p}=n;let u={},{region:f}=n;f||(f=this.region);const v=new URL(`${this.url}/${r}`);f&&f!=="any"&&(u["x-region"]=f,v.searchParams.set("forceFunctionRegion",f));let d;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",d=c):typeof c=="string"?(u["Content-Type"]="text/plain",d=c):typeof FormData<"u"&&c instanceof FormData?d=c:(u["Content-Type"]="application/json",d=JSON.stringify(c)):d=c;let m=h;p&&(a=new AbortController,s=setTimeout(()=>a.abort(),p),h?(m=a.signal,h.addEventListener("abort",()=>a.abort())):m=a.signal);const S=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),o),body:d,signal:m}).catch(H=>{throw new f0(H)}),A=S.headers.get("x-relay-error");if(A&&A==="true")throw new js(S);if(!S.ok)throw new Ws(S);let T=((i=S.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),R;return T==="application/json"?R=yield S.json():T==="application/octet-stream"||T==="application/pdf"?R=yield S.blob():T==="text/event-stream"?R=S:T==="multipart/form-data"?R=yield S.formData():R=yield S.text(),{data:R,error:null,response:S}}catch(o){return{data:null,error:o,response:o instanceof Ws||o instanceof js?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var p0=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},g0=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let a=null,o=null,l=null,c=s.status,h=s.statusText;if(s.ok){var p,u;if(r.method!=="HEAD"){var f;const S=await s.text();S===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((f=r.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?o=S:o=JSON.parse(S))}const d=(p=r.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),m=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");d&&m&&m.length>1&&(l=parseInt(m[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,h="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var v;const d=await s.text();try{a=JSON.parse(d),Array.isArray(a)&&s.status===404&&(o=[],a=null,c=200,h="OK")}catch{s.status===404&&d===""?(c=204,h="No Content"):a={message:d}}if(a&&r.isMaybeSingle&&(!(a==null||(v=a.details)===null||v===void 0)&&v.includes("0 rows"))&&(a=null,c=200,h="OK"),a&&r.shouldThrowOnError)throw new p0(a)}return{error:a,data:o,count:l,status:c,statusText:h}});return this.shouldThrowOnError||(i=i.catch(s=>{var a;let o="";const l=s==null?void 0:s.cause;if(l){var c,h,p,u;const v=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",d=(h=l==null?void 0:l.code)!==null&&h!==void 0?h:"";o=`${(p=s==null?void 0:s.name)!==null&&p!==void 0?p:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(u=l==null?void 0:l.name)!==null&&u!==void 0?u:"Error"}: ${v}`,d&&(o+=` (${d})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var f;o=(f=s==null?void 0:s.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}returns(){return this}overrideTypes(){return this}},v0=class extends g0{select(t){let e=!1;const r=(t??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var a;const o=[t?"analyze":null,e?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Hs=new RegExp("[,()]");var Nr=class extends v0{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&Hs.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(n=>typeof n=="string"&&Hs.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${s}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},m0=class{constructor(t,{headers:e={},schema:r,fetch:n}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=n}select(t,e){const{head:r=!1,count:n}=e??{},i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&this.headers.append("Prefer",`count=${n}`),new Nr({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var n;const i="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((a,o)=>a.concat(Object.keys(o)),[]);if(s.length>0){const a=[...new Set(s)].map(o=>`"${o}"`);this.url.searchParams.set("columns",a.join(","))}}return new Nr({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const a="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Nr({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:e}={}){var r;const n="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Nr({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Nr({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},x0=class Ja{constructor(e,{headers:r={},schema:n,fetch:i}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new m0(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ja(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:i=!1,count:s}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([p,u])=>u!==void 0).map(([p,u])=>[p,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([p,u])=>{l.searchParams.append(p,u)})):(o="POST",c=r);const h=new Headers(this.headers);return s&&h.set("Prefer",`count=${s}`),new Nr({method:o,url:l,headers:h,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class _0{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const w0="2.89.0",y0=`realtime-js/${w0}`,Ya="1.0.0",E0="2.0.0",Vs=Ya,Gi=1e4,T0=1e3,S0=100;var Yt;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Yt||(Yt={}));var Me;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Me||(Me={}));var Rt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Rt||(Rt={}));var Ki;(function(t){t.websocket="websocket"})(Ki||(Ki={}));var ur;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ur||(ur={}));class A0{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,n;const i=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var r,n;const i=(n=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,r,n){var i,s;const a=e.topic,o=(i=e.ref)!==null&&i!==void 0?i:"",l=(s=e.join_ref)!==null&&s!==void 0?s:"",c=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},p=Object.keys(h).length===0?"":JSON.stringify(h);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const u=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+p.length,f=new ArrayBuffer(this.HEADER_LENGTH+u);let v=new DataView(f),d=0;v.setUint8(d++,this.KINDS.userBroadcastPush),v.setUint8(d++,l.length),v.setUint8(d++,o.length),v.setUint8(d++,a.length),v.setUint8(d++,c.length),v.setUint8(d++,p.length),v.setUint8(d++,r),Array.from(l,S=>v.setUint8(d++,S.charCodeAt(0))),Array.from(o,S=>v.setUint8(d++,S.charCodeAt(0))),Array.from(a,S=>v.setUint8(d++,S.charCodeAt(0))),Array.from(c,S=>v.setUint8(d++,S.charCodeAt(0))),Array.from(p,S=>v.setUint8(d++,S.charCodeAt(0)));var m=new Uint8Array(f.byteLength+n.byteLength);return m.set(new Uint8Array(f),0),m.set(new Uint8Array(n),f.byteLength),m.buffer}decode(e,r){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return r(n)}if(typeof e=="string"){const n=JSON.parse(e),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(e){const r=new DataView(e),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,i)}}_decodeUserBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(e.slice(l,l+i));l=l+i;const h=n.decode(e.slice(l,l+s));l=l+s;const p=n.decode(e.slice(l,l+a));l=l+a;const u=e.slice(l,e.byteLength),f=o===this.JSON_ENCODING?JSON.parse(n.decode(u)):u,v={type:this.BROADCAST_EVENT,event:h,payload:f};return a>0&&(v.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>r.includes(n)))}}class Za{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Se;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Se||(Se={}));const Gs=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((s,a)=>(s[a]=b0(a,t,e,i),s),{}):{}},b0=(t,e,r,n)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=r[t];return s&&!n.includes(s)?Qa(s,a):zi(a)},Qa=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return R0(e,r)}switch(t){case Se.bool:return O0(e);case Se.float4:case Se.float8:case Se.int2:case Se.int4:case Se.int8:case Se.numeric:case Se.oid:return k0(e);case Se.json:case Se.jsonb:return C0(e);case Se.timestamp:return I0(e);case Se.abstime:case Se.date:case Se.daterange:case Se.int4range:case Se.int8range:case Se.money:case Se.reltime:case Se.text:case Se.time:case Se.timestamptz:case Se.timetz:case Se.tsrange:case Se.tstzrange:return zi(e);default:return zi(e)}},zi=t=>t,O0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},k0=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},C0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},R0=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const a=t.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>Qa(e,o))}return t},I0=t=>typeof t=="string"?t.replace(" ","T"):t,eo=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class bi{constructor(e,r,n={},i=Gi){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ks;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ks||(Ks={}));class rn{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rn.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=rn.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=rn.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(s,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const p=s[c];if(p){const u=h.map(m=>m.presence_ref),f=p.map(m=>m.presence_ref),v=h.filter(m=>f.indexOf(m.presence_ref)<0),d=p.filter(m=>u.indexOf(m.presence_ref)<0);v.length>0&&(o[c]=v),d.length>0&&(l[c]=d)}else o[c]=h}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const p=e[o].map(f=>f.presence_ref),u=h.filter(f=>p.indexOf(f.presence_ref)<0);e[o].unshift(...u)}n(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(p=>p.presence_ref);c=c.filter(p=>h.indexOf(p.presence_ref)<0),e[o]=c,i(o,c,l),c.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zs;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(zs||(zs={}));var nn;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(nn||(nn={}));var jt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(jt||(jt={}));class Mr{constructor(e,r={config:{}},n){var i,s;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new bi(this,Rt.join,this.params,this.timeout),this.rejoinTimer=new Za(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Me.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rt.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new rn(this),this.broadcastEndpointURL=eo(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Me.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],h=!!this.bindings[nn.PRESENCE]&&this.bindings[nn.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,p={},u={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:h}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(jt.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(jt.CLOSED)),this.updateJoinPayload(Object.assign({config:u},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){e==null||e(jt.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,m=(v=d==null?void 0:d.length)!==null&&v!==void 0?v:0,S=[];for(let A=0;A<m;A++){const T=d[A],{filter:{event:R,schema:H,table:K,filter:k}}=T,U=f&&f[A];if(U&&U.event===R&&Mr.isFilterValueEqual(U.schema,H)&&Mr.isFilterValueEqual(U.table,K)&&Mr.isFilterValueEqual(U.filter,k))S.push(Object.assign(Object.assign({},T),{id:U.id}));else{this.unsubscribe(),this.state=Me.errored,e==null||e(jt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(jt.SUBSCRIBED);return}}).receive("error",f=>{this.state=Me.errored,e==null||e(jt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(jt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Me.joined&&e===nn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,n)}async httpSend(e,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Me.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new bi(this,Rt.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Me.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new bi(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>S0){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=Rt;if(n&&[o,l,c,h].indexOf(a)>=0&&n!==this._joinRef())return;let u=this._onMessage(a,r,n);if(r&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var v,d,m;return((v=f.filter)===null||v===void 0?void 0:v.event)==="*"||((m=(d=f.filter)===null||d===void 0?void 0:d.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(f=>f.callback(u,n)):(s=this.bindings[a])===null||s===void 0||s.filter(f=>{var v,d,m,S,A,T;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const R=f.id,H=(v=f.filter)===null||v===void 0?void 0:v.event;return R&&((d=r.ids)===null||d===void 0?void 0:d.includes(R))&&(H==="*"||(H==null?void 0:H.toLocaleLowerCase())===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const R=(A=(S=f==null?void 0:f.filter)===null||S===void 0?void 0:S.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return R==="*"||R===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof u=="object"&&"ids"in u){const v=u.data,{schema:d,table:m,commit_timestamp:S,type:A,errors:T}=v;u=Object.assign(Object.assign({},{schema:d,table:m,commit_timestamp:S,eventType:A,new:{},old:{},errors:T}),this._getPayloadRecords(v))}f.callback(u,n)})}_isClosed(){return this.state===Me.closed}_isJoined(){return this.state===Me.joined}_isJoining(){return this.state===Me.joining}_isLeaving(){return this.state===Me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Mr.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Rt.close,{},e)}_onError(e){this._on(Rt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Gs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Gs(e.columns,e.old_record)),r}}const Oi=()=>{},Pn={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},F0=[1e3,2e3,5e3,1e4],P0=1e4,N0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class D0{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gi,this.transport=null,this.heartbeatIntervalMs=Pn.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Oi,this.ref=0,this.reconnectTimer=null,this.vsn=Vs,this.logger=Oi,this.conn=null,this.sendBuffer=[],this.serializer=new A0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Ki.websocket}`,this.httpEndpoint=eo(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_0.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Yt.connecting:return ur.Connecting;case Yt.open:return ur.Open;case Yt.closing:return ur.Closing;default:return ur.Closed}}isConnected(){return this.connectionState()===ur.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Mr(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(T0,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Pn.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Yt.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Yt.open||this.conn.readyState===Yt.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Rt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([N0],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,n=!1;if(e)r=e,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:y0};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Rt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Za(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Pn.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,s,a,o,l,c,h,p,u,f;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Gi,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Pn.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:Oi,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Vs,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:v=>F0[v-1]||P0,this.vsn){case Ya:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(v,d)=>d(JSON.stringify(v)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:(v,d)=>d(JSON.parse(v));break;case E0:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:this.serializer.encode.bind(this.serializer),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var un=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function L0(t,e,r){const n=new URL(e,t);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function B0(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function M0(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:a}){const o=L0(t.baseUrl,n,i),l=await B0(t.auth),c=await e(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...a},body:s?JSON.stringify(s):void 0}),h=await c.text(),p=(c.headers.get("content-type")||"").includes("application/json"),u=p&&h?JSON.parse(h):h;if(!c.ok){const f=p?u:void 0,v=f==null?void 0:f.error;throw new un((v==null?void 0:v.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:f})}return{status:c.status,headers:c.headers,data:u}}}}function Nn(t){return t.join("")}var U0=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Nn(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Nn(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Nn(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Nn(t.namespace)}`}),!0}catch(e){if(e instanceof un&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof un&&r.status===409)return;throw r}}};function Ar(t){return t.join("")}var $0=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ar(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof un&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof un&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},j0=class{constructor(t){var n;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=M0({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(n=t.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new U0(this.client,e),this.tableOps=new $0(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},ui=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function ke(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var W0=class extends ui{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},qi=class extends ui{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const as=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),H0=()=>Response,Xi=t=>{if(Array.isArray(t))return t.map(r=>Xi(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Xi(n)}),e},V0=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},G0=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function fn(t){"@babel/helpers - typeof";return fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(t)}function K0(t,e){if(fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function z0(t){var e=K0(t,"string");return fn(e)=="symbol"?e:e+""}function q0(t,e,r){return(e=z0(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ce(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qs(Object(r),!0).forEach(function(n){q0(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const ki=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},X0=async(t,e,r)=>{t instanceof await H0()&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const i=t.status||500,s=(n==null?void 0:n.statusCode)||i+"";e(new W0(ki(n),i,s))}).catch(n=>{e(new qi(ki(n),n))}):e(new qi(ki(t),t))},J0=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(V0(n)?(i.headers=ce({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),ce(ce({},i),r))};async function Sn(t,e,r,n,i,s){return new Promise((a,o)=>{t(r,J0(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>X0(l,o,n))})}async function dn(t,e,r,n){return Sn(t,"GET",e,r,n)}async function Ct(t,e,r,n,i){return Sn(t,"POST",e,n,i,r)}async function Ji(t,e,r,n,i){return Sn(t,"PUT",e,n,i,r)}async function Y0(t,e,r,n){return Sn(t,"HEAD",e,ce(ce({},r),{},{noResolveJson:!0}),n)}async function os(t,e,r,n,i){return Sn(t,"DELETE",e,n,i,r)}var Z0=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ke(e))return{data:null,error:e};throw e}}};let to;to=Symbol.toStringTag;var Q0=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[to]="BlobDownloadBuilder",this.promise=null}asStream(){return new Z0(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ke(e))return{data:null,error:e};throw e}}};const ec={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var tc=class{constructor(t,e={},r,n){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=as(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,n){var i=this;try{let s;const a=ce(ce({},Xs),n);let o=ce(ce({},i.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",i.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),n!=null&&n.headers&&(o=ce(ce({},o),n.headers));const c=i._removeEmptyFolders(e),h=i._getFinalPath(c),p=await(t=="PUT"?Ji:Ct)(i.fetch,`${i.url}/object/${h}`,s,ce({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:p.Id,fullPath:p.Key},error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(ke(s))return{data:null,error:s};throw s}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,n){var i=this;const s=i._removeEmptyFolders(t),a=i._getFinalPath(s),o=new URL(i.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const c=ce({upsert:Xs.upsert},n),h=ce(ce({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType),{data:{path:s,fullPath:(await Ji(i.fetch,o.toString(),l,{headers:h})).Key},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(ke(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var r=this;try{let n=r._getFinalPath(t);const i=ce({},r.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const s=await Ct(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(r.url+s.url),o=a.searchParams.get("token");if(!o)throw new ui("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var n=this;try{return{data:await Ct(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ke(i))return{data:null,error:i};throw i}}async copy(t,e,r){var n=this;try{return{data:{path:(await Ct(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ke(i))return{data:null,error:i};throw i}}async createSignedUrl(t,e,r){var n=this;try{let i=n._getFinalPath(t),s=await Ct(n.fetch,`${n.url}/object/sign/${i}`,ce({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${n.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ke(i))return{data:null,error:i};throw i}}async createSignedUrls(t,e,r){var n=this;try{const i=await Ct(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:t},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>ce(ce({},a),{},{signedUrl:a.signedURL?encodeURI(`${n.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ke(i))return{data:null,error:i};throw i}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=n?`?${n}`:"",s=this._getFinalPath(t),a=()=>dn(this.fetch,`${this.url}/${r}/${s}${i}`,{headers:this.headers,noResolveJson:!0});return new Q0(a,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:Xi(await dn(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Y0(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ke(n)&&n instanceof qi){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(t,e){const r=this._getFinalPath(t),n=[],i=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";i!==""&&n.push(i);const s=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&n.push(a);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(t){var e=this;try{return{data:await os(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async list(t,e,r){var n=this;try{const i=ce(ce(ce({},ec),e),{},{prefix:t||""});return{data:await Ct(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ke(i))return{data:null,error:i};throw i}}async listV2(t,e){var r=this;try{const n=ce({},t);return{data:await Ct(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},e),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const ro="2.89.0",no={"X-Client-Info":`storage-js/${ro}`};var rc=class{constructor(t,e={},r,n){this.shouldThrowOnError=!1;const i=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=ce(ce({},no),e),this.fetch=as(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await dn(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await dn(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Ct(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}async updateBucket(t,e){var r=this;try{return{data:await Ji(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ke(n))return{data:null,error:n};throw n}}async emptyBucket(t){var e=this;try{return{data:await Ct(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await os(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},nc=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=ce(ce({},no),e),this.fetch=as(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Ct(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),i=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await dn(e.fetch,i,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await os(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ke(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!G0(t))throw new ui("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new j0({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const a=i[s];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(i,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}};const ls={"X-Client-Info":`storage-js/${ro}`,"Content-Type":"application/json"};var io=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function mt(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Ci=class extends io{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ic=class extends io{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const cs=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),sc=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Js=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ac=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const n=t.status||500,i=t;if(typeof i.json=="function")i.json().then(s=>{const a=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||n+"";e(new Ci(Js(s),n,a))}).catch(()=>{const s=n+"";e(new Ci(i.statusText||`HTTP ${n} error`,n,s))});else{const s=n+"";e(new Ci(i.statusText||`HTTP ${n} error`,n,s))}}else e(new ic(Js(t),t))},oc=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return n?(sc(n)?(i.headers=ce({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,ce(ce({},i),r)):i};async function lc(t,e,r,n,i,s){return new Promise((a,o)=>{t(r,oc(e,n,i,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>ac(l,o,n))})}async function xt(t,e,r,n,i){return lc(t,"POST",e,n,i,r)}var cc=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=ce(ce({},ls),e),this.fetch=cs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await xt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}}async listIndexes(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await xt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(mt(n))return{data:null,error:n};throw n}}},hc=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=ce(ce({},ls),e),this.fetch=cs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await xt(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await xt(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await xt(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}},uc=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=ce(ce({},ls),e),this.fetch=cs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await xt(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(mt(r))return{data:null,error:r};throw r}}},fc=class extends uc{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new dc(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},dc=class extends cc{constructor(t,e,r,n){super(t,e,n),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new pc(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},pc=class extends hc{constructor(t,e,r,n,i){super(t,e,i),this.vectorBucketName=r,this.indexName=n}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,ce(ce({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},gc=class extends rc{constructor(t,e={},r,n){super(t,e,r,n)}from(t){return new tc(this.url,this.headers,t,this.fetch)}get vectors(){return new fc(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new nc(this.url+"/iceberg",this.headers,this.fetch)}};const so="2.89.0",Dr=30*1e3,Yi=3,Ri=Yi*Dr,vc="http://localhost:9999",mc="supabase.auth.token",xc={"X-Client-Info":`gotrue-js/${so}`},Zi="X-Supabase-Api-Version",ao={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_c=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wc=10*60*1e3;class pn extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ae(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class yc extends pn{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Ec(t){return ae(t)&&t.name==="AuthApiError"}class fr extends pn{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class zt extends pn{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class ft extends zt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Tc(t){return ae(t)&&t.name==="AuthSessionMissingError"}class br extends zt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dn extends zt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ln extends zt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Sc(t){return ae(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ys extends zt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ac extends zt{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Qi extends zt{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ii(t){return ae(t)&&t.name==="AuthRetryableFetchError"}class Zs extends zt{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class es extends zt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qs=`
\r=`.split(""),bc=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Qs.length;e+=1)t[Qs[e].charCodeAt(0)]=-2;for(let e=0;e<Kn.length;e+=1)t[Kn[e].charCodeAt(0)]=e;return t})();function ea(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Kn[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Kn[n]),e.queuedBits-=6}}function oo(t,e,r){const n=bc[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ta(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Cc(a,n,r)};for(let a=0;a<t.length;a+=1)oo(t.charCodeAt(a),i,s);return e.join("")}function Oc(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function kc(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Oc(n,e)}}function Cc(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function $r(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)oo(t.charCodeAt(i),r,n);return new Uint8Array(e)}function Rc(t){const e=[];return kc(t,r=>e.push(r)),new Uint8Array(e)}function pr(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>ea(i,r,n)),ea(null,r,n),e.join("")}function Ic(t){return Math.round(Date.now()/1e3)+t}function Fc(){return Symbol("auth-callback")}const ze=()=>typeof window<"u"&&typeof document<"u",lr={tested:!1,writable:!1},lo=()=>{if(!ze())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(lr.tested)return lr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),lr.tested=!0,lr.writable=!0}catch{lr.tested=!0,lr.writable=!1}return lr.writable};function Pc(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const co=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Nc=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Lr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},cr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ke=async(t,e)=>{await t.removeItem(e)};class fi{constructor(){this.promise=new fi.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}fi.promiseConstructor=Promise;function Fi(t){const e=t.split(".");if(e.length!==3)throw new es("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!_c.test(e[n]))throw new es("JWT not in base64url format");return{header:JSON.parse(ta(e[0])),payload:JSON.parse(ta(e[1])),signature:$r(e[2]),raw:{header:e[0],payload:e[1]}}}async function Dc(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Lc(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){n(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function Bc(t){return("0"+t.toString(16)).substr(-2)}function Mc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,Bc).join("")}async function Uc(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function $c(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Uc(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Or(t,e,r=!1){const n=Mc();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Lr(t,`${e}-code-verifier`,i);const s=await $c(n);return[s,n===s?"plain":"s256"]}const jc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Wc(t){const e=t.headers.get(Zi);if(!e||!e.match(jc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Hc(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Vc(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Gc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function kr(t){if(!Gc.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Pi(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Kc(t,e){return new Proxy(t,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,n,i)}})}function ra(t){return JSON.parse(JSON.stringify(t))}const hr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),zc=[502,503,504];async function na(t){var e;if(!Nc(t))throw new Qi(hr(t),0);if(zc.includes(t.status))throw new Qi(hr(t),t.status);let r;try{r=await t.json()}catch(s){throw new fr(hr(s),s)}let n;const i=Wc(t);if(i&&i.getTime()>=ao["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Zs(hr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new ft}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Zs(hr(r),t.status,r.weak_password.reasons);throw new yc(hr(r),t.status||500,n)}const qc=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function le(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Zi]||(s[Zi]=ao["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Xc(t,e,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Xc(t,e,r,n,i,s){const a=qc(e,n,i,s);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new Qi(hr(l),0)}if(o.ok||await na(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await na(l)}}function kt(t){var e;let r=null;Zc(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Ic(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function ia(t){const e=kt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Zt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Jc(t){return{data:t,error:null}}function Yc(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,a=hi(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function sa(t){return t}function Zc(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ni=["global","local","others"];class Qc{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=co(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Ni[0]){if(Ni.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ni.join(", ")}`);try{return await le(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ae(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await le(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Zt})}catch(n){if(ae(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=hi(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Yc,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ae(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await le(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Zt})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:sa});if(h.error)throw h.error;const p=await h.json(),u=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(v=>{const d=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(v.split(";")[1].split("=")[1]);c[`${m}Page`]=d}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},p),c),error:null}}catch(c){if(ae(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){kr(e);try{return await le(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Zt})}catch(r){if(ae(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){kr(e);try{return await le(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Zt})}catch(n){if(ae(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){kr(e);try{return await le(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Zt})}catch(n){if(ae(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){kr(e.userId);try{const{data:r,error:n}=await le(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ae(r))return{data:null,error:r};throw r}}async _deleteFactor(e){kr(e.userId),kr(e.id);try{return{data:await le(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await le(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:sa});if(h.error)throw h.error;const p=await h.json(),u=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(v=>{const d=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(v.split(";")[1].split("=")[1]);c[`${m}Page`]=d}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},p),c),error:null}}catch(c){if(ae(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await le(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ae(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await le(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ae(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await le(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ae(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await le(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await le(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ae(r))return{data:null,error:r};throw r}}}function aa(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Cr={debug:!!(globalThis&&lo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ho extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eh extends ho{}async function th(t,e,r){Cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Cr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{Cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new eh(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Cr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function rh(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function uo(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function nh(t){return parseInt(t,16)}function ih(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function sh(t){var e;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:h,uri:p,version:u}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(u!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${u}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const f=uo(t.address),v=h?`${h}://${n}`:n,d=t.statement?`${t.statement}
`:"",m=`${v} wants you to sign in with your Ethereum account:
${f}

${d}`;let S=`URI: ${p}
Version: ${u}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(S+=`
Expiration Time: ${i.toISOString()}`),o&&(S+=`
Not Before: ${o.toISOString()}`),l&&(S+=`
Request ID: ${l}`),c){let A=`
Resources:`;for(const T of c){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);A+=`
- ${T}`}S+=A}return`${m}
${S}`}class De extends Error{constructor({message:e,code:r,cause:n,name:i}){var s;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class zn extends De{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function ah({error:t,options:e}){var r,n,i;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new De({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new De({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new De({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new De({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new De({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new De({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new De({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new De({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(fo(a)){if(s.rp.id!==a)return new De({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new De({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new De({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new De({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new De({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function oh({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new De({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new De({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(fo(n)){if(r.rpId!==n)return new De({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new De({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new De({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new De({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class lh{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const ch=new lh;function hh(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,i=hi(t,["challenge","user","excludeCredentials"]),s=$r(e).buffer,a=Object.assign(Object.assign({},r),{id:$r(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:$r(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function uh(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=hi(t,["challenge","allowCredentials"]),i=$r(e).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:$r(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function fh(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:pr(new Uint8Array(t.response.attestationObject)),clientDataJSON:pr(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function dh(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:pr(new Uint8Array(i.authenticatorData)),clientDataJSON:pr(new Uint8Array(i.clientDataJSON)),signature:pr(new Uint8Array(i.signature)),userHandle:i.userHandle?pr(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function fo(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function oa(){var t,e;return!!(ze()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function ph(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new zn("Browser returned unexpected credential type",e)}:{data:null,error:new zn("Empty credential response",e)}}catch(e){return{data:null,error:ah({error:e,options:t})}}}async function gh(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new zn("Browser returned unexpected credential type",e)}:{data:null,error:new zn("Empty credential response",e)}}catch(e){return{data:null,error:oh({error:e,options:t})}}}const vh={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mh={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function qn(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of t)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(e(a)){const o=n[s];e(o)?n[s]=qn(o,a):n[s]=qn(a)}else n[s]=a}return n}function xh(t,e){return qn(vh,t,e||{})}function _h(t,e){return qn(mh,t,e||{})}class wh{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!a)return{data:null,error:o};const l=i??ch.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=xh(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:h,error:p}=await ph({publicKey:c,signal:l});return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const c=_h(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:h,error:p}=await gh(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new fr("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new pn("rpId is required for WebAuthn authentication")};try{if(!oa())return{data:null,error:new fr("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new fr("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new pn("rpId is required for WebAuthn registration")};try{if(!oa())return{data:null,error:new fr("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(u=>u.factor_type==="webauthn"&&u.friendly_name===e&&u.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new fr("Unexpected error in register",a)}}}}rh();const yh={url:vc,storageKey:mc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function la(t,e,r){return await r()}const Rr={};class gn{get jwks(){var e,r;return(r=(e=Rr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Rr[this.storageKey]=Object.assign(Object.assign({},Rr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Rr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Rr[this.storageKey]=Object.assign(Object.assign({},Rr[this.storageKey]),{cachedAt:e})}constructor(e){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},yh),e);if(this.storageKey=s.storageKey,this.instanceID=(r=gn.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,gn.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&ze()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Qc({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=co(s.fetch),this.lock=s.lock||la,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:this.persistSession&&ze()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=th:this.lock=la,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new wh(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:lo()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=aa(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=aa(this.memoryStorage)),ze()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${so}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},n="none";if(ze()&&(r=Pc(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ze()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Sc(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ae(r)?this._returnResult({error:r}):this._returnResult({error:new fr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:kt}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(ae(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:h,password:p,options:u}=e;let f=null,v=null;this.flowType==="pkce"&&([f,v]=await Or(this.storage,this.storageKey)),s=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:u==null?void 0:u.emailRedirectTo,body:{email:h,password:p,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:f,code_challenge_method:v},xform:kt})}else if("phone"in e){const{phone:h,password:p,options:u}=e;s=await le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:kt})}else throw new Dn("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return await Ke(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:a,options:o}=e;r=await le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ia})}else if("phone"in e){const{phone:s,password:a,options:o}=e;r=await le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ia})}else throw new Dn("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new br;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,i,s,a,o,l,c,h,p,u;let f,v;if("message"in e)f=e.message,v=e.signature;else{const{chain:d,wallet:m,statement:S,options:A}=e;let T;if(ze())if(typeof m=="object")T=m;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")T=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=m}const R=new URL((r=A==null?void 0:A.url)!==null&&r!==void 0?r:window.location.href),H=await T.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!H||H.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const K=uo(H[0]);let k=(n=A==null?void 0:A.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const P=await T.request({method:"eth_chainId"});k=nh(P)}const U={domain:R.host,address:K,statement:S,uri:R.href,version:"1",chainId:k,nonce:(i=A==null?void 0:A.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=A==null?void 0:A.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=A==null?void 0:A.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=A==null?void 0:A.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=A==null?void 0:A.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(h=A==null?void 0:A.signInWithEthereum)===null||h===void 0?void 0:h.resources};f=sh(U),v=await T.request({method:"personal_sign",params:[ih(f),K]})}try{const{data:d,error:m}=await le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:v},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(u=e.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:kt});if(m)throw m;if(!d||!d.session||!d.user){const S=new br;return this._returnResult({data:{user:null,session:null},error:S})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign({},d),error:m})}catch(d){if(ae(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSolana(e){var r,n,i,s,a,o,l,c,h,p,u,f;let v,d;if("message"in e)v=e.message,d=e.signature;else{const{chain:m,wallet:S,statement:A,options:T}=e;let R;if(ze())if(typeof S=="object")R=S;else{const K=window;if("solana"in K&&typeof K.solana=="object"&&("signIn"in K.solana&&typeof K.solana.signIn=="function"||"signMessage"in K.solana&&typeof K.solana.signMessage=="function"))R=K.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=S}const H=new URL((r=T==null?void 0:T.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const K=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),A?{statement:A}:null));let k;if(Array.isArray(K)&&K[0]&&typeof K[0]=="object")k=K[0];else if(K&&typeof K=="object"&&"signedMessage"in K&&"signature"in K)k=K;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)v=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),d=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${H.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(i=(n=T==null?void 0:T.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=T==null?void 0:T.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((a=T==null?void 0:T.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((o=T==null?void 0:T.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((l=T==null?void 0:T.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((c=T==null?void 0:T.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((p=(h=T==null?void 0:T.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...T.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const K=await R.signMessage(new TextEncoder().encode(v),"utf8");if(!K||!(K instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");d=K}}try{const{data:m,error:S}=await le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:pr(d)},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:kt});if(S)throw S;if(!m||!m.session||!m.user){const A=new br;return this._returnResult({data:{user:null,session:null},error:A})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:S})}catch(m){if(ae(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(e){const r=await cr(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Ac;const{data:s,error:a}=await le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:kt});if(await Ke(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new br;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=e,o=await le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:kt}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const h=new br;return this._returnResult({data:{user:null,session:null},error:h})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,n,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Or(this.storage,this.storageKey));const{error:p}=await le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h})}throw new Dn("You must provide either an email or phone number.")}catch(o){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:kt});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Or(this.storage,this.storageKey));const c=await le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Jc});return!((s=c.data)===null||s===void 0)&&s.url&&ze()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new ft;const{error:i}=await le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(ae(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:a}=await le(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:a,error:o}=await le(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new Dn("You must provide either an email or phone number and a type")}catch(r){if(ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await cr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ri:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await cr(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Pi()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=Kc(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Zt}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ft}:await le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Zt})})}catch(r){if(ae(r))return Tc(r)&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new ft;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Or(this.storage,this.storageKey));const{data:c,error:h}=await le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Zt});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ft;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Fi(e.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(ae(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new ft;const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!ze())throw new Ln("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ln(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ys("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ln("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ys("No code detected.");const{data:A,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!s||!o||!a||!c)throw new Ln("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(o);let u=h+p;l&&(u=parseInt(l));const f=u-h;f*1e3<=Dr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${p}s`);const v=u-p;h-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,u,h):h-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,u,h);const{data:d,error:m}=await this._getUser(s);if(m)throw m;const S={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:p,expires_at:u,refresh_token:a,token_type:c,user:d.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:e.type},error:null})}catch(n){if(ae(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await cr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Ec(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=Fc(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Or(this.storage,this.storageKey,!0));try{return await le(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,h;const{data:p,error:u}=s;if(u)throw u;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await le(this.fetch,"GET",f,{headers:this.headers,jwt:(h=(c=p.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return ze()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ae(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:c,nonce:h}=e,p=await le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:kt}),{data:u,error:f}=p;return f?this._returnResult({data:{user:null,session:null},error:f}):!u||!u.session||!u.user?this._returnResult({data:{user:null,session:null},error:new br}):(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:f}))}catch(i){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await le(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Lc(async i=>(i>0&&await Dc(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:kt})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Ii(s)&&Date.now()+a-n<Dr})}catch(n){if(this._debug(r,"error",n),ae(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),ze()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await cr(this.storage,this.storageKey);if(i&&this.userStorage){let a=await cr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Lr(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Pi()}else if(i&&!i.user&&!i.user){const a=await cr(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Ke(this.storage,this.storageKey+"-user"),await Lr(this.storage,this.storageKey,i)):i.user=Pi()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ri;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Ri}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Ii(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new ft;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new fi;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new ft;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),ae(s)){const a={data:null,error:s};return Ii(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ke(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Lr(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=ra(i);await Lr(this.storage,this.storageKey,s)}else{const i=ra(r);await Lr(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ke(this.storage,this.storageKey),await Ke(this.storage,this.storageKey+"-code-verifier"),await Ke(this.storage,this.storageKey+"-user"),this.userStorage&&await Ke(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ze()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Dr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Dr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Dr}ms, refresh threshold is ${Yi} ticks`),i<=Yi&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ho)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ze()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Or(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await le(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await le(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?fh(e.webauthn.credential_response):dh(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:hh(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:uh(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Fi(n.access_token);let a=null;s.aal&&(a=s.aal);let o=a;((r=(e=n.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await le(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ft})})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new ft});const a=await le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&ze()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ae(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new ft});const a=await le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&ze()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ae(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;return n?this._returnResult({data:null,error:n}):r?await le(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ft})})}catch(e){if(ae(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await le(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ft})})}catch(r){if(ae(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+wc>i)return n;const{data:s,error:a}=await le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:f,error:v}=await this.getSession();if(v||!f.session)return this._returnResult({data:null,error:v});n=f.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Fi(n);r!=null&&r.allowExpired||Hc(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:s,header:i,signature:a},error:null}}const h=Vc(i.alg),p=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,a,Rc(`${o}.${l}`)))throw new es("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(ae(n))return this._returnResult({data:null,error:n});throw n}}}gn.nextInstanceID={};const Eh=gn,Th="2.89.0";let en="";typeof Deno<"u"?en="deno":typeof document<"u"?en="web":typeof navigator<"u"&&navigator.product==="ReactNative"?en="react-native":en="node";const Sh={"X-Client-Info":`supabase-js-${en}/${Th}`},Ah={headers:Sh},bh={schema:"public"},Oh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},kh={};function vn(t){"@babel/helpers - typeof";return vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(t)}function Ch(t,e){if(vn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(vn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rh(t){var e=Ch(t,"string");return vn(e)=="symbol"?e:e+""}function Ih(t,e,r){return(e=Rh(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ca(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Re(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ca(Object(r),!0).forEach(function(n){Ih(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ca(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}const Fh=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ph=()=>Headers,Nh=(t,e,r)=>{const n=Fh(r),i=Ph();return async(s,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Re(Re({},a),{},{headers:c}))}};function Dh(t){return t.endsWith("/")?t:t+"/"}function Lh(t,e){var r,n;const{db:i,auth:s,realtime:a,global:o}=t,{db:l,auth:c,realtime:h,global:p}=e,u={db:Re(Re({},l),i),auth:Re(Re({},c),s),realtime:Re(Re({},h),a),storage:{},global:Re(Re(Re({},p),o),{},{headers:Re(Re({},(r=p==null?void 0:p.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}function Bh(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Dh(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Mh=class extends Eh{constructor(t){super(t)}},Uh=class{constructor(t,e,r){var n,i;this.supabaseUrl=t,this.supabaseKey=e;const s=Bh(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const a=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:bh,realtime:kh,auth:Re(Re({},Oh),{},{storageKey:a}),global:Ah},l=Lh(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=l.global.headers)!==null&&i!==void 0?i:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=Nh(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Re({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new x0(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new gc(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new d0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:n}=await t.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:a,lock:o,debug:l,throwOnError:c},h,p){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Mh({url:this.authUrl.href,headers:Re(Re({},u),h),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,userStorage:i,flowType:a,lock:o,debug:l,throwOnError:c,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new D0(this.realtimeUrl.href,Re(Re({},t),{},{params:Re(Re({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const $h=(t,e,r)=>new Uh(t,e,r);function jh(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}jh()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Wh="https://shklbyiwpyfxyckmticr.supabase.co",Hh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNoa2xieWl3cHlmeHlja210aWNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2ODIwODgsImV4cCI6MjA4MjI1ODA4OH0.F-02VDvK97RxpXF0upUy3VM4W6jeIz_i0UCzWbUIPU0",je=$h(Wh,Hh),Jt={user:null,async init(){const{data:{session:t}}=await je.auth.getSession();this.user=(t==null?void 0:t.user)||null,je.auth.onAuthStateChange((e,r)=>{this.user=(r==null?void 0:r.user)||null,this.updateUI()})},async login(t,e){const{data:r,error:n}=await je.auth.signInWithPassword({email:t,password:e});if(n)throw n;return r},async logout(){const{error:t}=await je.auth.signOut();if(t)throw t},updateUI(){const t=document.getElementById("authContainer"),e=document.getElementById("appContainer");this.user?(t.classList.add("d-none"),e.classList.remove("d-none")):(t.classList.remove("d-none"),e.classList.add("d-none"))}},ot={async getRegions(){const{data:t,error:e}=await je.from("regions").select("*").order("created_at",{ascending:!0});if(e)throw e;return t},async addRegion(t){const{data:e,error:r}=await je.from("regions").insert([{name:t}]).select();if(r)throw r;return e[0]},async deleteRegion(t){const{error:e}=await je.from("regions").delete().eq("id",t);if(e)throw e},async getProducts(){const{data:t,error:e}=await je.from("products").select("*").order("created_at",{ascending:!0});if(e)throw e;return t},async addProduct(t){const{data:e,error:r}=await je.from("products").insert([{name:t}]).select();if(r)throw r;return e[0]},async deleteProduct(t){const{error:e}=await je.from("products").delete().eq("id",t);if(e)throw e},async getStores(){const{data:t,error:e}=await je.from("stores").select(`
                *,
                orders (*)
            `).order("created_at",{ascending:!1});if(e)throw e;return t&&t.forEach(r=>{r.orders&&r.orders.sort((n,i)=>new Date(i.created_at)-new Date(n.created_at))}),t},async addStore(t){const e={name:t.name,description:t.description,seller_name:t.sellerName,address:t.address,phone:t.phone,region:t.region,ideal_time:t.idealTime,purchase_prob:t.purchaseProb,visit_days:t.visitDays,visited:!1},{data:r,error:n}=await je.from("stores").insert([e]).select();if(n)throw n;return r[0]},async updateStore(t,e){const r={name:e.name,description:e.description,seller_name:e.sellerName,address:e.address,phone:e.phone,region:e.region,ideal_time:e.idealTime,purchase_prob:e.purchaseProb,visit_days:e.visitDays},{data:n,error:i}=await je.from("stores").update(r).eq("id",t).select();if(i)throw i;return n[0]},async toggleVisit(t,e){const{error:r}=await je.from("stores").update({visited:e}).eq("id",t);if(r)throw r},async resetDailyVisits(){const{error:t}=await je.from("stores").update({visited:!1}).neq("id",0);if(t)throw t},async addOrder(t,e){const r={store_id:t,date:e.date,text:e.text,items:e.items},{data:n,error:i}=await je.from("orders").insert([r]).select();if(i)throw i;return n[0]},async updateOrder(t,e){const r={text:e.text,items:e.items},{data:n,error:i}=await je.from("orders").update(r).eq("id",t).select();if(i)throw i;return n[0]},async deleteOrder(t){const{error:e}=await je.from("orders").delete().eq("id",t);if(e)throw e}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xn={};Xn.version="0.18.5";var po=1252,Vh=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],go=function(t){Vh.indexOf(t)!=-1&&(po=t)};function Gh(){go(1252)}var mn=function(t){go(t)};function Kh(){mn(1200),Gh()}var Bn=function(e){return String.fromCharCode(e)},ha=function(e){return String.fromCharCode(e)},Jn,Qt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xn(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Qt.charAt(s)+Qt.charAt(a)+Qt.charAt(o)+Qt.charAt(l);return e}function Gt(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Qt.indexOf(t.charAt(c++)),a=Qt.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Qt.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Qt.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qt=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function vr(t){return ge?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ua(t){return ge?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var It=function(e){return ge?qt(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function di(t){if(typeof ArrayBuffer>"u")return It(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function An(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function zh(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Je=ge?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:qt(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function qh(t){for(var e=[],r=0,n=t.length+250,i=vr(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=vr(65535),n=65530)}return e.push(i.slice(0,r)),Je(e)}var sn=/\u0000/g,Mn=/[\u0001-\u0006]/g;function jr(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ft(t,e){var r=""+t;return r.length>=e?r:Ie("0",e-r.length)+r}function hs(t,e){var r=""+t;return r.length>=e?r:Ie(" ",e-r.length)+r}function Yn(t,e){var r=""+t;return r.length>=e?r:r+Ie(" ",e-r.length)}function Xh(t,e){var r=""+Math.round(t);return r.length>=e?r:Ie("0",e-r.length)+r}function Jh(t,e){var r=""+t;return r.length>=e?r:Ie("0",e-r.length)+r}var fa=Math.pow(2,32);function Ir(t,e){if(t>fa||t<-fa)return Xh(t,e);var r=Math.round(t);return Jh(r,e)}function Zn(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var da=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Di=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Yh(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Fe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pa={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Zh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qn(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,h=0,p=Math.floor(i);c<e&&(p=Math.floor(i),o=p*a+s,h=p*c+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!r)return[0,n*o,h];var u=Math.floor(n*o/h);return[u,n*o-u*h,h]}function Un(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=su(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var vo=new Date(1899,11,31,0,0,0),Qh=vo.getTime(),eu=new Date(1900,2,1,0,0,0);function mo(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=eu&&(r+=24*60*60*1e3),(r-(Qh+(t.getTimezoneOffset()-vo.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function us(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function tu(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ru(t){var e=t<0?12:11,r=us(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function nu(t){var e=us(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function iu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ru(t):e===10?r=t.toFixed(10).substr(0,12):r=nu(t),us(tu(r.toUpperCase()))}function ts(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):iu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return tr(14,mo(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function su(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function au(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Di[r.m-1][1];case 5:return Di[r.m-1][0];default:return Di[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return da[r.q][0];default:return da[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ft(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Ft(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?Ft(l,c):"";return h}function er(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var xo=/%/g;function ou(t,e,r){var n=e.replace(xo,""),i=e.length-n.length;return Wt(t,n,r*Math.pow(10,2*i))+Ie("%",i)}function lu(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wt(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _o(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_o(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var wo=/# (\?+)( ?)\/( ?)(\d+)/;function cu(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ie(" ",t[1].length+1+t[4].length):hs(a,t[1].length)+t[2]+"/"+t[3]+Ft(o,t[4].length))}function hu(t,e,r){return r+(e===0?"":""+e)+Ie(" ",t[1].length+2+t[4].length)}var yo=/^#*0*\.([0#]+)/,Eo=/\).*[0#]/,To=/\(###\) ###\\?-####/;function it(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function ga(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function va(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function uu(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function fu(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Et(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Eo)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Et("n",n,r):"("+Et("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return lu(t,e,r);if(e.indexOf("%")!==-1)return ou(t,e,r);if(e.indexOf("E")!==-1)return _o(e,r);if(e.charCodeAt(0)===36)return"$"+Et(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ir(l,e.length);if(e.match(/^[#?]+$/))return i=Ir(r,0),i==="0"&&(i=""),i.length>e.length?i:it(e.substr(0,e.length-i.length))+i;if(s=e.match(wo))return cu(s,l,c);if(e.match(/^#+0+$/))return c+Ir(l,e.length-e.indexOf("0"));if(s=e.match(yo))return i=ga(r,s[1].length).replace(/^([^\.]+)$/,"$1."+it(s[1])).replace(/\.$/,"."+it(s[1])).replace(/\.(\d*)$/,function(v,d){return"."+d+Ie("0",it(s[1]).length-d.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+ga(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+er(Ir(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Et(t,e,-r):er(""+(Math.floor(r)+uu(r,s[1].length)))+"."+Ft(va(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Et(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=jr(Et(t,e.replace(/[\\-]/g,""),r)),a=0,jr(jr(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(To))return i=Et(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Qn(l,Math.pow(10,a)-1,!1),i=""+c,h=Wt("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Yn(o[2],a),h.length<s[4].length&&(h=it(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Qn(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hs(o[1],a)+s[2]+"/"+s[3]+Yn(o[2],a):Ie(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ir(r,0),e.length<=i.length?i:it(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,u=e.length-i.length-p;return it(e.substr(0,p)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=va(r,s[1].length),r<0?"-"+Et(t,e,-r):er(fu(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ft(0,3-v.length):"")+v})+"."+Ft(a,s[1].length);switch(e){case"###,##0.00":return Et(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=er(Ir(l,0));return f!=="0"?c+f:"";case"###,###.00":return Et(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Et(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function du(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wt(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function pu(t,e,r){var n=e.replace(xo,""),i=e.length-n.length;return Wt(t,n,r*Math.pow(10,2*i))+Ie("%",i)}function So(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+So(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dt(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Eo)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dt("n",n,r):"("+Dt("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return du(t,e,r);if(e.indexOf("%")!==-1)return pu(t,e,r);if(e.indexOf("E")!==-1)return So(e,r);if(e.charCodeAt(0)===36)return"$"+Dt(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ft(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:it(e.substr(0,e.length-i.length))+i;if(s=e.match(wo))return hu(s,l,c);if(e.match(/^#+0+$/))return c+Ft(l,e.length-e.indexOf("0"));if(s=e.match(yo))return i=(""+r).replace(/^([^\.]+)$/,"$1."+it(s[1])).replace(/\.$/,"."+it(s[1])),i=i.replace(/\.(\d*)$/,function(v,d){return"."+d+Ie("0",it(s[1]).length-d.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+er(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dt(t,e,-r):er(""+r)+"."+Ie("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Dt(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=jr(Dt(t,e.replace(/[\\-]/g,""),r)),a=0,jr(jr(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(To))return i=Dt(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Qn(l,Math.pow(10,a)-1,!1),i=""+c,h=Wt("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Yn(o[2],a),h.length<s[4].length&&(h=it(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Qn(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hs(o[1],a)+s[2]+"/"+s[3]+Yn(o[2],a):Ie(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:it(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,u=e.length-i.length-p;return it(e.substr(0,p)+i+e.substr(e.length-u))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dt(t,e,-r):er(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ft(0,3-v.length):"")+v})+"."+Ft(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=er(""+l);return f!=="0"?c+f:"";default:if(e.match(/\.[0#?]*$/))return Dt(t,e.slice(0,e.lastIndexOf(".")),r)+it(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Wt(t,e,r){return(r|0)===r?Dt(t,e,r):Et(t,e,r)}function gu(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Ao=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bo(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Zn(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Ao))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function vu(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,h,p,u="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Zn(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var f=t.charAt(++a),v=f==="("||f===")"?f:"t";i[i.length]={t:v,v:f},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Un(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Un(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var d={t:o,v:o};if(c==null&&(c=Un(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(d.v=c.H>=12?"P":"A"),d.t="T",u="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(d.v=c.H>=12?"PM":"AM"),d.t="T",a+=5,u="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(d.v=c.H>=12?"":""),d.t="T",a+=5,u="h"):(d.t="t",++a),c==null&&d.t==="T")return"";i[i.length]=d,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Ao)){if(c==null&&(c=Un(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bo(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var m=0,S=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=u,l="h",m<1&&(m=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(S=Math.max(S,A[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[a].v.match(/[Hh]/)&&(m=1),m<2&&i[a].v.match(/[Mm]/)&&(m=2),m<3&&i[a].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",R;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=au(i[a].t.charCodeAt(0),i[a].v,c,S),i[a].t="t";break;case"n":case"?":for(R=a+1;i[R]!=null&&((o=i[R].t)==="?"||o==="D"||(o===" "||o==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[a].v+=i[R].v,i[R]={v:"",t:";"},++R;T+=i[a].v,a=R-1;break;case"G":i[a].t="t",i[a].v=ts(e,r);break}var H="",K,k;if(T.length>0){T.charCodeAt(0)==40?(K=e<0&&T.charCodeAt(0)===45?-e:e,k=Wt("n",T,K)):(K=e<0&&n>1?-e:e,k=Wt("n",T,K),K<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),R=k.length-1;var U=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){U=a;break}var P=i.length;if(U===i.length&&k.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(R>=i[a].v.length-1?(R-=i[a].v.length,i[a].v=k.substr(R+1,i[a].v.length)):R<0?i[a].v="":(i[a].v=k.substr(0,R+1),R=-1),i[a].t="t",P=a);R>=0&&P<i.length&&(i[P].v=k.substr(0,R+1)+i[P].v)}else if(U!==i.length&&k.indexOf("E")===-1){for(R=k.indexOf(".")-1,a=U;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===U?i[a].v.indexOf(".")-1:i[a].v.length-1,H=i[a].v.substr(h+1);h>=0;--h)R>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(H=k.charAt(R--)+H);i[a].v=H,i[a].t="t",P=a}for(R>=0&&P<i.length&&(i[P].v=k.substr(0,R+1)+i[P].v),R=k.indexOf(".")+1,a=U;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==U)){for(h=i[a].v.indexOf(".")>-1&&a===U?i[a].v.indexOf(".")+1:0,H=i[a].v.substr(0,h);h<i[a].v.length;++h)R<k.length&&(H+=k.charAt(R++));i[a].v=H,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(K=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Wt(i[a].t,i[a].v,K),i[a].t="t");var V="";for(a=0;a!==i.length;++a)i[a]!=null&&(V+=i[a].v);return V}var ma=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xa(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function mu(t,e){var r=gu(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(ma),o=r[1].match(ma);return xa(e,a)?[n,r[0]]:xa(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function tr(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fe)[t],n==null&&(n=r.table&&r.table[pa[t]]||Fe[pa[t]]),n==null&&(n=Zh[t]||"General");break}if(Zn(n,0))return ts(e,r);e instanceof Date&&(e=mo(e,r.date1904));var i=mu(n,e);if(Zn(i[1]))return ts(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return vu(i[1],e,r,i[0])}function Oo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Fe[r]==null){e<0&&(e=r);continue}if(Fe[r]==t){e=r;break}}e<0&&(e=391)}return Fe[e]=t,e}function pi(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Oo(t[e],e)}function gi(){Fe=Yh()}var ko=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xu(t){var e=typeof t=="number"?Fe[t]:t;return e=e.replace(ko,"(\\d+)"),new RegExp("^"+e+"$")}function _u(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(ko)||[]).forEach(function(p,u){var f=parseInt(r[u+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=f;break;case"d":s=f;break;case"h":a=f;break;case"s":l=f;break;case"m":a>=0?o=f:i=f;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?h:c+"T"+h}var wu=function(){var t={};t.version="1.2.0";function e(){for(var k=0,U=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,U[P]=k;return typeof Int32Array<"u"?new Int32Array(U):U}var r=e();function n(k){var U=0,P=0,V=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)G[V]=k[V];for(V=0;V!=256;++V)for(P=k[V],U=256+V;U<4096;U+=256)P=G[U]=P>>>8^k[P&255];var q=[];for(V=1;V!=16;++V)q[V-1]=typeof Int32Array<"u"?G.subarray(V*256,V*256+256):G.slice(V*256,V*256+256);return q}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],p=i[6],u=i[7],f=i[8],v=i[9],d=i[10],m=i[11],S=i[12],A=i[13],T=i[14];function R(k,U){for(var P=U^-1,V=0,G=k.length;V<G;)P=P>>>8^r[(P^k.charCodeAt(V++))&255];return~P}function H(k,U){for(var P=U^-1,V=k.length-15,G=0;G<V;)P=T[k[G++]^P&255]^A[k[G++]^P>>8&255]^S[k[G++]^P>>16&255]^m[k[G++]^P>>>24]^d[k[G++]]^v[k[G++]]^f[k[G++]]^u[k[G++]]^p[k[G++]]^h[k[G++]]^c[k[G++]]^l[k[G++]]^o[k[G++]]^a[k[G++]]^s[k[G++]]^r[k[G++]];for(V+=15;G<V;)P=P>>>8^r[(P^k[G++])&255];return~P}function K(k,U){for(var P=U^-1,V=0,G=k.length,q=0,te=0;V<G;)q=k.charCodeAt(V++),q<128?P=P>>>8^r[(P^q)&255]:q<2048?(P=P>>>8^r[(P^(192|q>>6&31))&255],P=P>>>8^r[(P^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,te=k.charCodeAt(V++)&1023,P=P>>>8^r[(P^(240|q>>8&7))&255],P=P>>>8^r[(P^(128|q>>2&63))&255],P=P>>>8^r[(P^(128|te>>6&15|(q&3)<<4))&255],P=P>>>8^r[(P^(128|te&63))&255]):(P=P>>>8^r[(P^(224|q>>12&15))&255],P=P>>>8^r[(P^(128|q>>6&63))&255],P=P>>>8^r[(P^(128|q&63))&255]);return~P}return t.table=r,t.bstr=R,t.buf=H,t.str=K,t}(),Ee=function(){var e={};e.version="1.2.1";function r(g,w){for(var x=g.split("/"),_=w.split("/"),y=0,E=0,F=Math.min(x.length,_.length);y<F;++y){if(E=x[y].length-_[y].length)return E;if(x[y]!=_[y])return x[y]<_[y]?-1:1}return x.length-_.length}function n(g){if(g.charAt(g.length-1)=="/")return g.slice(0,-1).indexOf("/")===-1?g:n(g.slice(0,-1));var w=g.lastIndexOf("/");return w===-1?g:g.slice(0,w+1)}function i(g){if(g.charAt(g.length-1)=="/")return i(g.slice(0,-1));var w=g.lastIndexOf("/");return w===-1?g:g.slice(w+1)}function s(g,w){typeof w=="string"&&(w=new Date(w));var x=w.getHours();x=x<<6|w.getMinutes(),x=x<<5|w.getSeconds()>>>1,g.write_shift(2,x);var _=w.getFullYear()-1980;_=_<<4|w.getMonth()+1,_=_<<5|w.getDate(),g.write_shift(2,_)}function a(g){var w=g.read_shift(2)&65535,x=g.read_shift(2)&65535,_=new Date,y=x&31;x>>>=5;var E=x&15;x>>>=4,_.setMilliseconds(0),_.setFullYear(x+1980),_.setMonth(E-1),_.setDate(y);var F=w&31;w>>>=5;var M=w&63;return w>>>=6,_.setHours(w),_.setMinutes(M),_.setSeconds(F<<1),_}function o(g){pt(g,0);for(var w={},x=0;g.l<=g.length-4;){var _=g.read_shift(2),y=g.read_shift(2),E=g.l+y,F={};switch(_){case 21589:x=g.read_shift(1),x&1&&(F.mtime=g.read_shift(4)),y>5&&(x&2&&(F.atime=g.read_shift(4)),x&4&&(F.ctime=g.read_shift(4))),F.mtime&&(F.mt=new Date(F.mtime*1e3));break}g.l=E,w[_]=F}return w}var l;function c(){return l||(l={})}function h(g,w){if(g[0]==80&&g[1]==75)return $s(g,w);if((g[0]|32)==109&&(g[1]|32)==105)return i0(g,w);if(g.length<512)throw new Error("CFB file size "+g.length+" < 512");var x=3,_=512,y=0,E=0,F=0,M=0,I=0,N=[],D=g.slice(0,512);pt(D,0);var z=p(D);switch(x=z[0],x){case 3:_=512;break;case 4:_=4096;break;case 0:if(z[1]==0)return $s(g,w);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}_!==512&&(D=g.slice(0,_),pt(D,28));var Z=g.slice(0,_);u(D,x);var re=D.read_shift(4,"i");if(x===3&&re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+re);D.l+=4,F=D.read_shift(4,"i"),D.l+=4,D.chk("00100000","Mini Stream Cutoff Size: "),M=D.read_shift(4,"i"),y=D.read_shift(4,"i"),I=D.read_shift(4,"i"),E=D.read_shift(4,"i");for(var X=-1,ee=0;ee<109&&(X=D.read_shift(4,"i"),!(X<0));++ee)N[ee]=X;var he=f(g,_);m(I,E,he,_,N);var be=A(he,F,N,_);be[F].name="!Directory",y>0&&M!==te&&(be[M].name="!MiniFAT"),be[N[0]].name="!FAT",be.fat_addrs=N,be.ssz=_;var Oe={},et=[],Jr=[],Yr=[];T(F,be,he,et,y,Oe,Jr,M),v(Jr,Yr,et),et.shift();var Zr={FileIndex:Jr,FullPaths:Yr};return w&&w.raw&&(Zr.raw={header:Z,sectors:he}),Zr}function p(g){if(g[g.l]==80&&g[g.l+1]==75)return[0,0];g.chk(ye,"Header Signature: "),g.l+=16;var w=g.read_shift(2,"u");return[g.read_shift(2,"u"),w]}function u(g,w){var x=9;switch(g.l+=2,x=g.read_shift(2)){case 9:if(w!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(w!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}g.chk("0600","Mini Sector Shift: "),g.chk("000000000000","Reserved: ")}function f(g,w){for(var x=Math.ceil(g.length/w)-1,_=[],y=1;y<x;++y)_[y-1]=g.slice(y*w,(y+1)*w);return _[x-1]=g.slice(x*w),_}function v(g,w,x){for(var _=0,y=0,E=0,F=0,M=0,I=x.length,N=[],D=[];_<I;++_)N[_]=D[_]=_,w[_]=x[_];for(;M<D.length;++M)_=D[M],y=g[_].L,E=g[_].R,F=g[_].C,N[_]===_&&(y!==-1&&N[y]!==y&&(N[_]=N[y]),E!==-1&&N[E]!==E&&(N[_]=N[E])),F!==-1&&(N[F]=_),y!==-1&&_!=N[_]&&(N[y]=N[_],D.lastIndexOf(y)<M&&D.push(y)),E!==-1&&_!=N[_]&&(N[E]=N[_],D.lastIndexOf(E)<M&&D.push(E));for(_=1;_<I;++_)N[_]===_&&(E!==-1&&N[E]!==E?N[_]=N[E]:y!==-1&&N[y]!==y&&(N[_]=N[y]));for(_=1;_<I;++_)if(g[_].type!==0){if(M=_,M!=N[M])do M=N[M],w[_]=w[M]+"/"+w[_];while(M!==0&&N[M]!==-1&&M!=N[M]);N[_]=-1}for(w[0]+="/",_=1;_<I;++_)g[_].type!==2&&(w[_]+="/")}function d(g,w,x){for(var _=g.start,y=g.size,E=[],F=_;x&&y>0&&F>=0;)E.push(w.slice(F*q,F*q+q)),y-=q,F=dr(x,F*4);return E.length===0?B(0):Je(E).slice(0,g.size)}function m(g,w,x,_,y){var E=te;if(g===te){if(w!==0)throw new Error("DIFAT chain shorter than expected")}else if(g!==-1){var F=x[g],M=(_>>>2)-1;if(!F)return;for(var I=0;I<M&&(E=dr(F,I*4))!==te;++I)y.push(E);m(dr(F,_-4),w-1,x,_,y)}}function S(g,w,x,_,y){var E=[],F=[];y||(y=[]);var M=_-1,I=0,N=0;for(I=w;I>=0;){y[I]=!0,E[E.length]=I,F.push(g[I]);var D=x[Math.floor(I*4/_)];if(N=I*4&M,_<4+N)throw new Error("FAT boundary crossed: "+I+" 4 "+_);if(!g[D])break;I=dr(g[D],N)}return{nodes:E,data:ba([F])}}function A(g,w,x,_){var y=g.length,E=[],F=[],M=[],I=[],N=_-1,D=0,z=0,Z=0,re=0;for(D=0;D<y;++D)if(M=[],Z=D+w,Z>=y&&(Z-=y),!F[Z]){I=[];var X=[];for(z=Z;z>=0;){X[z]=!0,F[z]=!0,M[M.length]=z,I.push(g[z]);var ee=x[Math.floor(z*4/_)];if(re=z*4&N,_<4+re)throw new Error("FAT boundary crossed: "+z+" 4 "+_);if(!g[ee]||(z=dr(g[ee],re),X[z]))break}E[Z]={nodes:M,data:ba([I])}}return E}function T(g,w,x,_,y,E,F,M){for(var I=0,N=_.length?2:0,D=w[g].data,z=0,Z=0,re;z<D.length;z+=128){var X=D.slice(z,z+128);pt(X,64),Z=X.read_shift(2),re=vs(X,0,Z-N),_.push(re);var ee={name:re,type:X.read_shift(1),color:X.read_shift(1),L:X.read_shift(4,"i"),R:X.read_shift(4,"i"),C:X.read_shift(4,"i"),clsid:X.read_shift(16),state:X.read_shift(4,"i"),start:0,size:0},he=X.read_shift(2)+X.read_shift(2)+X.read_shift(2)+X.read_shift(2);he!==0&&(ee.ct=R(X,X.l-8));var be=X.read_shift(2)+X.read_shift(2)+X.read_shift(2)+X.read_shift(2);be!==0&&(ee.mt=R(X,X.l-8)),ee.start=X.read_shift(4,"i"),ee.size=X.read_shift(4,"i"),ee.size<0&&ee.start<0&&(ee.size=ee.type=0,ee.start=te,ee.name=""),ee.type===5?(I=ee.start,y>0&&I!==te&&(w[I].name="!StreamData")):ee.size>=4096?(ee.storage="fat",w[ee.start]===void 0&&(w[ee.start]=S(x,ee.start,w.fat_addrs,w.ssz)),w[ee.start].name=ee.name,ee.content=w[ee.start].data.slice(0,ee.size)):(ee.storage="minifat",ee.size<0?ee.size=0:I!==te&&ee.start!==te&&w[I]&&(ee.content=d(ee,w[I].data,(w[M]||{}).data))),ee.content&&pt(ee.content,0),E[re]=ee,F.push(ee)}}function R(g,w){return new Date((vt(g,w+4)/1e7*Math.pow(2,32)+vt(g,w)/1e7-11644473600)*1e3)}function H(g,w){return c(),h(l.readFileSync(g),w)}function K(g,w){var x=w&&w.type;switch(x||ge&&Buffer.isBuffer(g)&&(x="buffer"),x||"base64"){case"file":return H(g,w);case"base64":return h(It(Gt(g)),w);case"binary":return h(It(g),w)}return h(g,w)}function k(g,w){var x=w||{},_=x.root||"Root Entry";if(g.FullPaths||(g.FullPaths=[]),g.FileIndex||(g.FileIndex=[]),g.FullPaths.length!==g.FileIndex.length)throw new Error("inconsistent CFB structure");g.FullPaths.length===0&&(g.FullPaths[0]=_+"/",g.FileIndex[0]={name:_,type:5}),x.CLSID&&(g.FileIndex[0].clsid=x.CLSID),U(g)}function U(g){var w="Sh33tJ5";if(!Ee.find(g,"/"+w)){var x=B(4);x[0]=55,x[1]=x[3]=50,x[2]=54,g.FileIndex.push({name:w,type:2,content:x,size:4,L:69,R:69,C:69}),g.FullPaths.push(g.FullPaths[0]+w),P(g)}}function P(g,w){k(g);for(var x=!1,_=!1,y=g.FullPaths.length-1;y>=0;--y){var E=g.FileIndex[y];switch(E.type){case 0:_?x=!0:(g.FileIndex.pop(),g.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(E.R*E.L*E.C)&&(x=!0),E.R>-1&&E.L>-1&&E.R==E.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!w)){var F=new Date(1987,1,19),M=0,I=Object.create?Object.create(null):{},N=[];for(y=0;y<g.FullPaths.length;++y)I[g.FullPaths[y]]=!0,g.FileIndex[y].type!==0&&N.push([g.FullPaths[y],g.FileIndex[y]]);for(y=0;y<N.length;++y){var D=n(N[y][0]);_=I[D],_||(N.push([D,{name:i(D).replace("/",""),type:1,clsid:Ge,ct:F,mt:F,content:null}]),I[D]=!0)}for(N.sort(function(re,X){return r(re[0],X[0])}),g.FullPaths=[],g.FileIndex=[],y=0;y<N.length;++y)g.FullPaths[y]=N[y][0],g.FileIndex[y]=N[y][1];for(y=0;y<N.length;++y){var z=g.FileIndex[y],Z=g.FullPaths[y];if(z.name=i(Z).replace("/",""),z.L=z.R=z.C=-(z.color=1),z.size=z.content?z.content.length:0,z.start=0,z.clsid=z.clsid||Ge,y===0)z.C=N.length>1?1:-1,z.size=0,z.type=5;else if(Z.slice(-1)=="/"){for(M=y+1;M<N.length&&n(g.FullPaths[M])!=Z;++M);for(z.C=M>=N.length?-1:M,M=y+1;M<N.length&&n(g.FullPaths[M])!=n(Z);++M);z.R=M>=N.length?-1:M,z.type=1}else n(g.FullPaths[y+1]||"")==n(Z)&&(z.R=y+1),z.type=2}}}function V(g,w){var x=w||{};if(x.fileType=="mad")return s0(g,x);switch(P(g),x.fileType){case"zip":return Zl(g,x)}var _=function(re){for(var X=0,ee=0,he=0;he<re.FileIndex.length;++he){var be=re.FileIndex[he];if(be.content){var Oe=be.content.length;Oe>0&&(Oe<4096?X+=Oe+63>>6:ee+=Oe+511>>9)}}for(var et=re.FullPaths.length+3>>2,Jr=X+7>>3,Yr=X+127>>7,Zr=Jr+ee+et+Yr,or=Zr+127>>7,Ai=or<=109?0:Math.ceil((or-109)/127);Zr+or+Ai+127>>7>or;)Ai=++or<=109?0:Math.ceil((or-109)/127);var $t=[1,Ai,or,Yr,et,ee,X,0];return re.FileIndex[0].size=X<<6,$t[7]=(re.FileIndex[0].start=$t[0]+$t[1]+$t[2]+$t[3]+$t[4]+$t[5])+($t[6]+7>>3),$t}(g),y=B(_[7]<<9),E=0,F=0;{for(E=0;E<8;++E)y.write_shift(1,ue[E]);for(E=0;E<8;++E)y.write_shift(2,0);for(y.write_shift(2,62),y.write_shift(2,3),y.write_shift(2,65534),y.write_shift(2,9),y.write_shift(2,6),E=0;E<3;++E)y.write_shift(2,0);for(y.write_shift(4,0),y.write_shift(4,_[2]),y.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),y.write_shift(4,0),y.write_shift(4,4096),y.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:te),y.write_shift(4,_[3]),y.write_shift(-4,_[1]?_[0]-1:te),y.write_shift(4,_[1]),E=0;E<109;++E)y.write_shift(-4,E<_[2]?_[1]+E:-1)}if(_[1])for(F=0;F<_[1];++F){for(;E<236+F*127;++E)y.write_shift(-4,E<_[2]?_[1]+E:-1);y.write_shift(-4,F===_[1]-1?te:F+1)}var M=function(re){for(F+=re;E<F-1;++E)y.write_shift(-4,E+1);re&&(++E,y.write_shift(-4,te))};for(F=E=0,F+=_[1];E<F;++E)y.write_shift(-4,Pe.DIFSECT);for(F+=_[2];E<F;++E)y.write_shift(-4,Pe.FATSECT);M(_[3]),M(_[4]);for(var I=0,N=0,D=g.FileIndex[0];I<g.FileIndex.length;++I)D=g.FileIndex[I],D.content&&(N=D.content.length,!(N<4096)&&(D.start=F,M(N+511>>9)));for(M(_[6]+7>>3);y.l&511;)y.write_shift(-4,Pe.ENDOFCHAIN);for(F=E=0,I=0;I<g.FileIndex.length;++I)D=g.FileIndex[I],D.content&&(N=D.content.length,!(!N||N>=4096)&&(D.start=F,M(N+63>>6)));for(;y.l&511;)y.write_shift(-4,Pe.ENDOFCHAIN);for(E=0;E<_[4]<<2;++E){var z=g.FullPaths[E];if(!z||z.length===0){for(I=0;I<17;++I)y.write_shift(4,0);for(I=0;I<3;++I)y.write_shift(4,-1);for(I=0;I<12;++I)y.write_shift(4,0);continue}D=g.FileIndex[E],E===0&&(D.start=D.size?D.start-1:te);var Z=E===0&&x.root||D.name;if(N=2*(Z.length+1),y.write_shift(64,Z,"utf16le"),y.write_shift(2,N),y.write_shift(1,D.type),y.write_shift(1,D.color),y.write_shift(-4,D.L),y.write_shift(-4,D.R),y.write_shift(-4,D.C),D.clsid)y.write_shift(16,D.clsid,"hex");else for(I=0;I<4;++I)y.write_shift(4,0);y.write_shift(4,D.state||0),y.write_shift(4,0),y.write_shift(4,0),y.write_shift(4,0),y.write_shift(4,0),y.write_shift(4,D.start),y.write_shift(4,D.size),y.write_shift(4,0)}for(E=1;E<g.FileIndex.length;++E)if(D=g.FileIndex[E],D.size>=4096)if(y.l=D.start+1<<9,ge&&Buffer.isBuffer(D.content))D.content.copy(y,y.l,0,D.size),y.l+=D.size+511&-512;else{for(I=0;I<D.size;++I)y.write_shift(1,D.content[I]);for(;I&511;++I)y.write_shift(1,0)}for(E=1;E<g.FileIndex.length;++E)if(D=g.FileIndex[E],D.size>0&&D.size<4096)if(ge&&Buffer.isBuffer(D.content))D.content.copy(y,y.l,0,D.size),y.l+=D.size+63&-64;else{for(I=0;I<D.size;++I)y.write_shift(1,D.content[I]);for(;I&63;++I)y.write_shift(1,0)}if(ge)y.l=y.length;else for(;y.l<y.length;)y.write_shift(1,0);return y}function G(g,w){var x=g.FullPaths.map(function(I){return I.toUpperCase()}),_=x.map(function(I){var N=I.split("/");return N[N.length-(I.slice(-1)=="/"?2:1)]}),y=!1;w.charCodeAt(0)===47?(y=!0,w=x[0].slice(0,-1)+w):y=w.indexOf("/")!==-1;var E=w.toUpperCase(),F=y===!0?x.indexOf(E):_.indexOf(E);if(F!==-1)return g.FileIndex[F];var M=!E.match(Mn);for(E=E.replace(sn,""),M&&(E=E.replace(Mn,"!")),F=0;F<x.length;++F)if((M?x[F].replace(Mn,"!"):x[F]).replace(sn,"")==E||(M?_[F].replace(Mn,"!"):_[F]).replace(sn,"")==E)return g.FileIndex[F];return null}var q=64,te=-2,ye="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],Ge="00000000000000000000000000000000",Pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function At(g,w,x){c();var _=V(g,x);l.writeFileSync(w,_)}function $e(g){for(var w=new Array(g.length),x=0;x<g.length;++x)w[x]=String.fromCharCode(g[x]);return w.join("")}function wt(g,w){var x=V(g,w);switch(w&&w.type||"buffer"){case"file":return c(),l.writeFileSync(w.filename,x),x;case"binary":return typeof x=="string"?x:$e(x);case"base64":return xn(typeof x=="string"?x:$e(x));case"buffer":if(ge)return Buffer.isBuffer(x)?x:qt(x);case"array":return typeof x=="string"?It(x):x}return x}var ut;function b(g){try{var w=g.InflateRaw,x=new w;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)ut=g;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function L(g,w){if(!ut)return Ms(g,w);var x=ut.InflateRaw,_=new x,y=_._processChunk(g.slice(g.l),_._finishFlushFlag);return g.l+=_.bytesRead,y}function C(g){return ut?ut.deflateRawSync(g):Fs(g)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(g){var w=(g<<1|g<<11)&139536|(g<<5|g<<15)&558144;return(w>>16|w>>8|w)&255}for(var ie=typeof Uint8Array<"u",Q=ie?new Uint8Array(256):[],Te=0;Te<256;++Te)Q[Te]=oe(Te);function de(g,w){var x=Q[g&255];return w<=8?x>>>8-w:(x=x<<8|Q[g>>8&255],w<=16?x>>>16-w:(x=x<<8|Q[g>>16&255],x>>>24-w))}function nt(g,w){var x=w&7,_=w>>>3;return(g[_]|(x<=6?0:g[_+1]<<8))>>>x&3}function ve(g,w){var x=w&7,_=w>>>3;return(g[_]|(x<=5?0:g[_+1]<<8))>>>x&7}function Mt(g,w){var x=w&7,_=w>>>3;return(g[_]|(x<=4?0:g[_+1]<<8))>>>x&15}function Ce(g,w){var x=w&7,_=w>>>3;return(g[_]|(x<=3?0:g[_+1]<<8))>>>x&31}function ne(g,w){var x=w&7,_=w>>>3;return(g[_]|(x<=1?0:g[_+1]<<8))>>>x&127}function yt(g,w,x){var _=w&7,y=w>>>3,E=(1<<x)-1,F=g[y]>>>_;return x<8-_||(F|=g[y+1]<<8-_,x<16-_)||(F|=g[y+2]<<16-_,x<24-_)||(F|=g[y+3]<<24-_),F&E}function Ut(g,w,x){var _=w&7,y=w>>>3;return _<=5?g[y]|=(x&7)<<_:(g[y]|=x<<_&255,g[y+1]=(x&7)>>8-_),w+3}function sr(g,w,x){var _=w&7,y=w>>>3;return x=(x&1)<<_,g[y]|=x,w+1}function Sr(g,w,x){var _=w&7,y=w>>>3;return x<<=_,g[y]|=x&255,x>>>=8,g[y+1]=x,w+8}function Is(g,w,x){var _=w&7,y=w>>>3;return x<<=_,g[y]|=x&255,x>>>=8,g[y+1]=x&255,g[y+2]=x>>>8,w+16}function yi(g,w){var x=g.length,_=2*x>w?2*x:w+5,y=0;if(x>=w)return g;if(ge){var E=ua(_);if(g.copy)g.copy(E);else for(;y<g.length;++y)E[y]=g[y];return E}else if(ie){var F=new Uint8Array(_);if(F.set)F.set(g);else for(;y<x;++y)F[y]=g[y];return F}return g.length=_,g}function Nt(g){for(var w=new Array(g),x=0;x<g;++x)w[x]=0;return w}function In(g,w,x){var _=1,y=0,E=0,F=0,M=0,I=g.length,N=ie?new Uint16Array(32):Nt(32);for(E=0;E<32;++E)N[E]=0;for(E=I;E<x;++E)g[E]=0;I=g.length;var D=ie?new Uint16Array(I):Nt(I);for(E=0;E<I;++E)N[y=g[E]]++,_<y&&(_=y),D[E]=0;for(N[0]=0,E=1;E<=_;++E)N[E+16]=M=M+N[E-1]<<1;for(E=0;E<I;++E)M=g[E],M!=0&&(D[E]=N[M+16]++);var z=0;for(E=0;E<I;++E)if(z=g[E],z!=0)for(M=de(D[E],_)>>_-z,F=(1<<_+4-z)-1;F>=0;--F)w[M|F<<z]=z&15|E<<4;return _}var Ei=ie?new Uint16Array(512):Nt(512),Ti=ie?new Uint16Array(32):Nt(32);if(!ie){for(var ar=0;ar<512;++ar)Ei[ar]=0;for(ar=0;ar<32;++ar)Ti[ar]=0}(function(){for(var g=[],w=0;w<32;w++)g.push(5);In(g,Ti,32);var x=[];for(w=0;w<=143;w++)x.push(8);for(;w<=255;w++)x.push(9);for(;w<=279;w++)x.push(7);for(;w<=287;w++)x.push(8);In(x,Ei,288)})();var ql=function(){for(var w=ie?new Uint8Array(32768):[],x=0,_=0;x<se.length-1;++x)for(;_<se[x+1];++_)w[_]=x;for(;_<32768;++_)w[_]=29;var y=ie?new Uint8Array(259):[];for(x=0,_=0;x<W.length-1;++x)for(;_<W[x+1];++_)y[_]=x;function E(M,I){for(var N=0;N<M.length;){var D=Math.min(65535,M.length-N),z=N+D==M.length;for(I.write_shift(1,+z),I.write_shift(2,D),I.write_shift(2,~D&65535);D-- >0;)I[I.l++]=M[N++]}return I.l}function F(M,I){for(var N=0,D=0,z=ie?new Uint16Array(32768):[];D<M.length;){var Z=Math.min(65535,M.length-D);if(Z<10){for(N=Ut(I,N,+(D+Z==M.length)),N&7&&(N+=8-(N&7)),I.l=N/8|0,I.write_shift(2,Z),I.write_shift(2,~Z&65535);Z-- >0;)I[I.l++]=M[D++];N=I.l*8;continue}N=Ut(I,N,+(D+Z==M.length)+2);for(var re=0;Z-- >0;){var X=M[D];re=(re<<5^X)&32767;var ee=-1,he=0;if((ee=z[re])&&(ee|=D&-32768,ee>D&&(ee-=32768),ee<D))for(;M[ee+he]==M[D+he]&&he<250;)++he;if(he>2){X=y[he],X<=22?N=Sr(I,N,Q[X+1]>>1)-1:(Sr(I,N,3),N+=5,Sr(I,N,Q[X-23]>>5),N+=3);var be=X<8?0:X-4>>2;be>0&&(Is(I,N,he-W[X]),N+=be),X=w[D-ee],N=Sr(I,N,Q[X]>>3),N-=3;var Oe=X<4?0:X-2>>1;Oe>0&&(Is(I,N,D-ee-se[X]),N+=Oe);for(var et=0;et<he;++et)z[re]=D&32767,re=(re<<5^M[D])&32767,++D;Z-=he-1}else X<=143?X=X+48:N=sr(I,N,1),N=Sr(I,N,Q[X]),z[re]=D&32767,++D}N=Sr(I,N,0)-1}return I.l=(N+7)/8|0,I.l}return function(I,N){return I.length<8?E(I,N):F(I,N)}}();function Fs(g){var w=B(50+Math.floor(g.length*1.1)),x=ql(g,w);return w.slice(0,x)}var Ps=ie?new Uint16Array(32768):Nt(32768),Ns=ie?new Uint16Array(32768):Nt(32768),Ds=ie?new Uint16Array(128):Nt(128),Ls=1,Bs=1;function Xl(g,w){var x=Ce(g,w)+257;w+=5;var _=Ce(g,w)+1;w+=5;var y=Mt(g,w)+4;w+=4;for(var E=0,F=ie?new Uint8Array(19):Nt(19),M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],I=1,N=ie?new Uint8Array(8):Nt(8),D=ie?new Uint8Array(8):Nt(8),z=F.length,Z=0;Z<y;++Z)F[O[Z]]=E=ve(g,w),I<E&&(I=E),N[E]++,w+=3;var re=0;for(N[0]=0,Z=1;Z<=I;++Z)D[Z]=re=re+N[Z-1]<<1;for(Z=0;Z<z;++Z)(re=F[Z])!=0&&(M[Z]=D[re]++);var X=0;for(Z=0;Z<z;++Z)if(X=F[Z],X!=0){re=Q[M[Z]]>>8-X;for(var ee=(1<<7-X)-1;ee>=0;--ee)Ds[re|ee<<X]=X&7|Z<<3}var he=[];for(I=1;he.length<x+_;)switch(re=Ds[ne(g,w)],w+=re&7,re>>>=3){case 16:for(E=3+nt(g,w),w+=2,re=he[he.length-1];E-- >0;)he.push(re);break;case 17:for(E=3+ve(g,w),w+=3;E-- >0;)he.push(0);break;case 18:for(E=11+ne(g,w),w+=7;E-- >0;)he.push(0);break;default:he.push(re),I<re&&(I=re);break}var be=he.slice(0,x),Oe=he.slice(x);for(Z=x;Z<286;++Z)be[Z]=0;for(Z=_;Z<30;++Z)Oe[Z]=0;return Ls=In(be,Ps,286),Bs=In(Oe,Ns,30),w}function Jl(g,w){if(g[0]==3&&!(g[1]&3))return[vr(w),2];for(var x=0,_=0,y=ua(w||1<<18),E=0,F=y.length>>>0,M=0,I=0;!(_&1);){if(_=ve(g,x),x+=3,_>>>1)_>>1==1?(M=9,I=5):(x=Xl(g,x),M=Ls,I=Bs);else{x&7&&(x+=8-(x&7));var N=g[x>>>3]|g[(x>>>3)+1]<<8;if(x+=32,N>0)for(!w&&F<E+N&&(y=yi(y,E+N),F=y.length);N-- >0;)y[E++]=g[x>>>3],x+=8;continue}for(;;){!w&&F<E+32767&&(y=yi(y,E+32767),F=y.length);var D=yt(g,x,M),z=_>>>1==1?Ei[D]:Ps[D];if(x+=z&15,z>>>=4,!(z>>>8&255))y[E++]=z;else{if(z==256)break;z-=257;var Z=z<8?0:z-4>>2;Z>5&&(Z=0);var re=E+W[z];Z>0&&(re+=yt(g,x,Z),x+=Z),D=yt(g,x,I),z=_>>>1==1?Ti[D]:Ns[D],x+=z&15,z>>>=4;var X=z<4?0:z-2>>1,ee=se[z];for(X>0&&(ee+=yt(g,x,X),x+=X),!w&&F<re&&(y=yi(y,re+100),F=y.length);E<re;)y[E]=y[E-ee],++E}}}return w?[y,x+7>>>3]:[y.slice(0,E),x+7>>>3]}function Ms(g,w){var x=g.slice(g.l||0),_=Jl(x,w);return g.l+=_[1],_[0]}function Us(g,w){if(g)typeof console<"u"&&console.error(w);else throw new Error(w)}function $s(g,w){var x=g;pt(x,0);var _=[],y=[],E={FileIndex:_,FullPaths:y};k(E,{root:w.root});for(var F=x.length-4;(x[F]!=80||x[F+1]!=75||x[F+2]!=5||x[F+3]!=6)&&F>=0;)--F;x.l=F+4,x.l+=4;var M=x.read_shift(2);x.l+=6;var I=x.read_shift(4);for(x.l=I,F=0;F<M;++F){x.l+=20;var N=x.read_shift(4),D=x.read_shift(4),z=x.read_shift(2),Z=x.read_shift(2),re=x.read_shift(2);x.l+=8;var X=x.read_shift(4),ee=o(x.slice(x.l+z,x.l+z+Z));x.l+=z+Z+re;var he=x.l;x.l=X+4,Yl(x,N,D,E,ee),x.l=he}return E}function Yl(g,w,x,_,y){g.l+=2;var E=g.read_shift(2),F=g.read_shift(2),M=a(g);if(E&8257)throw new Error("Unsupported ZIP encryption");for(var I=g.read_shift(4),N=g.read_shift(4),D=g.read_shift(4),z=g.read_shift(2),Z=g.read_shift(2),re="",X=0;X<z;++X)re+=String.fromCharCode(g[g.l++]);if(Z){var ee=o(g.slice(g.l,g.l+Z));(ee[21589]||{}).mt&&(M=ee[21589].mt),((y||{})[21589]||{}).mt&&(M=y[21589].mt)}g.l+=Z;var he=g.slice(g.l,g.l+N);switch(F){case 8:he=L(g,D);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+F)}var be=!1;E&8&&(I=g.read_shift(4),I==134695760&&(I=g.read_shift(4),be=!0),N=g.read_shift(4),D=g.read_shift(4)),N!=w&&Us(be,"Bad compressed size: "+w+" != "+N),D!=x&&Us(be,"Bad uncompressed size: "+x+" != "+D),Si(_,re,he,{unsafe:!0,mt:M})}function Zl(g,w){var x=w||{},_=[],y=[],E=B(1),F=x.compression?8:0,M=0,I=0,N=0,D=0,z=0,Z=g.FullPaths[0],re=Z,X=g.FileIndex[0],ee=[],he=0;for(I=1;I<g.FullPaths.length;++I)if(re=g.FullPaths[I].slice(Z.length),X=g.FileIndex[I],!(!X.size||!X.content||re=="Sh33tJ5")){var be=D,Oe=B(re.length);for(N=0;N<re.length;++N)Oe.write_shift(1,re.charCodeAt(N)&127);Oe=Oe.slice(0,Oe.l),ee[z]=wu.buf(X.content,0);var et=X.content;F==8&&(et=C(et)),E=B(30),E.write_shift(4,67324752),E.write_shift(2,20),E.write_shift(2,M),E.write_shift(2,F),X.mt?s(E,X.mt):E.write_shift(4,0),E.write_shift(-4,ee[z]),E.write_shift(4,et.length),E.write_shift(4,X.content.length),E.write_shift(2,Oe.length),E.write_shift(2,0),D+=E.length,_.push(E),D+=Oe.length,_.push(Oe),D+=et.length,_.push(et),E=B(46),E.write_shift(4,33639248),E.write_shift(2,0),E.write_shift(2,20),E.write_shift(2,M),E.write_shift(2,F),E.write_shift(4,0),E.write_shift(-4,ee[z]),E.write_shift(4,et.length),E.write_shift(4,X.content.length),E.write_shift(2,Oe.length),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(4,0),E.write_shift(4,be),he+=E.l,y.push(E),he+=Oe.length,y.push(Oe),++z}return E=B(22),E.write_shift(4,101010256),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,z),E.write_shift(2,z),E.write_shift(4,he),E.write_shift(4,D),E.write_shift(2,0),Je([Je(_),Je(y),E])}var Fn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ql(g,w){if(g.ctype)return g.ctype;var x=g.name||"",_=x.match(/\.([^\.]+)$/);return _&&Fn[_[1]]||w&&(_=(x=w).match(/[\.\\]([^\.\\])+$/),_&&Fn[_[1]])?Fn[_[1]]:"application/octet-stream"}function e0(g){for(var w=xn(g),x=[],_=0;_<w.length;_+=76)x.push(w.slice(_,_+76));return x.join(`\r
`)+`\r
`}function t0(g){var w=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(N){var D=N.charCodeAt(0).toString(16).toUpperCase();return"="+(D.length==1?"0"+D:D)});w=w.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),w.charAt(0)==`
`&&(w="=0D"+w.slice(1)),w=w.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],_=w.split(`\r
`),y=0;y<_.length;++y){var E=_[y];if(E.length==0){x.push("");continue}for(var F=0;F<E.length;){var M=76,I=E.slice(F,F+M);I.charAt(M-1)=="="?M--:I.charAt(M-2)=="="?M-=2:I.charAt(M-3)=="="&&(M-=3),I=E.slice(F,F+M),F+=M,F<E.length&&(I+="="),x.push(I)}}return x.join(`\r
`)}function r0(g){for(var w=[],x=0;x<g.length;++x){for(var _=g[x];x<=g.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+g[++x];w.push(_)}for(var y=0;y<w.length;++y)w[y]=w[y].replace(/[=][0-9A-Fa-f]{2}/g,function(E){return String.fromCharCode(parseInt(E.slice(1),16))});return It(w.join(`\r
`))}function n0(g,w,x){for(var _="",y="",E="",F,M=0;M<10;++M){var I=w[M];if(!I||I.match(/^\s*$/))break;var N=I.match(/^(.*?):\s*([^\s].*)$/);if(N)switch(N[1].toLowerCase()){case"content-location":_=N[2].trim();break;case"content-type":E=N[2].trim();break;case"content-transfer-encoding":y=N[2].trim();break}}switch(++M,y.toLowerCase()){case"base64":F=It(Gt(w.slice(M).join("")));break;case"quoted-printable":F=r0(w.slice(M));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+y)}var D=Si(g,_.slice(x.length),F,{unsafe:!0});E&&(D.ctype=E)}function i0(g,w){if($e(g.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=w&&w.root||"",_=(ge&&Buffer.isBuffer(g)?g.toString("binary"):$e(g)).split(`\r
`),y=0,E="";for(y=0;y<_.length;++y)if(E=_[y],!!/^Content-Location:/i.test(E)&&(E=E.slice(E.indexOf("file")),x||(x=E.slice(0,E.lastIndexOf("/")+1)),E.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),E.slice(0,x.length)!=x););var F=(_[1]||"").match(/boundary="(.*?)"/);if(!F)throw new Error("MAD cannot find boundary");var M="--"+(F[1]||""),I=[],N=[],D={FileIndex:I,FullPaths:N};k(D);var z,Z=0;for(y=0;y<_.length;++y){var re=_[y];re!==M&&re!==M+"--"||(Z++&&n0(D,_.slice(z,y),x),z=y)}return D}function s0(g,w){var x=w||{},_=x.boundary||"SheetJS";_="------="+_;for(var y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],E=g.FullPaths[0],F=E,M=g.FileIndex[0],I=1;I<g.FullPaths.length;++I)if(F=g.FullPaths[I].slice(E.length),M=g.FileIndex[I],!(!M.size||!M.content||F=="Sh33tJ5")){F=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(he){return"_x"+he.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(he){return"_u"+he.charCodeAt(0).toString(16)+"_"});for(var N=M.content,D=ge&&Buffer.isBuffer(N)?N.toString("binary"):$e(N),z=0,Z=Math.min(1024,D.length),re=0,X=0;X<=Z;++X)(re=D.charCodeAt(X))>=32&&re<128&&++z;var ee=z>=Z*4/5;y.push(_),y.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+F),y.push("Content-Transfer-Encoding: "+(ee?"quoted-printable":"base64")),y.push("Content-Type: "+Ql(M,F)),y.push(""),y.push(ee?t0(D):e0(D))}return y.push(_+`--\r
`),y.join(`\r
`)}function a0(g){var w={};return k(w,g),w}function Si(g,w,x,_){var y=_&&_.unsafe;y||k(g);var E=!y&&Ee.find(g,w);if(!E){var F=g.FullPaths[0];w.slice(0,F.length)==F?F=w:(F.slice(-1)!="/"&&(F+="/"),F=(F+w).replace("//","/")),E={name:i(w),type:2},g.FileIndex.push(E),g.FullPaths.push(F),y||Ee.utils.cfb_gc(g)}return E.content=x,E.size=x?x.length:0,_&&(_.CLSID&&(E.clsid=_.CLSID),_.mt&&(E.mt=_.mt),_.ct&&(E.ct=_.ct)),E}function o0(g,w){k(g);var x=Ee.find(g,w);if(x){for(var _=0;_<g.FileIndex.length;++_)if(g.FileIndex[_]==x)return g.FileIndex.splice(_,1),g.FullPaths.splice(_,1),!0}return!1}function l0(g,w,x){k(g);var _=Ee.find(g,w);if(_){for(var y=0;y<g.FileIndex.length;++y)if(g.FileIndex[y]==_)return g.FileIndex[y].name=i(x),g.FullPaths[y]=x,!0}return!1}function c0(g){P(g,!0)}return e.find=G,e.read=K,e.parse=h,e.write=wt,e.writeFile=At,e.utils={cfb_new:a0,cfb_add:Si,cfb_del:o0,cfb_mov:l0,cfb_gc:c0,ReadShift:on,CheckField:Ko,prep_blob:pt,bconcat:Je,use_zlib:b,_deflateRaw:Fs,_inflateRaw:Ms,consts:Pe},e}();function yu(t){return typeof t=="string"?di(t):Array.isArray(t)?zh(t):t}function bn(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=di(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?wn(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([yu(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=An(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Qe(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function _a(t,e){for(var r=[],n=Qe(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function fs(t){for(var e=[],r=Qe(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function vi(t){for(var e=[],r=Qe(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Eu(t){for(var e=[],r=Qe(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var ei=new Date(1899,11,30,0,0,0);function ct(t,e){var r=t.getTime(),n=ei.getTime()+(t.getTimezoneOffset()-ei.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Co=new Date,Tu=ei.getTime()+(Co.getTimezoneOffset()-ei.getTimezoneOffset())*6e4,wa=Co.getTimezoneOffset();function Ro(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Tu),e.getTimezoneOffset()!==wa&&e.setTime(e.getTime()+(e.getTimezoneOffset()-wa)*6e4),e}var ya=new Date("2017-02-19T19:06:09.000Z"),Io=isNaN(ya.getFullYear())?new Date("2/19/17"):ya,Su=Io.getFullYear()==2017;function at(t,e){var r=new Date(t);if(Su)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Io.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function mi(t,e){if(ge&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function ht(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ht(t[r]));return e}function Ie(t,e){for(var r="";r.length<e;)r+=t;return r}function Ht(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var Au=["january","february","march","april","may","june","july","august","september","october","november","december"];function _n(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Au.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function fe(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ge?n=qt(r):n=qh(r),Ee.utils.cfb_add(t,e,n)}Ee.utils.cfb_add(t,e,r)}else t.file(e,r)}function ds(){return Ee.utils.cfb_new()}var Be=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bu={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ps=fs(bu),gs=/[&<>'"]/g,Ou=/[\u0000-\u0008\u000b-\u001f]/g;function _e(t){var e=t+"";return e.replace(gs,function(r){return ps[r]}).replace(Ou,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ea(t){return _e(t).replace(/ /g,"_x0020_")}var Fo=/[\u0000-\u001f]/g;function ku(t){var e=t+"";return e.replace(gs,function(r){return ps[r]}).replace(/\n/g,"<br/>").replace(Fo,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Cu(t){var e=t+"";return e.replace(gs,function(r){return ps[r]}).replace(Fo,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Ru(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Iu(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Li(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Ta(t){var e=vr(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Sa(t){return qt(t,"binary").toString("utf8")}var $n="foo bar baz",an=ge&&(Sa($n)==Li($n)&&Sa||Ta($n)==Li($n)&&Ta)||Li,wn=ge?function(t){return qt(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Fu=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Po=/(^\s|\s$|\n)/;function Ye(t,e){return"<"+t+(e.match(Po)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function yn(t){return Qe(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function J(t,e,r){return"<"+t+(r!=null?yn(r):"")+(e!=null?(e.match(Po)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function rs(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Pu(t,e){switch(typeof t){case"string":var r=J("vt:lpwstr",_e(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return J((t|0)==t?"vt:i4":"vt:r8",_e(String(t)));case"boolean":return J("vt:bool",t?"true":"false")}if(t instanceof Date)return J("vt:filetime",rs(t));throw new Error("Unable to serialize "+t)}var We={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Kr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],gt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Nu(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Du(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Aa=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},ba=ge?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:qt(e)})):Aa(t)}:Aa,Oa=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(tn(t,i)));return n.join("").replace(sn,"")},vs=ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(sn,""):Oa(t,e,r)}:Oa,ka=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},No=ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):ka(t,e,r)}:ka,Ca=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Br(t,i)));return n.join("")},On=ge?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Ca(e,r,n)}:Ca,Do=function(t,e){var r=vt(t,e);return r>0?On(t,e+4,e+4+r-1):""},Lo=Do,Bo=function(t,e){var r=vt(t,e);return r>0?On(t,e+4,e+4+r-1):""},Mo=Bo,Uo=function(t,e){var r=2*vt(t,e);return r>0?On(t,e+4,e+4+r-1):""},$o=Uo,jo=function(e,r){var n=vt(e,r);return n>0?vs(e,r+4,r+4+n):""},Wo=jo,Ho=function(t,e){var r=vt(t,e);return r>0?On(t,e+4,e+4+r):""},Vo=Ho,Go=function(t,e){return Nu(t,e)},ti=Go,ms=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ge&&(Lo=function(e,r){if(!Buffer.isBuffer(e))return Do(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Mo=function(e,r){if(!Buffer.isBuffer(e))return Bo(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$o=function(e,r){if(!Buffer.isBuffer(e))return Uo(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Wo=function(e,r){if(!Buffer.isBuffer(e))return jo(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Vo=function(e,r){if(!Buffer.isBuffer(e))return Ho(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ti=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Go(e,r)},ms=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Br=function(t,e){return t[e]},tn=function(t,e){return t[e+1]*256+t[e]},Lu=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},vt=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},dr=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Bu=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function on(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(tn(this,c)),c+=2;t*=2;break;case"utf8":r=On(this,this.l,this.l+t);break;case"utf16le":t*=2,r=vs(this,this.l,this.l+t);break;case"wstr":return on.call(this,t,"dbcs");case"lpstr-ansi":r=Lo(this,this.l),t=4+vt(this,this.l);break;case"lpstr-cp":r=Mo(this,this.l),t=4+vt(this,this.l);break;case"lpwstr":r=$o(this,this.l),t=4+2*vt(this,this.l);break;case"lpp4":t=4+vt(this,this.l),r=Wo(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+vt(this,this.l),r=Vo(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Br(this,this.l+t++))!==0;)s.push(Bn(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=tn(this,this.l+t))!==0;)s.push(Bn(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Br(this,c),this.l=c+1,o=on.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bn(tn(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Br(this,c),this.l=c+1,o=on.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bn(Br(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Br(this,this.l),this.l++,n;case 2:return n=(e==="i"?Lu:tn)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?dr:Bu)(this,this.l),this.l+=4,n):(i=vt(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ti(this,this.l):i=ti([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=No(this,this.l,t);break}}return this.l+=t,r}var Mu=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Uu=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},$u=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function ju(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)$u(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Mu(this,e,this.l);break;case 8:if(n=8,r==="f"){Du(this,e,this.l);break}case 16:break;case-4:n=4,Uu(this,e,this.l);break}return this.l+=n,this}function Ko(t,e){var r=No(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function pt(t,e){t.l=e,t.read_shift=on,t.chk=Ko,t.write_shift=ju}function Bt(t,e){t.l+=e}function B(t){var e=vr(t);return pt(e,0),e}function lt(){var t=[],e=ge?256:2048,r=function(c){var h=B(c);return pt(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),Je(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function j(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Dv[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&ms(r)&&t.push(r)}}function ln(t,e,r){var n=ht(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ra(t,e,r){var n=ht(t);return n.s=ln(n.s,e.s,r),n.e=ln(n.e,e.s,r),n}function cn(t,e){if(t.cRel&&t.c<0)for(t=ht(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ht(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=we(t);return!t.cRel&&t.cRel!=null&&(r=Vu(r)),!t.rRel&&t.rRel!=null&&(r=Wu(r)),r}function Bi(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+tt(t.s.c)+":"+(t.e.cRel?"":"$")+tt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ze(t.s.r)+":"+(t.e.rRel?"":"$")+Ze(t.e.r):cn(t.s,e.biff)+":"+cn(t.e,e.biff)}function xs(t){return parseInt(Hu(t),10)-1}function Ze(t){return""+(t+1)}function Wu(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Hu(t){return t.replace(/\$(\d+)$/,"$1")}function _s(t){for(var e=Gu(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function tt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Vu(t){return t.replace(/^([A-Z])/,"$$$1")}function Gu(t){return t.replace(/^\$([A-Z])/,"$1")}function Ku(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function He(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function we(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function _t(t){var e=t.indexOf(":");return e==-1?{s:He(t),e:He(t)}:{s:He(t.slice(0,e)),e:He(t.slice(e+1))}}function Le(t,e){return typeof e>"u"||typeof e=="number"?Le(t.s,t.e):(typeof t!="string"&&(t=we(t)),typeof e!="string"&&(e=we(e)),t==e?t:t+":"+e)}function Ae(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Ia(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=tr(t.z,r?ct(e):e)}catch{}try{return t.w=tr((t.XF||{}).numFmtId||(r?14:0),r?ct(e):e)}catch{return""+e}}function Kt(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?kn[t.v]||t.v:e==null?Ia(t,t.v):Ia(t,e))}function _r(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function zo(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?He(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Ae(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=e[p].length;++u)if(!(typeof e[p][u]>"u")){var f={v:e[p][u]},v=a+p,d=o+u;if(c.s.r>v&&(c.s.r=v),c.s.c>d&&(c.s.c=d),c.e.r<v&&(c.e.r=v),c.e.c<d&&(c.e.c=d),e[p][u]&&typeof e[p][u]=="object"&&!Array.isArray(e[p][u])&&!(e[p][u]instanceof Date))f=e[p][u];else if(Array.isArray(f.v)&&(f.f=e[p][u][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Fe[14],n.cellDates?(f.t="d",f.w=tr(f.z,ct(f.v))):(f.t="n",f.v=ct(f.v),f.w=tr(f.z,f.v))):f.t="s";if(i)s[v]||(s[v]=[]),s[v][d]&&s[v][d].z&&(f.z=s[v][d].z),s[v][d]=f;else{var m=we({c:d,r:v});s[m]&&s[m].z&&(f.z=s[m].z),s[m]=f}}}return c.s.c<1e7&&(s["!ref"]=Le(c)),s}function zr(t,e){return zo(null,t,e)}function zu(t){return t.read_shift(4,"i")}function Pt(t,e){return e||(e=B(4)),e.write_shift(4,t),e}function rt(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ve(t,e){var r=!1;return e==null&&(r=!0,e=B(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function qu(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Xu(t,e){return e||(e=B(4)),e.write_shift(2,0),e.write_shift(2,0),e}function ws(t,e){var r=t.l,n=t.read_shift(1),i=rt(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(qu(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function Ju(t,e){var r=!1;return e==null&&(r=!0,e=B(15+4*t.t.length)),e.write_shift(1,0),Ve(t.t,e),r?e.slice(0,e.l):e}var Yu=ws;function Zu(t,e){var r=!1;return e==null&&(r=!0,e=B(23+4*t.t.length)),e.write_shift(1,1),Ve(t.t,e),e.write_shift(4,1),Xu({},e),r?e.slice(0,e.l):e}function St(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function wr(t,e){return e==null&&(e=B(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function yr(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Er(t,e){return e==null&&(e=B(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Qu=rt,qo=Ve;function ys(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function ri(t,e){var r=!1;return e==null&&(r=!0,e=B(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var ef=rt,ns=ys,Es=ri;function Xo(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ti([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):dr(e,0)>>2;return r?i/100:i}function Jo(t,e){e==null&&(e=B(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Yo(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function tf(t,e){return e||(e=B(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Tr=Yo,qr=tf;function Xr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function mr(t,e){return(e||B(8)).write_shift(8,t,"f")}function rf(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=ff[i];c&&(e.rgb=Wa(c));break;case 2:e.rgb=Wa([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ni(t,e){if(e||(e=B(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function nf(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function sf(t,e){e||(e=B(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var Zo=2,dt=3,jn=11,ii=19,Wn=64,af=65,of=71,lf=4108,cf=4126,Xe=80,Fa={1:{n:"CodePage",t:Zo},2:{n:"Category",t:Xe},3:{n:"PresentationFormat",t:Xe},4:{n:"ByteCount",t:dt},5:{n:"LineCount",t:dt},6:{n:"ParagraphCount",t:dt},7:{n:"SlideCount",t:dt},8:{n:"NoteCount",t:dt},9:{n:"HiddenCount",t:dt},10:{n:"MultimediaClipCount",t:dt},11:{n:"ScaleCrop",t:jn},12:{n:"HeadingPairs",t:lf},13:{n:"TitlesOfParts",t:cf},14:{n:"Manager",t:Xe},15:{n:"Company",t:Xe},16:{n:"LinksUpToDate",t:jn},17:{n:"CharacterCount",t:dt},19:{n:"SharedDoc",t:jn},22:{n:"HyperlinksChanged",t:jn},23:{n:"AppVersion",t:dt,p:"version"},24:{n:"DigSig",t:af},26:{n:"ContentType",t:Xe},27:{n:"ContentStatus",t:Xe},28:{n:"Language",t:Xe},29:{n:"Version",t:Xe},255:{},2147483648:{n:"Locale",t:ii},2147483651:{n:"Behavior",t:ii},1919054434:{}},Pa={1:{n:"CodePage",t:Zo},2:{n:"Title",t:Xe},3:{n:"Subject",t:Xe},4:{n:"Author",t:Xe},5:{n:"Keywords",t:Xe},6:{n:"Comments",t:Xe},7:{n:"Template",t:Xe},8:{n:"LastAuthor",t:Xe},9:{n:"RevNumber",t:Xe},10:{n:"EditTime",t:Wn},11:{n:"LastPrinted",t:Wn},12:{n:"CreatedDate",t:Wn},13:{n:"ModifiedDate",t:Wn},14:{n:"PageCount",t:dt},15:{n:"WordCount",t:dt},16:{n:"CharCount",t:dt},17:{n:"Thumbnail",t:of},18:{n:"Application",t:Xe},19:{n:"DocSecurity",t:dt},255:{},2147483648:{n:"Locale",t:ii},2147483651:{n:"Behavior",t:ii},1919054434:{}};function hf(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var uf=hf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ff=ht(uf),kn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},df={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hn={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qo(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function el(t,e){var r=Eu(df),n=[],i;n[n.length]=Be,n[n.length]=J("Types",null,{xmlns:We.CT,"xmlns:xsd":We.xsd,"xmlns:xsi":We.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return J("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=J("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Hn[l][e.bookType]||Hn[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=J("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Hn[l][e.bookType]||Hn[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=J("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var pe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tl(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Wr(t){var e=[Be,J("Relationships",null,{xmlns:We.RELS})];return Qe(t["!id"]).forEach(function(r){e[e.length]=J("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function xe(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[pe.HLINK,pe.XPATH,pe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function pf(t){var e=[Be];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Na(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function gf(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function vf(t){var e=[Be];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Na(t[r][0],t[r][1])),e.push(gf("",t[r][0]));return e.push(Na("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function rl(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xn.version+"</meta:generator></office:meta></office:document-meta>"}var gr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Mi(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=_e(e),n[n.length]=r?J(t,e,r):Ye(t,e))}function nl(t,e){var r=e||{},n=[Be,J("cp:coreProperties",null,{"xmlns:cp":We.CORE_PROPS,"xmlns:dc":We.dc,"xmlns:dcterms":We.dcterms,"xmlns:dcmitype":We.dcmitype,"xmlns:xsi":We.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Mi("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:rs(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Mi("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:rs(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=gr.length;++s){var a=gr[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Mi(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Hr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],il=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sl(t){var e=[],r=J;return t||(t={}),t.Application="SheetJS",e[e.length]=Be,e[e.length]=J("Properties",null,{xmlns:We.EXT_PROPS,"xmlns:vt":We.vt}),Hr.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=_e(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+_e(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function al(t){var e=[Be,J("Properties",null,{xmlns:We.CUST_PROPS,"xmlns:vt":We.vt})];if(!t)return e.join("");var r=1;return Qe(t).forEach(function(i){++r,e[e.length]=J("property",Pu(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:_e(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Da={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function mf(t,e){var r=[];return Qe(Da).map(function(n){for(var i=0;i<gr.length;++i)if(gr[i][1]==n)return gr[i];for(i=0;i<Hr.length;++i)if(Hr[i][1]==n)return Hr[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Ye(Da[n[1]]||n[1],i))}}),J("DocumentProperties",r.join(""),{xmlns:gt.o})}function xf(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Qe(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<gr.length;++a)if(s==gr[a][1])return;for(a=0;a<Hr.length;++a)if(s==Hr[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(J(Ea(s),o,{"dt:dt":l}))}}),e&&Qe(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(J(Ea(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+gt.o+'">'+i.join("")+"</"+n+">"}function _f(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=B(8);return a.write_shift(4,n),a.write_shift(4,i),a}function La(t,e){var r=B(4),n=B(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=B(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=_f(e);break;case 31:case 80:for(n=B(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Je([r,n])}var ol=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function wf(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Ba(t,e,r){var n=B(8),i=[],s=[],a=8,o=0,l=B(8),c=B(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=B(8),c.write_shift(4,0),i.unshift(c);var h=[B(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=B(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Je(h),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(ol.indexOf(t[o][0])>-1||il.indexOf(t[o][0])>-1)&&t[o][1]!=null){var u=t[o][1],f=0;if(e){f=+e[t[o][0]];var v=r[f];if(v.p=="version"&&typeof u=="string"){var d=u.split(".");u=(+d[0]<<16)+(+d[1]||0)}l=La(v.t,u)}else{var m=wf(u);m==-1&&(m=31,u=String(u)),l=La(m,u)}s.push(l),c=B(8),c.write_shift(4,e?f:2+o),i.push(c),a+=8+l.length}var S=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,S),S+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Je([n].concat(i).concat(s))}function Ma(t,e,r,n,i,s){var a=B(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ee.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=Ba(t,r,n);if(o.push(l),i){var c=Ba(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Je(o)}function yf(t,e){e||(e=B(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function Ef(t,e){return t.read_shift(e)===1}function st(t,e){return e||(e=B(2)),e.write_shift(2,+!!t),e}function ll(t){return t.read_shift(2,"u")}function Tt(t,e){return e||(e=B(2)),e.write_shift(2,t),e}function cl(t,e,r){return r||(r=B(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function hl(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function Tf(t){var e=t.t||"",r=B(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=B(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Je(i)}function Sf(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Af(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Sf(t,n,r)}function bf(t,e,r){if(r.biff>5)return Af(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function ul(t,e,r){return r||(r=B(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Ua(t,e){e||(e=B(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Of(t){var e=B(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),Ua(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&Ua(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function xr(t,e,r,n){return n||(n=B(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function kf(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function Cf(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function fl(t,e){return e||(e=B(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Ts(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=B(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Rf(t,e){var r=!e||e.biff==8,n=B(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function If(t,e){var r=!e||e.biff>=8?2:1,n=B(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Ff(t,e){var r=B(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=Tf(t[i]);var s=Je([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function Pf(){var t=B(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Nf(t){var e=B(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Df(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=B(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Lf(t,e,r,n){var i=B(10);return xr(t,e,n,i),i.write_shift(4,r),i}function Bf(t,e,r,n,i){var s=!i||i.biff==8,a=B(8+ +s+(1+s)*r.length);return xr(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function Mf(t,e,r,n){var i=r&&r.biff==5;n||(n=B(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function Uf(t,e){var r=e.biff==8||!e.biff?4:2,n=B(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function $a(t,e,r,n){var i=r&&r.biff==5;n||(n=B(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function $f(t){var e=B(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function jf(t,e,r,n,i,s){var a=B(8);return xr(t,e,n,a),cl(r,s,a),a}function Wf(t,e,r,n){var i=B(14);return xr(t,e,n,i),mr(r,i),i}function Hf(t,e,r){if(r.biff<8)return Vf(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(kf(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function Vf(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=hl(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Gf(t){var e=B(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)fl(t[r],e);return e}function Kf(t){var e=B(24),r=He(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Je([e,Of(t[1])])}function zf(t){var e=t[1].Tooltip,r=B(10+2*(e.length+1));r.write_shift(2,2048);var n=He(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function qf(t){return t||(t=B(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Xf(t,e,r){if(!r.cellStyles)return Bt(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Jf(t,e){var r=B(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Yf(t){for(var e=B(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function Zf(t,e,r){var n=B(15);return Rn(n,t,e),n.write_shift(8,r,"f"),n}function Qf(t,e,r){var n=B(9);return Rn(n,t,e),n.write_shift(2,r),n}var ed=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=fs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],h=vr(1);switch(l.type){case"base64":h=It(Gt(o));break;case"binary":h=It(o);break;case"buffer":case"array":h=o;break}pt(h,0);var p=h.read_shift(1),u=!!(p&136),f=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:f=!0,u=!0;break;case 49:f=!0,u=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var d=0,m=521;p==2&&(d=h.read_shift(2)),h.l+=3,p!=2&&(d=h.read_shift(4)),d>1048576&&(d=1e6),p!=2&&(m=h.read_shift(2));var S=h.read_shift(2),A=l.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(A=t[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var T=[],R={},H=Math.min(h.length,p==2?521:m-10-(f?264:0)),K=v?32:11;h.l<H&&h[h.l]!=13;)switch(R={},R.name=Jn.utils.decode(A,h.slice(h.l,h.l+K)).replace(/[\u0000\r\n].*$/g,""),h.l+=K,R.type=String.fromCharCode(h.read_shift(1)),p!=2&&!v&&(R.offset=h.read_shift(4)),R.len=h.read_shift(1),p==2&&(R.offset=h.read_shift(2)),R.dec=h.read_shift(1),R.name.length&&T.push(R),p!=2&&(h.l+=v?13:14),R.type){case"B":(!f||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(h[h.l]!==13&&(h.l=m-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=m;var k=0,U=0;for(c[0]=[],U=0;U!=T.length;++U)c[0][U]=T[U].name;for(;d-- >0;){if(h[h.l]===42){h.l+=S;continue}for(++h.l,c[++k]=[],U=0,U=0;U!=T.length;++U){var P=h.slice(h.l,h.l+T[U].len);h.l+=T[U].len,pt(P,0);var V=Jn.utils.decode(A,P);switch(T[U].type){case"C":V.trim().length&&(c[k][U]=V.replace(/\s+$/,""));break;case"D":V.length===8?c[k][U]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):c[k][U]=V;break;case"F":c[k][U]=parseFloat(V.trim());break;case"+":case"I":c[k][U]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":c[k][U]=!0;break;case"N":case"F":c[k][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));c[k][U]="##MEMO##"+(v?parseInt(V.trim(),10):P.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(c[k][U]=+V||0);break;case"@":c[k][U]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[k][U]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[k][U]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][U]=-P.read_shift(-8,"f");break;case"B":if(f&&T[U].len==8){c[k][U]=P.read_shift(8,"f");break}case"G":case"P":P.l+=T[U].len;break;case"0":if(T[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[U].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=T,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=zr(r(o,c),c);return h["!cols"]=c.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete c.DBF,h}function i(o,l){try{return _r(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&mn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=lt(),p=ci(o,{header:1,raw:!0,cellDates:!0}),u=p[0],f=p.slice(1),v=o["!cols"]||[],d=0,m=0,S=0,A=1;for(d=0;d<u.length;++d){if(((v[d]||{}).DBF||{}).name){u[d]=v[d].DBF.name,++S;continue}if(u[d]!=null){if(++S,typeof u[d]=="number"&&(u[d]=u[d].toString(10)),typeof u[d]!="string")throw new Error("DBF Invalid column name "+u[d]+" |"+typeof u[d]+"|");if(u.indexOf(u[d])!==d){for(m=0;m<1024;++m)if(u.indexOf(u[d]+"_"+m)==-1){u[d]+="_"+m;break}}}}var T=Ae(o["!ref"]),R=[],H=[],K=[];for(d=0;d<=T.e.c-T.s.c;++d){var k="",U="",P=0,V=[];for(m=0;m<f.length;++m)f[m][d]!=null&&V.push(f[m][d]);if(V.length==0||u[d]==null){R[d]="?";continue}for(m=0;m<V.length;++m){switch(typeof V[m]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=V[m]instanceof Date?"D":"C";break;default:U="C"}P=Math.max(P,String(V[m]).length),k=k&&k!=U?"C":U}P>250&&(P=250),U=((v[d]||{}).DBF||{}).type,U=="C"&&v[d].DBF.len>P&&(P=v[d].DBF.len),k=="B"&&U=="N"&&(k="N",K[d]=v[d].DBF.dec,P=v[d].DBF.len),H[d]=k=="C"||U=="N"?P:s[k]||0,A+=H[d],R[d]=k}var G=h.next(32);for(G.write_shift(4,318902576),G.write_shift(4,f.length),G.write_shift(2,296+32*S),G.write_shift(2,A),d=0;d<4;++d)G.write_shift(4,0);for(G.write_shift(4,0|(+e[po]||3)<<8),d=0,m=0;d<u.length;++d)if(u[d]!=null){var q=h.next(32),te=(u[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,te,"sbcs"),q.write_shift(1,R[d]=="?"?"C":R[d],"sbcs"),q.write_shift(4,m),q.write_shift(1,H[d]||s[R[d]]||0),q.write_shift(1,K[d]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),m+=H[d]||s[R[d]]||0}var ye=h.next(264);for(ye.write_shift(4,13),d=0;d<65;++d)ye.write_shift(4,0);for(d=0;d<f.length;++d){var ue=h.next(A);for(ue.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(R[m]){case"L":ue.write_shift(1,f[d][m]==null?63:f[d][m]?84:70);break;case"B":ue.write_shift(8,f[d][m]||0,"f");break;case"N":var Ge="0";for(typeof f[d][m]=="number"&&(Ge=f[d][m].toFixed(K[m]||0)),S=0;S<H[m]-Ge.length;++S)ue.write_shift(1,32);ue.write_shift(1,Ge,"sbcs");break;case"D":f[d][m]?(ue.write_shift(4,("0000"+f[d][m].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(f[d][m].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+f[d][m].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var Pe=String(f[d][m]!=null?f[d][m]:"").slice(0,H[m]);for(ue.write_shift(1,Pe,"sbcs"),S=0;S<H[m]-Pe.length;++S)ue.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),td=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Qe(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,f){var v=t[f];return typeof v=="number"?ha(v):v},n=function(u,f,v){var d=f.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return d==59?u:ha(d)};t["|"]=254;function i(u,f){switch(f.type){case"base64":return s(Gt(u),f);case"binary":return s(u,f);case"buffer":return s(ge&&Buffer.isBuffer(u)?u.toString("binary"):An(u),f);case"array":return s(mi(u),f)}throw new Error("Unrecognized type "+f.type)}function s(u,f){var v=u.split(/[\n\r]+/),d=-1,m=-1,S=0,A=0,T=[],R=[],H=null,K={},k=[],U=[],P=[],V=0,G;for(+f.codepage>=0&&mn(+f.codepage);S!==v.length;++S){V=0;var q=v[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),te=q.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),ye=te[0],ue;if(q.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&R.push(q.slice(3).replace(/;;/g,";"));break;case"C":var Ge=!1,Pe=!1,At=!1,$e=!1,wt=-1,ut=-1;for(A=1;A<te.length;++A)switch(te[A].charAt(0)){case"A":break;case"X":m=parseInt(te[A].slice(1))-1,Pe=!0;break;case"Y":for(d=parseInt(te[A].slice(1))-1,Pe||(m=0),G=T.length;G<=d;++G)T[G]=[];break;case"K":ue=te[A].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Ht(ue))?isNaN(_n(ue).getDate())||(ue=at(ue)):(ue=Ht(ue),H!==null&&bo(H)&&(ue=Ro(ue))),Ge=!0;break;case"E":$e=!0;var b=Qd(te[A].slice(1),{r:d,c:m});T[d][m]=[T[d][m],b];break;case"S":At=!0,T[d][m]=[T[d][m],"S5S"];break;case"G":break;case"R":wt=parseInt(te[A].slice(1))-1;break;case"C":ut=parseInt(te[A].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}if(Ge&&(T[d][m]&&T[d][m].length==2?T[d][m][0]=ue:T[d][m]=ue,H=null),At){if($e)throw new Error("SYLK shared formula cannot have own formula");var L=wt>-1&&T[wt][ut];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");T[d][m][1]=e1(L[1],{r:d-wt,c:m-ut})}break;case"F":var C=0;for(A=1;A<te.length;++A)switch(te[A].charAt(0)){case"X":m=parseInt(te[A].slice(1))-1,++C;break;case"Y":for(d=parseInt(te[A].slice(1))-1,G=T.length;G<=d;++G)T[G]=[];break;case"M":V=parseInt(te[A].slice(1))/20;break;case"F":break;case"G":break;case"P":H=R[parseInt(te[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=te[A].slice(1).split(" "),G=parseInt(P[0],10);G<=parseInt(P[1],10);++G)V=parseInt(P[2],10),U[G-1]=V===0?{hidden:!0}:{wch:V},Ss(U[G-1]);break;case"C":m=parseInt(te[A].slice(1))-1,U[m]||(U[m]={});break;case"R":d=parseInt(te[A].slice(1))-1,k[d]||(k[d]={}),V>0?(k[d].hpt=V,k[d].hpx=ml(V)):V===0&&(k[d].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}C<1&&(H=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+q)}}return k.length>0&&(K["!rows"]=k),U.length>0&&(K["!cols"]=U),f&&f.sheetRows&&(T=T.slice(0,f.sheetRows)),[T,K]}function a(u,f){var v=i(u,f),d=v[0],m=v[1],S=zr(d,f);return Qe(m).forEach(function(A){S[A]=m[A]}),S}function o(u,f){return _r(a(u,f),f)}function l(u,f,v,d){var m="C;Y"+(v+1)+";X"+(d+1)+";K";switch(u.t){case"n":m+=u.v||0,u.f&&!u.F&&(m+=";E"+bs(u.f,{r:v,c:d}));break;case"b":m+=u.v?"TRUE":"FALSE";break;case"e":m+=u.w||u.v;break;case"d":m+='"'+(u.w||u.v)+'"';break;case"s":m+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(u,f){f.forEach(function(v,d){var m="F;W"+(d+1)+" "+(d+1)+" ";v.hidden?m+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=si(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ai(v.wpx)),typeof v.wch=="number"&&(m+=Math.round(v.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function h(u,f){f.forEach(function(v,d){var m="F;";v.hidden?m+="M0;":v.hpt?m+="M"+20*v.hpt+";":v.hpx&&(m+="M"+20*oi(v.hpx)+";"),m.length>2&&u.push(m+"R"+(d+1))})}function p(u,f){var v=["ID;PWXL;N;E"],d=[],m=Ae(u["!ref"]),S,A=Array.isArray(u),T=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),u["!cols"]&&c(v,u["!cols"]),u["!rows"]&&h(v,u["!rows"]),v.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var R=m.s.r;R<=m.e.r;++R)for(var H=m.s.c;H<=m.e.c;++H){var K=we({r:R,c:H});S=A?(u[R]||[])[H]:u[K],!(!S||S.v==null&&(!S.f||S.F))&&d.push(l(S,u,R,H))}return v.join(T)+T+d.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),rd=function(){function t(s,a){switch(a.type){case"base64":return e(Gt(s),a);case"binary":return e(s,a);case"buffer":return e(ge&&Buffer.isBuffer(s)?s.toString("binary"):An(s),a);case"array":return e(mi(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,p=[];h!==o.length;++h){if(o[h].trim()==="BOT"){p[++l]=[],c=0;continue}if(!(l<0)){var u=o[h].trim().split(","),f=u[0],v=u[1];++h;for(var d=o[h]||"";(d.match(/["]/g)||[]).length&1&&h<o.length-1;)d+=`
`+o[++h];switch(d=d.trim(),+f){case-1:if(d==="BOT"){p[++l]=[],c=0;continue}else if(d!=="EOD")throw new Error("Unrecognized DIF special command "+d);break;case 0:d==="TRUE"?p[l][c]=!0:d==="FALSE"?p[l][c]=!1:isNaN(Ht(v))?isNaN(_n(v).getDate())?p[l][c]=v:p[l][c]=at(v):p[l][c]=Ht(v),++c;break;case 1:d=d.slice(1,d.length-1),d=d.replace(/""/g,'"'),d&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),p[l][c++]=d!==""?d:null;break}if(d==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return zr(t(s,a),a)}function n(s,a){return _r(r(s,a),a)}var i=function(){var s=function(l,c,h,p,u){l.push(c),l.push(h+","+p),l.push('"'+u.replace(/"/g,'""')+'"')},a=function(l,c,h,p){l.push(c+","+h),l.push(c==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var c=[],h=Ae(l["!ref"]),p,u=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var f=h.s.r;f<=h.e.r;++f){a(c,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var d=we({r:f,c:v});if(p=u?(l[f]||[])[v]:l[d],!p){a(c,1,0,"");continue}switch(p.t){case"n":var m=p.w;!m&&p.v!=null&&(m=p.v),m==null?p.f&&!p.F?a(c,1,0,"="+p.f):a(c,1,0,""):a(c,0,m,"V");break;case"b":a(c,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=tr(p.z||Fe[14],ct(at(p.v)))),a(c,0,p.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var S=`\r
`,A=c.join(S);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),dl=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,u){for(var f=p.split(`
`),v=-1,d=-1,m=0,S=[];m!==f.length;++m){var A=f[m].trim().split(":");if(A[0]==="cell"){var T=He(A[1]);if(S.length<=T.r)for(v=S.length;v<=T.r;++v)S[v]||(S[v]=[]);switch(v=T.r,d=T.c,A[2]){case"t":S[v][d]=t(A[3]);break;case"v":S[v][d]=+A[3];break;case"vtf":var R=A[A.length-1];case"vtc":switch(A[3]){case"nl":S[v][d]=!!+A[4];break;default:S[v][d]=+A[4];break}A[2]=="vtf"&&(S[v][d]=[S[v][d],R])}}}return u&&u.sheetRows&&(S=S.slice(0,u.sheetRows)),S}function n(p,u){return zr(r(p,u),u)}function i(p,u){return _r(n(p,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(p){if(!p||!p["!ref"])return"";for(var u=[],f=[],v,d="",m=_t(p["!ref"]),S=Array.isArray(p),A=m.s.r;A<=m.e.r;++A)for(var T=m.s.c;T<=m.e.c;++T)if(d=we({r:A,c:T}),v=S?(p[A]||[])[T]:p[d],!(!v||v.v==null||v.t==="z")){switch(f=["cell",d,"t"],v.t){case"s":case"str":f.push(e(v.v));break;case"n":v.f?(f[2]="vtf",f[3]="n",f[4]=v.v,f[5]=e(v.f)):(f[2]="v",f[3]=v.v);break;case"b":f[2]="vt"+(v.f?"f":"c"),f[3]="nl",f[4]=v.v?"1":"0",f[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var R=ct(at(v.v));f[2]="vtc",f[3]="nd",f[4]=""+R,f[5]=v.w||tr(v.z||Fe[14],R);break;case"e":continue}u.push(f.join(":"))}return u.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(p){return[s,a,o,a,c(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),nd=function(){function t(h,p,u,f,v){v.raw?p[u][f]=h:h===""||(h==="TRUE"?p[u][f]=!0:h==="FALSE"?p[u][f]=!1:isNaN(Ht(h))?isNaN(_n(h).getDate())?p[u][f]=h:p[u][f]=at(h):p[u][f]=Ht(h))}function e(h,p){var u=p||{},f=[];if(!h||h.length===0)return f;for(var v=h.split(/[\r\n]/),d=v.length-1;d>=0&&v[d].length===0;)--d;for(var m=10,S=0,A=0;A<=d;++A)S=v[A].indexOf(" "),S==-1?S=v[A].length:S++,m=Math.max(m,S);for(A=0;A<=d;++A){f[A]=[];var T=0;for(t(v[A].slice(0,m).trim(),f,A,T,u),T=1;T<=(v[A].length-m)/10+1;++T)t(v[A].slice(m+(T-1)*10,m+T*10).trim(),f,A,T,u)}return u.sheetRows&&(f=f.slice(0,u.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var p={},u=!1,f=0,v=0;f<h.length;++f)(v=h.charCodeAt(f))==34?u=!u:!u&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(f in p)Object.prototype.hasOwnProperty.call(p,f)&&v.push([p[f],f]);if(!v.length){p=n;for(f in p)Object.prototype.hasOwnProperty.call(p,f)&&v.push([p[f],f])}return v.sort(function(d,m){return d[0]-m[0]||n[d[1]]-n[m[1]]}),r[v.pop()[1]]||44}function s(h,p){var u=p||{},f="",v=u.dense?[]:{},d={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(f=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(f=h.charAt(4),h=h.slice(6)):f=i(h.slice(0,1024)):u&&u.FS?f=u.FS:f=i(h.slice(0,1024));var m=0,S=0,A=0,T=0,R=0,H=f.charCodeAt(0),K=!1,k=0,U=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=u.dateNF!=null?xu(u.dateNF):null;function V(){var G=h.slice(T,R),q={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)q.t="z";else if(u.raw)q.t="s",q.v=G;else if(G.trim().length===0)q.t="s",q.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(q.t="s",q.v=G.slice(2,-1).replace(/""/g,'"')):t1(G)?(q.t="n",q.f=G.slice(1)):(q.t="s",q.v=G);else if(G=="TRUE")q.t="b",q.v=!0;else if(G=="FALSE")q.t="b",q.v=!1;else if(!isNaN(A=Ht(G)))q.t="n",u.cellText!==!1&&(q.w=G),q.v=A;else if(!isNaN(_n(G).getDate())||P&&G.match(P)){q.z=u.dateNF||Fe[14];var te=0;P&&G.match(P)&&(G=_u(G,u.dateNF,G.match(P)||[]),te=1),u.cellDates?(q.t="d",q.v=at(G,te)):(q.t="n",q.v=ct(at(G,te))),u.cellText!==!1&&(q.w=tr(q.z,q.v instanceof Date?ct(q.v):q.v)),u.cellNF||delete q.z}else q.t="s",q.v=G;if(q.t=="z"||(u.dense?(v[m]||(v[m]=[]),v[m][S]=q):v[we({c:S,r:m})]=q),T=R+1,U=h.charCodeAt(T),d.e.c<S&&(d.e.c=S),d.e.r<m&&(d.e.r=m),k==H)++S;else if(S=0,++m,u.sheetRows&&u.sheetRows<=m)return!0}e:for(;R<h.length;++R)switch(k=h.charCodeAt(R)){case 34:U===34&&(K=!K);break;case H:case 10:case 13:if(!K&&V())break e;break}return R-T>0&&V(),v["!ref"]=Le(d),v}function a(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,p):zr(e(h,p),p)}function o(h,p){var u="",f=p.type=="string"?[0,0,0,0]:gm(h,p);switch(p.type){case"base64":u=Gt(h);break;case"binary":u=h;break;case"buffer":p.codepage==65001?u=h.toString("utf8"):p.codepage&&typeof Jn<"u"||(u=ge&&Buffer.isBuffer(h)?h.toString("binary"):An(h));break;case"array":u=mi(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+p.type)}return f[0]==239&&f[1]==187&&f[2]==191?u=an(u.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?u=an(u):p.type=="binary"&&typeof Jn<"u",u.slice(0,19)=="socialcalc:version:"?dl.to_sheet(p.type=="string"?u:an(u),p):a(u,p)}function l(h,p){return _r(o(h,p),p)}function c(h){for(var p=[],u=Ae(h["!ref"]),f,v=Array.isArray(h),d=u.s.r;d<=u.e.r;++d){for(var m=[],S=u.s.c;S<=u.e.c;++S){var A=we({r:d,c:S});if(f=v?(h[d]||[])[S]:h[A],!f||f.v==null){m.push("          ");continue}for(var T=(f.w||(Kt(f),f.w)||"").slice(0,10);T.length<10;)T+=" ";m.push(T+(S===0?" ":""))}p.push(m.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),ja=function(){function t(b,L,C){if(b){pt(b,b.l||0);for(var O=C.Enum||wt;b.l<b.length;){var W=b.read_shift(2),se=O[W]||O[65535],oe=b.read_shift(2),ie=b.l+oe,Q=se.f&&se.f(b,oe,C);if(b.l=ie,L(Q,se,W))return}}}function e(b,L){switch(L.type){case"base64":return r(It(Gt(b)),L);case"binary":return r(It(b),L);case"buffer":case"array":return r(b,L)}throw"Unsupported type "+L.type}function r(b,L){if(!b)return b;var C=L||{},O=C.dense?[]:{},W="Sheet1",se="",oe=0,ie={},Q=[],Te=[],de={s:{r:0,c:0},e:{r:0,c:0}},nt=C.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)C.Enum=wt,t(b,function(ne,yt,Ut){switch(Ut){case 0:C.vers=ne,ne>=4096&&(C.qpro=!0);break;case 6:de=ne;break;case 204:ne&&(se=ne);break;case 222:se=ne;break;case 15:case 51:C.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:Ut==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=C.dateNF||Fe[14],C.cellDates&&(ne[1].t="d",ne[1].v=Ro(ne[1].v))),C.qpro&&ne[3]>oe&&(O["!ref"]=Le(de),ie[W]=O,Q.push(W),O=C.dense?[]:{},de={s:{r:0,c:0},e:{r:0,c:0}},oe=ne[3],W=se||"Sheet"+(oe+1),se="");var sr=C.dense?(O[ne[0].r]||[])[ne[0].c]:O[we(ne[0])];if(sr){sr.t=ne[1].t,sr.v=ne[1].v,ne[1].z!=null&&(sr.z=ne[1].z),ne[1].f!=null&&(sr.f=ne[1].f);break}C.dense?(O[ne[0].r]||(O[ne[0].r]=[]),O[ne[0].r][ne[0].c]=ne[1]):O[we(ne[0])]=ne[1];break}},C);else if(b[2]==26||b[2]==14)C.Enum=ut,b[2]==14&&(C.qpro=!0,b.l=0),t(b,function(ne,yt,Ut){switch(Ut){case 204:W=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>oe&&(O["!ref"]=Le(de),ie[W]=O,Q.push(W),O=C.dense?[]:{},de={s:{r:0,c:0},e:{r:0,c:0}},oe=ne[3],W="Sheet"+(oe+1)),nt>0&&ne[0].r>=nt)break;C.dense?(O[ne[0].r]||(O[ne[0].r]=[]),O[ne[0].r][ne[0].c]=ne[1]):O[we(ne[0])]=ne[1],de.e.c<ne[0].c&&(de.e.c=ne[0].c),de.e.r<ne[0].r&&(de.e.r=ne[0].r);break;case 27:ne[14e3]&&(Te[ne[14e3][0]]=ne[14e3][1]);break;case 1537:Te[ne[0]]=ne[1],ne[0]==oe&&(W=ne[1]);break}},C);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(O["!ref"]=Le(de),ie[se||W]=O,Q.push(se||W),!Te.length)return{SheetNames:Q,Sheets:ie};for(var ve={},Mt=[],Ce=0;Ce<Te.length;++Ce)ie[Q[Ce]]?(Mt.push(Te[Ce]||Q[Ce]),ve[Te[Ce]]=ie[Te[Ce]]||ie[Q[Ce]]):(Mt.push(Te[Ce]),ve[Te[Ce]]={"!ref":"A1"});return{SheetNames:Mt,Sheets:ve}}function n(b,L){var C=L||{};if(+C.codepage>=0&&mn(+C.codepage),C.type=="string")throw new Error("Cannot write WK1 to JS string");var O=lt(),W=Ae(b["!ref"]),se=Array.isArray(b),oe=[];Y(O,0,s(1030)),Y(O,6,l(W));for(var ie=Math.min(W.e.r,8191),Q=W.s.r;Q<=ie;++Q)for(var Te=Ze(Q),de=W.s.c;de<=W.e.c;++de){Q===W.s.r&&(oe[de]=tt(de));var nt=oe[de]+Te,ve=se?(b[Q]||[])[de]:b[nt];if(!(!ve||ve.t=="z"))if(ve.t=="n")(ve.v|0)==ve.v&&ve.v>=-32768&&ve.v<=32767?Y(O,13,f(Q,de,ve.v)):Y(O,14,d(Q,de,ve.v));else{var Mt=Kt(ve);Y(O,15,p(Q,de,Mt.slice(0,239)))}}return Y(O,1),O.end()}function i(b,L){var C=L||{};if(+C.codepage>=0&&mn(+C.codepage),C.type=="string")throw new Error("Cannot write WK3 to JS string");var O=lt();Y(O,0,a(b));for(var W=0,se=0;W<b.SheetNames.length;++W)(b.Sheets[b.SheetNames[W]]||{})["!ref"]&&Y(O,27,$e(b.SheetNames[W],se++));var oe=0;for(W=0;W<b.SheetNames.length;++W){var ie=b.Sheets[b.SheetNames[W]];if(!(!ie||!ie["!ref"])){for(var Q=Ae(ie["!ref"]),Te=Array.isArray(ie),de=[],nt=Math.min(Q.e.r,8191),ve=Q.s.r;ve<=nt;++ve)for(var Mt=Ze(ve),Ce=Q.s.c;Ce<=Q.e.c;++Ce){ve===Q.s.r&&(de[Ce]=tt(Ce));var ne=de[Ce]+Mt,yt=Te?(ie[ve]||[])[Ce]:ie[ne];if(!(!yt||yt.t=="z"))if(yt.t=="n")Y(O,23,V(ve,Ce,oe,yt.v));else{var Ut=Kt(yt);Y(O,22,k(ve,Ce,oe,Ut.slice(0,239)))}}++oe}}return Y(O,1),O.end()}function s(b){var L=B(2);return L.write_shift(2,b),L}function a(b){var L=B(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var C=0,O=0,W=0,se=0;se<b.SheetNames.length;++se){var oe=b.SheetNames[se],ie=b.Sheets[oe];if(!(!ie||!ie["!ref"])){++W;var Q=_t(ie["!ref"]);C<Q.e.r&&(C=Q.e.r),O<Q.e.c&&(O=Q.e.c)}}return C>8191&&(C=8191),L.write_shift(2,C),L.write_shift(1,W),L.write_shift(1,O),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(b,L,C){var O={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&C.qpro?(O.s.c=b.read_shift(1),b.l++,O.s.r=b.read_shift(2),O.e.c=b.read_shift(1),b.l++,O.e.r=b.read_shift(2),O):(O.s.c=b.read_shift(2),O.s.r=b.read_shift(2),L==12&&C.qpro&&(b.l+=2),O.e.c=b.read_shift(2),O.e.r=b.read_shift(2),L==12&&C.qpro&&(b.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function l(b){var L=B(8);return L.write_shift(2,b.s.c),L.write_shift(2,b.s.r),L.write_shift(2,b.e.c),L.write_shift(2,b.e.r),L}function c(b,L,C){var O=[{c:0,r:0},{t:"n",v:0},0,0];return C.qpro&&C.vers!=20768?(O[0].c=b.read_shift(1),O[3]=b.read_shift(1),O[0].r=b.read_shift(2),b.l+=2):(O[2]=b.read_shift(1),O[0].c=b.read_shift(2),O[0].r=b.read_shift(2)),O}function h(b,L,C){var O=b.l+L,W=c(b,L,C);if(W[1].t="s",C.vers==20768){b.l++;var se=b.read_shift(1);return W[1].v=b.read_shift(se,"utf8"),W}return C.qpro&&b.l++,W[1].v=b.read_shift(O-b.l,"cstr"),W}function p(b,L,C){var O=B(7+C.length);O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,b),O.write_shift(1,39);for(var W=0;W<O.length;++W){var se=C.charCodeAt(W);O.write_shift(1,se>=128?95:se)}return O.write_shift(1,0),O}function u(b,L,C){var O=c(b,L,C);return O[1].v=b.read_shift(2,"i"),O}function f(b,L,C){var O=B(7);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,b),O.write_shift(2,C,"i"),O}function v(b,L,C){var O=c(b,L,C);return O[1].v=b.read_shift(8,"f"),O}function d(b,L,C){var O=B(13);return O.write_shift(1,255),O.write_shift(2,L),O.write_shift(2,b),O.write_shift(8,C,"f"),O}function m(b,L,C){var O=b.l+L,W=c(b,L,C);if(W[1].v=b.read_shift(8,"f"),C.qpro)b.l=O;else{var se=b.read_shift(2);R(b.slice(b.l,b.l+se),W),b.l+=se}return W}function S(b,L,C){var O=L&32768;return L&=-32769,L=(O?b:0)+(L>=8192?L-16384:L),(O?"":"$")+(C?tt(L):Ze(L))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(b,L){pt(b,0);for(var C=[],O=0,W="",se="",oe="",ie="";b.l<b.length;){var Q=b[b.l++];switch(Q){case 0:C.push(b.read_shift(8,"f"));break;case 1:se=S(L[0].c,b.read_shift(2),!0),W=S(L[0].r,b.read_shift(2),!1),C.push(se+W);break;case 2:{var Te=S(L[0].c,b.read_shift(2),!0),de=S(L[0].r,b.read_shift(2),!1);se=S(L[0].c,b.read_shift(2),!0),W=S(L[0].r,b.read_shift(2),!1),C.push(Te+de+":"+se+W)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:C.push("("+C.pop()+")");break;case 5:C.push(b.read_shift(2));break;case 6:{for(var nt="";Q=b[b.l++];)nt+=String.fromCharCode(Q);C.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:C.push("-"+C.pop());break;case 23:C.push("+"+C.pop());break;case 22:C.push("NOT("+C.pop()+")");break;case 20:case 21:ie=C.pop(),oe=C.pop(),C.push(["AND","OR"][Q-20]+"("+oe+","+ie+")");break;default:if(Q<32&&T[Q])ie=C.pop(),oe=C.pop(),C.push(oe+T[Q]+ie);else if(A[Q]){if(O=A[Q][1],O==69&&(O=b[b.l++]),O>C.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+C.join("|")+"|");return}var ve=C.slice(-O);C.length-=O,C.push(A[Q][0]+"("+ve.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}C.length==1?L[1].f=""+C[0]:console.error("WK1 bad formula parse |"+C.join("|")+"|")}function H(b){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=b.read_shift(2),L[3]=b[b.l++],L[0].c=b[b.l++],L}function K(b,L){var C=H(b);return C[1].t="s",C[1].v=b.read_shift(L-4,"cstr"),C}function k(b,L,C,O){var W=B(6+O.length);W.write_shift(2,b),W.write_shift(1,C),W.write_shift(1,L),W.write_shift(1,39);for(var se=0;se<O.length;++se){var oe=O.charCodeAt(se);W.write_shift(1,oe>=128?95:oe)}return W.write_shift(1,0),W}function U(b,L){var C=H(b);C[1].v=b.read_shift(2);var O=C[1].v>>1;if(C[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return C[1].v=O,C}function P(b,L){var C=H(b),O=b.read_shift(4),W=b.read_shift(4),se=b.read_shift(2);if(se==65535)return O===0&&W===3221225472?(C[1].t="e",C[1].v=15):O===0&&W===3489660928?(C[1].t="e",C[1].v=42):C[1].v=0,C;var oe=se&32768;return se=(se&32767)-16446,C[1].v=(1-oe*2)*(W*Math.pow(2,se+32)+O*Math.pow(2,se)),C}function V(b,L,C,O){var W=B(14);if(W.write_shift(2,b),W.write_shift(1,C),W.write_shift(1,L),O==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var se=0,oe=0,ie=0,Q=0;return O<0&&(se=1,O=-O),oe=Math.log2(O)|0,O/=Math.pow(2,oe-31),Q=O>>>0,Q&2147483648||(O/=2,++oe,Q=O>>>0),O-=Q,Q|=2147483648,Q>>>=0,O*=Math.pow(2,32),ie=O>>>0,W.write_shift(4,ie),W.write_shift(4,Q),oe+=16383+(se?32768:0),W.write_shift(2,oe),W}function G(b,L){var C=P(b);return b.l+=L-14,C}function q(b,L){var C=H(b),O=b.read_shift(4);return C[1].v=O>>6,C}function te(b,L){var C=H(b),O=b.read_shift(8,"f");return C[1].v=O,C}function ye(b,L){var C=te(b);return b.l+=L-10,C}function ue(b,L){return b[b.l+L-1]==0?b.read_shift(L,"cstr"):""}function Ge(b,L){var C=b[b.l++];C>L-1&&(C=L-1);for(var O="";O.length<C;)O+=String.fromCharCode(b[b.l++]);return O}function Pe(b,L,C){if(!(!C.qpro||L<21)){var O=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var W=b.read_shift(L-21,"cstr");return[O,W]}}function At(b,L){for(var C={},O=b.l+L;b.l<O;){var W=b.read_shift(2);if(W==14e3){for(C[W]=[0,""],C[W][0]=b.read_shift(2);b[b.l];)C[W][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return C}function $e(b,L){var C=B(5+b.length);C.write_shift(2,14e3),C.write_shift(2,L);for(var O=0;O<b.length;++O){var W=b.charCodeAt(O);C[C.l++]=W>127?95:W}return C[C.l++]=0,C}var wt={0:{n:"BOF",f:ll},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:Ge},65535:{n:""}},ut={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:At},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),id=/^\s|\s$|[\t\n\r]/;function pl(t,e){if(!e.bookSST)return"";var r=[Be];r[r.length]=J("sst",null,{xmlns:Kr[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(id)&&(s+=' xml:space="preserve"'),s+=">"+_e(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sd(t){return[t.read_shift(4),t.read_shift(4)]}function ad(t,e){return e||(e=B(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var od=Ju;function ld(t){var e=lt();j(e,159,ad(t));for(var r=0;r<t.length;++r)j(e,19,od(t[r]));return j(e,160),e.end()}function cd(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function gl(t){var e=0,r,n=cd(t),i=n.length+1,s,a,o,l,c;for(r=vr(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var hd=function(){function t(i,s){switch(s.type){case"base64":return e(Gt(i),s);case"binary":return e(i,s);case"buffer":return e(ge&&Buffer.isBuffer(i)?i.toString("binary"):An(i),s);case"array":return e(mi(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,p){Array.isArray(o)&&(o[p]=[]);for(var u=/\\\w+\b/g,f=0,v,d=-1;v=u.exec(h);){switch(v[0]){case"\\cell":var m=h.slice(f,u.lastIndex-v[0].length);if(m[0]==" "&&(m=m.slice(1)),++d,m.length){var S={v:m,t:"s"};Array.isArray(o)?o[p][d]=S:o[we({r:p,c:d})]=S}break}f=u.lastIndex}d>c.e.c&&(c.e.c=d)}),o["!ref"]=Le(c),o}function r(i,s){return _r(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ae(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var p=we({r:c,c:h});o=l?(i[c]||[])[h]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Kt(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Wa(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var ud=6,Vt=ud;function si(t){return Math.floor((t+Math.round(128/Vt)/256)*Vt)}function ai(t){return Math.floor((t-5)/Vt*100+.5)/100}function is(t){return Math.round((t*Vt+5)/Vt*256)/256}function Ss(t){t.width?(t.wpx=si(t.width),t.wch=ai(t.wpx),t.MDW=Vt):t.wpx?(t.wch=ai(t.wpx),t.width=is(t.wch),t.MDW=Vt):typeof t.wch=="number"&&(t.width=is(t.wch),t.wpx=si(t.width),t.MDW=Vt),t.customWidth&&delete t.customWidth}var fd=96,vl=fd;function oi(t){return t*96/vl}function ml(t){return t*vl/96}function dd(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=J("numFmt",null,{numFmtId:n,formatCode:_e(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=J("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function pd(t){var e=[];return e[e.length]=J("cellXfs",null),t.forEach(function(r){e[e.length]=J("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=J("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function xl(t,e){var r=[Be,J("styleSheet",null,{xmlns:Kr[0],"xmlns:vt":We.vt})],n;return t.SSF&&(n=dd(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pd(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gd(t,e){var r=t.read_shift(2),n=rt(t);return[r,n]}function vd(t,e,r){r||(r=B(6+4*e.length)),r.write_shift(2,t),Ve(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function md(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=nf(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=rf(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=rt(t),n}function xd(t,e){e||(e=B(25+4*32)),e.write_shift(2,t.sz*20),sf(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ni(t.color,e);var n=0;return n=2,e.write_shift(1,n),Ve(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _d=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ui,wd=Bt;function Ha(t,e){e||(e=B(4*3+8*7+16*1)),Ui||(Ui=fs(_d));var r=Ui[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ni({auto:1},e),ni({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function yd(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function _l(t,e,r){r||(r=B(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qr(t,e){return e||(e=B(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ed=Bt;function Td(t,e){return e||(e=B(51)),e.write_shift(1,0),Qr(null,e),Qr(null,e),Qr(null,e),Qr(null,e),Qr(null,e),e.length>e.l?e.slice(0,e.l):e}function Sd(t,e){return e||(e=B(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ri(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Ad(t,e,r){var n=B(2052);return n.write_shift(4,t),ri(e,n),ri(r,n),n.length>n.l?n.slice(0,n.l):n}function bd(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(j(t,615,Pt(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&j(t,44,vd(i,e[i]))}),j(t,616))}}function Od(t){var e=1;j(t,611,Pt(e)),j(t,43,xd({sz:12,color:{theme:1},name:"Calibri",family:2})),j(t,612)}function kd(t){var e=2;j(t,603,Pt(e)),j(t,45,Ha({patternType:"none"})),j(t,45,Ha({patternType:"gray125"})),j(t,604)}function Cd(t){var e=1;j(t,613,Pt(e)),j(t,46,Td()),j(t,614)}function Rd(t){var e=1;j(t,626,Pt(e)),j(t,47,_l({numFmtId:0},65535)),j(t,627)}function Id(t,e){j(t,617,Pt(e.length)),e.forEach(function(r){j(t,47,_l(r,0))}),j(t,618)}function Fd(t){var e=1;j(t,619,Pt(e)),j(t,48,Sd({xfId:0,name:"Normal"})),j(t,620)}function Pd(t){var e=0;j(t,505,Pt(e)),j(t,506)}function Nd(t){var e=0;j(t,508,Ad(e,"TableStyleMedium9","PivotStyleMedium4")),j(t,509)}function Dd(t,e){var r=lt();return j(r,278),bd(r,t.SSF),Od(r),kd(r),Cd(r),Rd(r),Id(r,e.cellXfs),Fd(r),Pd(r),Nd(r),j(r,279),r.end()}function wl(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Be];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ld(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:rt(t)}}function Bd(t){var e=B(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ve(t.name,e),e.slice(0,e.l)}function Md(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Ud(t){var e=B(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function $d(t,e){var r=B(8+2*e.length);return r.write_shift(4,t),Ve(e,r),r.slice(0,r.l)}function jd(t){return t.l+=4,t.read_shift(4)!=0}function Wd(t,e){var r=B(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Hd(){var t=lt();return j(t,332),j(t,334,Pt(1)),j(t,335,Bd({name:"XLDAPR",version:12e4,flags:3496657072})),j(t,336),j(t,339,$d(1,"XLDAPR")),j(t,52),j(t,35,Pt(514)),j(t,4096,Pt(0)),j(t,4097,Tt(1)),j(t,36),j(t,53),j(t,340),j(t,337,Wd(1)),j(t,51,Ud([[1,0]])),j(t,338),j(t,333),t.end()}function yl(){var t=[Be];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Vd(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=we(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Ur=1024;function El(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[J("xml",null,{"xmlns:v":gt.v,"xmlns:o":gt.o,"xmlns:x":gt.x,"xmlns:mv":gt.mv}).replace(/\/>/,">"),J("o:shapelayout",J("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),J("v:shapetype",[J("v:stroke",null,{joinstyle:"miter"}),J("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ur<t*1e3;)Ur+=1e3;return e.forEach(function(s){var a=He(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?J("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=J("v:fill",l,o),h={on:"t",obscured:"t"};++Ur,i=i.concat(["<v:shape"+yn({id:"_x0000_s"+Ur,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,J("v:shadow",null,h),J("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ye("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ye("x:AutoFill","False"),Ye("x:Row",String(a.r)),Ye("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Tl(t){var e=[Be,J("comments",null,{xmlns:Kr[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=_e(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(_e(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ye("t",_e(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ye("t",_e(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Gd(t,e,r){var n=[Be,J("ThreadedComments",null,{xmlns:We.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(J("threadedComment",Ye("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Kd(t){var e=[Be,J("personList",null,{xmlns:We.TCMNT,"xmlns:x":Kr[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(J("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function zd(t){var e={};e.iauthor=t.read_shift(4);var r=Tr(t);return e.rfx=r.s,e.ref=we(r.s),t.l+=16,e}function qd(t,e){return e==null&&(e=B(36)),e.write_shift(4,t[1].iauthor),qr(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Xd=rt;function Jd(t){return Ve(t.slice(0,54))}function Yd(t){var e=lt(),r=[];return j(e,628),j(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),j(e,632,Jd(i.a)))})}),j(e,631),j(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:He(n[0]),e:He(n[0])};j(e,635,qd([s,i])),i.t&&i.t.length>0&&j(e,637,Zu(i)),j(e,636),delete i.iauthor})}),j(e,634),j(e,629),e.end()}function Zd(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ee.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var Sl=["xlsb","xlsm","xlam","biff8","xla"],Qd=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+tt(h)+(l?"":"$")+Ze(c)}return function(i,s){return e=s,i.replace(t,r)}}(),As=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bs=function(){return function(e,r){return e.replace(As,function(n,i,s,a,o,l){var c=_s(a)-(s?0:r.c),h=xs(l)-(o?0:r.r),p=h==0?"":o?h+1:"["+h+"]",u=c==0?"":s?c+1:"["+c+"]";return i+"R"+p+"C"+u})}}();function e1(t,e){return t.replace(As,function(r,n,i,s,a,o){return n+(i=="$"?i+s:tt(_s(s)+e.c))+(a=="$"?a+o:Ze(xs(o)+e.r))})}function t1(t){return t.length!=1}function Ne(t){t.l+=1}function rr(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Al(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return bl(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=rr(t),o=rr(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function bl(t){var e=rr(t),r=rr(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function r1(t,e,r){if(r.biff<8)return bl(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=rr(t),a=rr(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Ol(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return n1(t);var n=t.read_shift(r&&r.biff==12?4:2),i=rr(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function n1(t){var e=rr(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function i1(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function s1(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return a1(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function a1(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function o1(t,e,r){var n=(t[t.l++]&96)>>5,i=Al(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function l1(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=Al(t,s,r);return[n,i,a]}function c1(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function h1(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function u1(t,e,r){var n=(t[t.l++]&96)>>5,i=r1(t,e-1,r);return[n,i]}function f1(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Va(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function d1(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function p1(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function g1(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function v1(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function m1(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function kl(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function x1(t){return t.read_shift(2),kl(t)}function _1(t){return t.read_shift(2),kl(t)}function w1(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Ol(t,0,r);return[n,i]}function y1(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=s1(t,0,r);return[n,i]}function E1(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Ol(t,0,r);return[n,i,s]}function T1(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Tp[i],Il[i],n]}function S1(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:A1(t);return[i,(s[0]===0?Il:Ep)[s[1]]]}function A1(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function b1(t,e,r){t.l+=r&&r.biff==2?3:4}function O1(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function k1(t){return t.l++,kn[t.read_shift(1)]}function C1(t){return t.l++,t.read_shift(2)}function R1(t){return t.l++,t.read_shift(1)!==0}function I1(t){return t.l++,Xr(t)}function F1(t,e,r){return t.l++,hl(t,e-1,r)}function P1(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ef(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=kn[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Xr(t);break;case 2:r[1]=bf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function N1(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Tr:Cf)(t));return i}function D1(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=P1(t,r.biff);return a}function L1(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function B1(t,e,r){if(r.biff==5)return M1(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function M1(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function U1(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function $1(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function j1(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function W1(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var H1=Bt,V1=Bt,G1=Bt;function Cn(t,e,r){return t.l+=2,[i1(t)]}function Os(t){return t.l+=6,[]}var K1=Cn,z1=Os,q1=Os,X1=Cn;function Cl(t){return t.l+=2,[ll(t),t.read_shift(2)&1]}var J1=Cn,Y1=Cl,Z1=Os,Q1=Cn,ep=Cn,tp=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function rp(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=tp[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function np(t){return t.l+=2,[t.read_shift(4)]}function ip(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function sp(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ap(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function op(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lp(t){return t.l+=4,[0,0]}var Ga={1:{n:"PtgExp",f:O1},2:{n:"PtgTbl",f:G1},3:{n:"PtgAdd",f:Ne},4:{n:"PtgSub",f:Ne},5:{n:"PtgMul",f:Ne},6:{n:"PtgDiv",f:Ne},7:{n:"PtgPower",f:Ne},8:{n:"PtgConcat",f:Ne},9:{n:"PtgLt",f:Ne},10:{n:"PtgLe",f:Ne},11:{n:"PtgEq",f:Ne},12:{n:"PtgGe",f:Ne},13:{n:"PtgGt",f:Ne},14:{n:"PtgNe",f:Ne},15:{n:"PtgIsect",f:Ne},16:{n:"PtgUnion",f:Ne},17:{n:"PtgRange",f:Ne},18:{n:"PtgUplus",f:Ne},19:{n:"PtgUminus",f:Ne},20:{n:"PtgPercent",f:Ne},21:{n:"PtgParen",f:Ne},22:{n:"PtgMissArg",f:Ne},23:{n:"PtgStr",f:F1},26:{n:"PtgSheet",f:ip},27:{n:"PtgEndSheet",f:sp},28:{n:"PtgErr",f:k1},29:{n:"PtgBool",f:R1},30:{n:"PtgInt",f:C1},31:{n:"PtgNum",f:I1},32:{n:"PtgArray",f:f1},33:{n:"PtgFunc",f:T1},34:{n:"PtgFuncVar",f:S1},35:{n:"PtgName",f:L1},36:{n:"PtgRef",f:w1},37:{n:"PtgArea",f:o1},38:{n:"PtgMemArea",f:U1},39:{n:"PtgMemErr",f:H1},40:{n:"PtgMemNoMem",f:V1},41:{n:"PtgMemFunc",f:$1},42:{n:"PtgRefErr",f:j1},43:{n:"PtgAreaErr",f:c1},44:{n:"PtgRefN",f:y1},45:{n:"PtgAreaN",f:u1},46:{n:"PtgMemAreaN",f:ap},47:{n:"PtgMemNoMemN",f:op},57:{n:"PtgNameX",f:B1},58:{n:"PtgRef3d",f:E1},59:{n:"PtgArea3d",f:l1},60:{n:"PtgRefErr3d",f:W1},61:{n:"PtgAreaErr3d",f:h1},255:{}},cp={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hp={1:{n:"PtgElfLel",f:Cl},2:{n:"PtgElfRw",f:Q1},3:{n:"PtgElfCol",f:K1},6:{n:"PtgElfRwV",f:ep},7:{n:"PtgElfColV",f:X1},10:{n:"PtgElfRadical",f:J1},11:{n:"PtgElfRadicalS",f:Z1},13:{n:"PtgElfColS",f:z1},15:{n:"PtgElfColSV",f:q1},16:{n:"PtgElfRadicalLel",f:Y1},25:{n:"PtgList",f:rp},29:{n:"PtgSxName",f:np},255:{}},up={0:{n:"PtgAttrNoop",f:lp},1:{n:"PtgAttrSemi",f:m1},2:{n:"PtgAttrIf",f:g1},4:{n:"PtgAttrChoose",f:d1},8:{n:"PtgAttrGoto",f:p1},16:{n:"PtgAttrSum",f:b1},32:{n:"PtgAttrBaxcel",f:Va},33:{n:"PtgAttrBaxcel",f:Va},64:{n:"PtgAttrSpace",f:x1},65:{n:"PtgAttrSpaceSemi",f:_1},128:{n:"PtgAttrIfError",f:v1},255:{}};function fp(t,e,r,n){if(n.biff<8)return Bt(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=D1(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=N1(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Bt(t,e)),s}function dp(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=Ga[s]||Ga[cp[s]],(s===24||s===25)&&(i=(s===24?hp:up)[t[t.l+1]]),!i||!i.f?Bt(t,e):a.push([i.n,i.f(t,e,r)]);return a}function pp(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var gp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vp(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Rl(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ka(t,e,r){var n=Rl(t,e,r);return n=="#REF"?n:vp(n,r)}function Gr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,p=0,u=0,f,v="";if(!t[0]||!t[0][0])return"";for(var d=-1,m="",S=0,A=t[0].length;S<A;++S){var T=t[0][S];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),d>=0){switch(t[0][d][1][0]){case 0:m=Ie(" ",t[0][d][1][1]);break;case 1:m=Ie("\r",t[0][d][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][d][1][0])}c=c+m,d=-1}o.push(c+gp[T[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=ln(T[1][1],a,i),o.push(cn(h,s));break;case"PtgRefN":h=r?ln(T[1][1],r,i):T[1][1],o.push(cn(h,s));break;case"PtgRef3d":p=T[1][1],h=ln(T[1][2],a,i),v=Ka(n,p,i),o.push(v+"!"+cn(h,s));break;case"PtgFunc":case"PtgFuncVar":var R=T[1][0],H=T[1][1];R||(R=0),R&=127;var K=R==0?[]:o.slice(-R);o.length-=R,H==="User"&&(H=K.shift()),o.push(H+"("+K.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":f=Ra(T[1][1],r?{s:r}:a,i),o.push(Bi(f,i));break;case"PtgArea":f=Ra(T[1][1],a,i),o.push(Bi(f,i));break;case"PtgArea3d":p=T[1][1],f=T[1][2],v=Ka(n,p,i),o.push(v+"!"+Bi(f,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=T[1][2];var k=(n.names||[])[u-1]||(n[0]||[])[u],U=k?k.Name:"SH33TJSNAME"+String(u);U&&U.slice(0,6)=="_xlfn."&&!i.xlfn&&(U=U.slice(6)),o.push(U);break;case"PtgNameX":var P=T[1][1];u=T[1][2];var V;if(i.biff<=5)P<0&&(P=-P),n[P]&&(V=n[P][u]);else{var G="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][u]&&n[P][u].itab>0&&(G=n.SheetNames[n[P][u].itab-1]+"!"):G=n.SheetNames[u-1]+"!"),n[P]&&n[P][u])G+=n[P][u].Name;else if(n[0]&&n[0][u])G+=n[0][u].Name;else{var q=(Rl(n,P,i)||"").split(";;");q[u-1]?G=q[u-1]:G+="SH33TJSERRX"}o.push(G);break}V||(V={Name:"SH33TJSERRY"}),o.push(V.Name);break;case"PtgParen":var te="(",ye=")";if(d>=0){switch(m="",t[0][d][1][0]){case 2:te=Ie(" ",t[0][d][1][1])+te;break;case 3:te=Ie("\r",t[0][d][1][1])+te;break;case 4:ye=Ie(" ",t[0][d][1][1])+ye;break;case 5:ye=Ie("\r",t[0][d][1][1])+ye;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][d][1][0])}d=-1}o.push(te+o.pop()+ye);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[we(h)]){var Ge=n.sharedf[we(h)];o.push(Gr(Ge,a,ue,n,i))}else{var Pe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(Gr(c[1],a,ue,n,i)),Pe=!0;break}Pe||o.push(T[1])}break;case"PtgArray":o.push("{"+pp(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":d=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var At=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&d>=0&&At.indexOf(t[0][S][0])==-1){T=t[0][d];var $e=!0;switch(T[1][0]){case 4:$e=!1;case 0:m=Ie(" ",T[1][1]);break;case 5:$e=!1;case 1:m=Ie("\r",T[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push(($e?m:"")+o.pop()+($e?"":m)),d=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function mp(t){if(t==null){var e=B(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return mr(t);return mr(0)}function xp(t,e,r,n,i){var s=xr(e,r,i),a=mp(t.v),o=B(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=B(t.bf.length),h=0;h<t.bf.length;++h)c[h]=t.bf[h];var p=Je([s,a,o,c]);return p}function xi(t,e,r){var n=t.read_shift(4),i=dp(t,n,r),s=t.read_shift(4),a=s>0?fp(t,s,i,r):null;return[i,a]}var _p=xi,_i=xi,wp=xi,yp=xi,Ep={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Il={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Tp={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sp(t){var e="of:="+t.replace(As,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ap(t){return t.replace(/\./,"!")}var hn=typeof Map<"u";function ks(t,e,r){var n=0,i=t.length;if(r){if(hn?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=hn?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(hn?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function wi(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Vt=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=ai(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=is(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Fl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ir(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Oo(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function bp(t,e,r){if(t&&t["!ref"]){var n=Ae(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Op(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Le(t[r])+'"/>';return e+"</mergeCells>"}function kp(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=wn(_e(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+J("outlinePr",null,c)}!s&&!o||(i[i.length]=J("sheetPr",o,a))}var Cp=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rp=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ip(t){var e={sheet:1};return Cp.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Rp.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=gl(t.password).toString(16).toUpperCase()),J("sheetProtection",null,e)}function Fp(t){return Fl(t),J("pageMargins",null,t)}function Pp(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=J("col",null,wi(i,n)));return r[r.length]="</cols>",r.join("")}function Np(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Le(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=_t(i);a.s.r==a.e.r&&(a.e.r=_t(e["!ref"]).e.r,i=Le(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),J("autoFilter",null,{ref:i})}function Dp(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),J("sheetViews",J("sheetView",null,i),{})}function Lp(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=kn[t.v];break;case"d":n&&n.cellDates?i=at(t.v,-1).toISOString():(t=ht(t),t.t="n",i=""+(t.v=ct(at(t.v)))),typeof t.z>"u"&&(t.z=Fe[14]);break;default:i=t.v;break}var o=Ye("v",_e(i)),l={r:e},c=ir(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ye("v",""+ks(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=J("f",_e(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),J("c",o,l)}function Bp(t,e,r,n){var i=[],s=[],a=Ae(t["!ref"]),o="",l,c="",h=[],p=0,u=0,f=t["!rows"],v=Array.isArray(t),d={r:c},m,S=-1;for(u=a.s.c;u<=a.e.c;++u)h[u]=tt(u);for(p=a.s.r;p<=a.e.r;++p){for(s=[],c=Ze(p),u=a.s.c;u<=a.e.c;++u){l=h[u]+c;var A=v?(t[p]||[])[u]:t[l];A!==void 0&&(o=Lp(A,l,t,e))!=null&&s.push(o)}(s.length>0||f&&f[p])&&(d={r:c},f&&f[p]&&(m=f[p],m.hidden&&(d.hidden=1),S=-1,m.hpx?S=oi(m.hpx):m.hpt&&(S=m.hpt),S>-1&&(d.ht=S,d.customHeight=1),m.level&&(d.outlineLevel=m.level)),i[i.length]=J("row",s.join(""),d))}if(f)for(;p<f.length;++p)f&&f[p]&&(d={r:p+1},m=f[p],m.hidden&&(d.hidden=1),S=-1,m.hpx?S=oi(m.hpx):m.hpt&&(S=m.hpt),S>-1&&(d.ht=S,d.customHeight=1),m.level&&(d.outlineLevel=m.level),i[i.length]=J("row","",d));return i.join("")}function Pl(t,e,r,n){var i=[Be,J("worksheet",null,{xmlns:Kr[0],"xmlns:r":We.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=Ae(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=Le(h)}n||(n={}),l["!comments"]=[];var p=[];kp(l,r,t,e,i),i[i.length]=J("dimension",null,{ref:c}),i[i.length]=Dp(l,e,t,r),e.sheetFormat&&(i[i.length]=J("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Pp(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Bp(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=Ip(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Np(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Op(l["!merges"]));var u=-1,f,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(d){d[1].Target&&(f={ref:d[0]},d[1].Target.charAt(0)!="#"&&(v=xe(n,-1,_e(d[1].Target).replace(/#.*$/,""),pe.HLINK),f["r:id"]="rId"+v),(u=d[1].Target.indexOf("#"))>-1&&(f.location=_e(d[1].Target.slice(u+1))),d[1].Tooltip&&(f.tooltip=_e(d[1].Tooltip)),i[i.length]=J("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Fp(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ye("ignoredErrors",J("ignoredError",null,{numberStoredAsText:1,sqref:c}))),p.length>0&&(v=xe(n,-1,"../drawings/drawing"+(t+1)+".xml",pe.DRAW),i[i.length]=J("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=p),l["!comments"].length>0&&(v=xe(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",pe.VML),i[i.length]=J("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Mp(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Up(t,e,r){var n=B(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=oi(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var p=-1,u=-1,f=h<<10;f<h+1<<10;++f){c.c=f;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[we(c)];v&&(p<0&&(p=f),u=f)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,u))}var d=n.l;return n.l=l,n.write_shift(4,o),n.l=d,n.length>n.l?n.slice(0,n.l):n}function $p(t,e,r,n){var i=Up(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&j(t,0,i)}var jp=Tr,Wp=qr;function Hp(){}function Vp(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Qu(t),r}function Gp(t,e,r){r==null&&(r=B(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return ni({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qo(t,r),r.slice(0,r.l)}function Kp(t){var e=St(t);return[e]}function zp(t,e,r){return r==null&&(r=B(8)),wr(e,r)}function qp(t){var e=yr(t);return[e]}function Xp(t,e,r){return r==null&&(r=B(4)),Er(e,r)}function Jp(t){var e=St(t),r=t.read_shift(1);return[e,r,"b"]}function Yp(t,e,r){return r==null&&(r=B(9)),wr(e,r),r.write_shift(1,t.v?1:0),r}function Zp(t){var e=yr(t),r=t.read_shift(1);return[e,r,"b"]}function Qp(t,e,r){return r==null&&(r=B(5)),Er(e,r),r.write_shift(1,t.v?1:0),r}function eg(t){var e=St(t),r=t.read_shift(1);return[e,r,"e"]}function tg(t,e,r){return r==null&&(r=B(9)),wr(e,r),r.write_shift(1,t.v),r}function rg(t){var e=yr(t),r=t.read_shift(1);return[e,r,"e"]}function ng(t,e,r){return r==null&&(r=B(8)),Er(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ig(t){var e=St(t),r=t.read_shift(4);return[e,r,"s"]}function sg(t,e,r){return r==null&&(r=B(12)),wr(e,r),r.write_shift(4,e.v),r}function ag(t){var e=yr(t),r=t.read_shift(4);return[e,r,"s"]}function og(t,e,r){return r==null&&(r=B(8)),Er(e,r),r.write_shift(4,e.v),r}function lg(t){var e=St(t),r=Xr(t);return[e,r,"n"]}function cg(t,e,r){return r==null&&(r=B(16)),wr(e,r),mr(t.v,r),r}function hg(t){var e=yr(t),r=Xr(t);return[e,r,"n"]}function ug(t,e,r){return r==null&&(r=B(12)),Er(e,r),mr(t.v,r),r}function fg(t){var e=St(t),r=Xo(t);return[e,r,"n"]}function dg(t,e,r){return r==null&&(r=B(12)),wr(e,r),Jo(t.v,r),r}function pg(t){var e=yr(t),r=Xo(t);return[e,r,"n"]}function gg(t,e,r){return r==null&&(r=B(8)),Er(e,r),Jo(t.v,r),r}function vg(t){var e=St(t),r=ws(t);return[e,r,"is"]}function mg(t){var e=St(t),r=rt(t);return[e,r,"str"]}function xg(t,e,r){return r==null&&(r=B(12+4*t.v.length)),wr(e,r),Ve(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _g(t){var e=yr(t),r=rt(t);return[e,r,"str"]}function wg(t,e,r){return r==null&&(r=B(8+4*t.v.length)),Er(e,r),Ve(t.v,r),r.length>r.l?r.slice(0,r.l):r}function yg(t,e,r){var n=t.l+e,i=St(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=_i(t,n-t.l,r);a[3]=Gr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Eg(t,e,r){var n=t.l+e,i=St(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=_i(t,n-t.l,r);a[3]=Gr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Tg(t,e,r){var n=t.l+e,i=St(t);i.r=r["!row"];var s=Xr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=_i(t,n-t.l,r);a[3]=Gr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Sg(t,e,r){var n=t.l+e,i=St(t);i.r=r["!row"];var s=rt(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=_i(t,n-t.l,r);a[3]=Gr(o,null,i,r.supbooks,r)}else t.l=n;return a}var Ag=Tr,bg=qr;function Og(t,e){return e==null&&(e=B(4)),e.write_shift(4,t),e}function kg(t,e){var r=t.l+e,n=Tr(t),i=ys(t),s=rt(t),a=rt(t),o=rt(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Cg(t,e){var r=B(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));qr({s:He(t[0]),e:He(t[0])},r),Es("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Ve(i||"",r),Ve(t[1].Tooltip||"",r),Ve("",r),r.slice(0,r.l)}function Rg(){}function Ig(t,e,r){var n=t.l+e,i=Yo(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=_p(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Fg(t,e,r){var n=t.l+e,i=Tr(t),s=[i];if(r.cellFormula){var a=yp(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function Pg(t,e,r){r==null&&(r=B(18));var n=wi(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var Nl=["left","right","top","bottom","header","footer"];function Ng(t){var e={};return Nl.forEach(function(r){e[r]=Xr(t)}),e}function Dg(t,e){return e==null&&(e=B(6*8)),Fl(t),Nl.forEach(function(r){mr(t[r],e)}),e}function Lg(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Bg(t,e,r){r==null&&(r=B(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Mg(t){var e=B(24);return e.write_shift(4,4),e.write_shift(4,1),qr(t,e),e}function Ug(t,e){return e==null&&(e=B(16*4+2)),e.write_shift(2,t.password?gl(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function $g(){}function jg(){}function Wg(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=ht(e),e.z=e.z||Fe[14],e.v=ct(at(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=ir(i.cellXfs,e,i),e.l&&s["!links"].push([we(l),e.l]),e.c&&s["!comments"].push([we(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ks(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?j(t,18,og(e,l)):j(t,7,sg(e,l))):(l.t="str",a?j(t,17,wg(e,l)):j(t,6,xg(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?j(t,13,gg(e,l)):j(t,2,dg(e,l)):a?j(t,16,ug(e,l)):j(t,5,cg(e,l)),!0;case"b":return l.t="b",a?j(t,15,Qp(e,l)):j(t,4,Yp(e,l)),!0;case"e":return l.t="e",a?j(t,14,ng(e,l)):j(t,3,tg(e,l)),!0}return a?j(t,12,Xp(e,l)):j(t,1,zp(e,l)),!0}function Hg(t,e,r,n){var i=Ae(e["!ref"]||"A1"),s,a="",o=[];j(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Ze(h),$p(t,e,i,h);var p=!1;if(h<=i.e.r)for(var u=i.s.c;u<=i.e.c;++u){h===i.s.r&&(o[u]=tt(u)),s=o[u]+a;var f=l?(e[h]||[])[u]:e[s];if(!f){p=!1;continue}p=Wg(t,f,h,u,n,e,p)}}j(t,146)}function Vg(t,e){!e||!e["!merges"]||(j(t,177,Og(e["!merges"].length)),e["!merges"].forEach(function(r){j(t,176,bg(r))}),j(t,178))}function Gg(t,e){!e||!e["!cols"]||(j(t,390),e["!cols"].forEach(function(r,n){r&&j(t,60,Pg(n,r))}),j(t,391))}function Kg(t,e){!e||!e["!ref"]||(j(t,648),j(t,649,Mg(Ae(e["!ref"]))),j(t,650))}function zg(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=xe(r,-1,n[1].Target.replace(/#.*$/,""),pe.HLINK);j(t,494,Cg(n,i))}}),delete e["!links"]}function qg(t,e,r,n){if(e["!comments"].length>0){var i=xe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",pe.VML);j(t,551,Es("rId"+i)),e["!legacy"]=i}}function Xg(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Le(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=_t(s);o.s.r==o.e.r&&(o.e.r=_t(e["!ref"]).e.r,s=Le(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),j(t,161,qr(Ae(s))),j(t,162)}}function Jg(t,e,r){j(t,133),j(t,137,Bg(e,r)),j(t,138),j(t,134)}function Yg(t,e){e["!protect"]&&j(t,535,Ug(e["!protect"]))}function Zg(t,e,r,n){var i=lt(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Ae(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],j(i,129),(r.vbaraw||a["!outline"])&&j(i,147,Gp(o,a["!outline"])),j(i,148,Wp(l)),Jg(i,a,r.Workbook),Gg(i,a),Hg(i,a,t,e),Yg(i,a),Xg(i,a,r,t),Vg(i,a),zg(i,a,n),a["!margins"]&&j(i,476,Dg(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Kg(i,a),qg(i,a,t,n),j(i,130),i.end()}function Qg(t,e){t.l+=10;var r=rt(t);return{name:r}}var ev=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function tv(t){return!t.Workbook||!t.Workbook.WBProps?"false":Iu(t.Workbook.WBProps.date1904)?"true":"false"}var rv="][*?/\\".split("");function Dl(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return rv.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function nv(t,e,r){t.forEach(function(n,i){Dl(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function iv(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];nv(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)bp(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function Ll(t){var e=[Be];e[e.length]=J("workbook",null,{xmlns:Kr[0],"xmlns:r":We.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ev.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=J("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:_e(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=J("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=J("definedName",_e(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function sv(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ns(t),r.name=rt(t),r}function av(t,e){return e||(e=B(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Es(t.strRelID,e),Ve(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function ov(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?rt(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function lv(t,e){e||(e=B(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),qo(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function cv(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=ef(t),a=wp(t,0,r),o=ys(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function hv(t,e){j(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};j(t,156,av(i))}j(t,144)}function uv(t,e){e||(e=B(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ve("SheetJS",e),Ve(Xn.version,e),Ve(Xn.version,e),Ve("7262",e),e.length>e.l?e.slice(0,e.l):e}function fv(t,e){e||(e=B(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function dv(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(j(t,135),j(t,158,fv(i)),j(t,136))}}function pv(t,e){var r=lt();return j(r,131),j(r,128,uv()),j(r,153,lv(t.Workbook&&t.Workbook.WBProps||null)),dv(r,t),hv(r,t),j(r,132),r.end()}function gv(t,e,r){return(e.slice(-4)===".bin"?pv:Ll)(t)}function vv(t,e,r,n,i){return(e.slice(-4)===".bin"?Zg:Pl)(t,r,n,i)}function mv(t,e,r){return(e.slice(-4)===".bin"?Dd:xl)(t,r)}function xv(t,e,r){return(e.slice(-4)===".bin"?ld:pl)(t,r)}function _v(t,e,r){return(e.slice(-4)===".bin"?Yd:Tl)(t)}function wv(t){return(t.slice(-4)===".bin"?Hd:yl)()}function yv(t,e){var r=[];return t.Props&&r.push(mf(t.Props,e)),t.Custprops&&r.push(xf(t.Props,t.Custprops)),r.join("")}function Ev(){return""}function Tv(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(J("NumberFormat",null,{"ss:Format":_e(Fe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(J("Style",s.join(""),a))}),J("Styles",r.join(""))}function Bl(t){return J("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+bs(t.Ref,{r:0,c:0})})}function Sv(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Bl(i)))}return J("Names",r.join(""))}function Av(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Bl(o)))}return s.join("")}function bv(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(J("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(J("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(J("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(J("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Ye("ProtectContents","True")),t["!protect"].objects&&i.push(Ye("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Ye("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Ye("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Ye("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":J("WorksheetOptions",i.join(""),{xmlns:gt.x})}function Ov(t){return t.map(function(e){var r=Ru(e.t||""),n=J("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return J("Comment",n,{"ss:Author":e.a})}).join("")}function kv(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+_e(bs(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=He(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=_e(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=_e(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var p="",u="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",u=String(t.v);break;case"b":p="Boolean",u=t.v?"1":"0";break;case"e":p="Error",u=kn[t.v];break;case"d":p="DateTime",u=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Fe[14]);break;case"s":p="String",u=Cu(t.v||"");break}var f=ir(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var v=t.v!=null?u:"",d=t.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(t.c||[]).length>0&&(d+=Ov(t.c)),J("Cell",d,o)}function Cv(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=ml(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Rv(t,e,r,n){if(!t["!ref"])return"";var i=Ae(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(m,S){Ss(m);var A=!!m.width,T=wi(S,m),R={"ss:Index":S+1};A&&(R["ss:Width"]=si(T.width)),m.hidden&&(R["ss:Hidden"]="1"),o.push(J("Column",null,R))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var h=[Cv(c,(t["!rows"]||[])[c])],p=i.s.c;p<=i.e.c;++p){var u=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>c)&&!(s[a].e.c<p)&&!(s[a].e.r<c)){(s[a].s.c!=p||s[a].s.r!=c)&&(u=!0);break}if(!u){var f={r:c,c:p},v=we(f),d=l?(t[c]||[])[p]:t[v];h.push(kv(d,v,t,e,r,n,f))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Iv(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?Av(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?Rv(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(bv(s,e,t,r)),n.join("")}function Fv(t,e){e||(e={}),t.SSF||(t.SSF=ht(Fe)),t.SSF&&(gi(),pi(t.SSF),e.revssf=vi(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ir(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(yv(t,e)),r.push(Ev()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(J("Worksheet",Iv(n,e,t),{"ss:Name":_e(t.SheetNames[n])}));return r[2]=Tv(t,e),r[3]=Sv(t),Be+J("Workbook",r.join(""),{xmlns:gt.ss,"xmlns:o":gt.o,"xmlns:x":gt.x,"xmlns:ss":gt.ss,"xmlns:dt":gt.dt,"xmlns:html":gt.html})}var $i={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Pv(t,e){var r=[],n=[],i=[],s=0,a,o=_a(Fa,"n"),l=_a(Pa,"n");if(t.Props)for(a=Qe(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Qe(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)ol.indexOf(i[s][0])>-1||il.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ee.utils.cfb_add(e,"/SummaryInformation",Ma(n,$i.SI,l,Pa)),(r.length||c.length)&&Ee.utils.cfb_add(e,"/DocumentSummaryInformation",Ma(r,$i.DSI,o,Fa,c.length?c:null,$i.UDI))}function Nv(t,e){var r=e||{},n=Ee.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ee.utils.cfb_add(n,i,Ml(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Pv(t,n),r.biff==8&&t.vbaraw&&Zd(n,Ee.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Dv={0:{f:Mp},1:{f:Kp},2:{f:fg},3:{f:eg},4:{f:Jp},5:{f:lg},6:{f:mg},7:{f:ig},8:{f:Sg},9:{f:Tg},10:{f:yg},11:{f:Eg},12:{f:qp},13:{f:pg},14:{f:rg},15:{f:Zp},16:{f:hg},17:{f:_g},18:{f:ag},19:{f:ws},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:cv},40:{},42:{},43:{f:md},44:{f:gd},45:{f:wd},46:{f:Ed},47:{f:yd},48:{},49:{f:zu},50:{},51:{f:Md},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Xf},62:{f:vg},63:{f:Vd},64:{f:$g},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Lg},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Vp},148:{f:jp,p:16},151:{f:Rg},152:{},153:{f:ov},154:{},155:{},156:{f:sv},157:{},158:{},159:{T:1,f:sd},160:{T:-1},161:{T:1,f:Tr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ag},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ld},336:{T:-1},337:{f:jd,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ns},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Hf},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ig},427:{f:Fg},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ng},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Hp},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kg},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ns},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xd},633:{T:1},634:{T:-1},635:{T:1,f:zd},636:{T:-1},637:{f:Yu},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Qg},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jg},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Y(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&ms(r)&&t.push(r)}}function Lv(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Y(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,s),h.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(h=t.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Rn(t,e,r){return t||(t=B(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Bv(t,e,r,n){var i=B(9);return Rn(i,t,e),cl(r,n||"b",i),i}function Mv(t,e,r){var n=B(8+2*r.length);return Rn(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Uv(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?ct(at(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Y(t,2,Qf(r,n,i)):Y(t,3,Zf(r,n,i));return;case"b":case"e":Y(t,5,Bv(r,n,e.v,e.t));return;case"s":case"str":Y(t,4,Mv(r,n,(e.v||"").slice(0,255)));return}Y(t,1,Rn(null,r,n))}function $v(t,e,r,n){var i=Array.isArray(e),s=Ae(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Le(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ze(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=tt(h)),a=l[h]+o;var p=i?(e[c]||[])[h]:e[a];p&&Uv(t,p,c,h)}}}function jv(t,e){for(var r=e||{},n=lt(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Y(n,r.biff==4?1033:r.biff==3?521:9,Ts(t,16,r)),$v(n,t.Sheets[t.SheetNames[i]],i,r),Y(n,10),n.end()}function Wv(t,e,r){Y(t,49,Df({sz:12,name:"Arial"},r))}function Hv(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Y(t,1054,Mf(i,e[i],r))})}function Vv(t,e){var r=B(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Y(t,2151,r),r=B(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),fl(Ae(e["!ref"]||"A1"),r),r.write_shift(4,4),Y(t,2152,r)}function Gv(t,e){for(var r=0;r<16;++r)Y(t,224,$a({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Y(t,224,$a(n,0,e))})}function Kv(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Y(t,440,Kf(n)),n[1].Tooltip&&Y(t,2048,zf(n))}delete e["!links"]}function zv(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Y(t,125,Jf(wi(i,n),i))})}}function qv(t,e,r,n,i){var s=16+ir(i.cellXfs,e,i);if(e.v==null&&!e.bf){Y(t,513,xr(r,n,s));return}if(e.bf)Y(t,6,xp(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?ct(at(e.v)):e.v;Y(t,515,Wf(r,n,a,s));break;case"b":case"e":Y(t,517,jf(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ks(i.Strings,e.v,i.revStrings);Y(t,253,Lf(r,n,o,s))}else Y(t,516,Bf(r,n,(e.v||"").slice(0,255),s,i));break;default:Y(t,513,xr(r,n,s))}}function Xv(t,e,r){var n=lt(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,h,p="",u=[],f=Ae(s["!ref"]||"A1"),v=c?65536:16384;if(f.e.c>255||f.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,v-1)}Y(n,2057,Ts(r,16,e)),Y(n,13,Tt(1)),Y(n,12,Tt(100)),Y(n,15,st(!0)),Y(n,17,st(!1)),Y(n,16,mr(.001)),Y(n,95,st(!0)),Y(n,42,st(!1)),Y(n,43,st(!1)),Y(n,130,Tt(1)),Y(n,128,$f()),Y(n,131,st(!1)),Y(n,132,st(!1)),c&&zv(n,s["!cols"]),Y(n,512,Uf(f,e)),c&&(s["!links"]=[]);for(var d=f.s.r;d<=f.e.r;++d){p=Ze(d);for(var m=f.s.c;m<=f.e.c;++m){d===f.s.r&&(u[m]=tt(m)),h=u[m]+p;var S=l?(s[d]||[])[m]:s[h];S&&(qv(n,S,d,m,e),c&&S.l&&s["!links"].push([h,S.l]))}}var A=o.CodeName||o.name||i;return c&&Y(n,574,Nf((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Y(n,229,Gf(s["!merges"])),c&&Kv(n,s),Y(n,442,ul(A)),c&&Vv(n,s),Y(n,10),n.end()}function Jv(t,e,r){var n=lt(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Y(n,2057,Ts(t,5,r)),r.bookType=="xla"&&Y(n,135),Y(n,225,o?Tt(1200):null),Y(n,193,yf(2)),l&&Y(n,191),l&&Y(n,192),Y(n,226),Y(n,92,Rf("SheetJS",r)),Y(n,66,Tt(o?1200:1252)),o&&Y(n,353,Tt(0)),o&&Y(n,448),Y(n,317,Yf(t.SheetNames.length)),o&&t.vbaraw&&Y(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Y(n,442,ul(c))}Y(n,156,Tt(17)),Y(n,25,st(!1)),Y(n,18,st(!1)),Y(n,19,Tt(0)),o&&Y(n,431,st(!1)),o&&Y(n,444,Tt(0)),Y(n,61,Pf()),Y(n,64,st(!1)),Y(n,141,Tt(0)),Y(n,34,st(tv(t)=="true")),Y(n,14,st(!0)),o&&Y(n,439,st(!1)),Y(n,218,Tt(0)),Wv(n,t,r),Hv(n,t.SSF,r),Gv(n,r),o&&Y(n,352,st(!1));var h=n.end(),p=lt();o&&Y(p,140,qf()),o&&r.Strings&&Lv(p,252,Ff(r.Strings)),Y(p,10);var u=p.end(),f=lt(),v=0,d=0;for(d=0;d<t.SheetNames.length;++d)v+=(o?12:11)+(o?2:1)*t.SheetNames[d].length;var m=h.length+v+u.length;for(d=0;d<t.SheetNames.length;++d){var S=s[d]||{};Y(f,133,If({pos:m,hs:S.Hidden||0,dt:0,name:t.SheetNames[d]},r)),m+=e[d].length}var A=f.end();if(v!=A.length)throw new Error("BS8 "+v+" != "+A.length);var T=[];return h.length&&T.push(h),A.length&&T.push(A),u.length&&T.push(u),Je(T)}function Yv(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ht(Fe)),t&&t.SSF&&(gi(),pi(t.SSF),r.revssf=vi(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Cs(r),r.cellXfs=[],ir(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Xv(i,r,t);return n.unshift(Jv(t,n,r)),Je(n)}function Ml(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=_t(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Yv(t,e);case 4:case 3:case 2:return jv(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Zv(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=we({r,c:a}),p=n.dense?(t[r]||[])[a]:t[h],u=p&&p.v!=null&&(p.h||ku(p.w||(Kt(p),p.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?u='<span contenteditable="true">'+u+"</span>":p&&(f["data-t"]=p&&p.t||"z",p.v!=null&&(f["data-v"]=p.v),p.z!=null&&(f["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+p.l.Target+'">'+u+"</a>")),f.id=(n.id||"sjs")+"-"+h,s.push(J("td",u,f))}}var v="<tr>";return v+s.join("")+"</tr>"}var Qv='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',em="</body></html>";function tm(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ul(t,e){var r=e||{},n=r.header!=null?r.header:Qv,i=r.footer!=null?r.footer:em,s=[n],a=_t(t["!ref"]);r.dense=Array.isArray(t),s.push(tm(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Zv(t,a,o,r));return s.push("</table>"+i),s.join("")}function $l(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?He(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=_t(t["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var p=[],u=0,f=t["!rows"]||(t["!rows"]=[]),v=0,d=0,m=0,S=0,A=0,T=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&d<l;++v){var R=o[v];if(za(R)){if(n.display)continue;f[d]={hidden:!0}}var H=R.children;for(m=S=0;m<H.length;++m){var K=H[m];if(!(n.display&&za(K))){var k=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):Fu(K.innerHTML),U=K.getAttribute("data-z")||K.getAttribute("z");for(u=0;u<p.length;++u){var P=p[u];P.s.c==S+s&&P.s.r<d+i&&d+i<=P.e.r&&(S=P.e.c+1-s,u=-1)}T=+K.getAttribute("colspan")||1,((A=+K.getAttribute("rowspan")||1)>1||T>1)&&p.push({s:{r:d+i,c:S+s},e:{r:d+i+(A||1)-1,c:S+s+(T||1)-1}});var V={t:"s",v:k},G=K.getAttribute("data-t")||K.getAttribute("t")||"";k!=null&&(k.length==0?V.t=G||"z":n.raw||k.trim().length==0||G=="s"||(k==="TRUE"?V={t:"b",v:!0}:k==="FALSE"?V={t:"b",v:!1}:isNaN(Ht(k))?isNaN(_n(k).getDate())||(V={t:"d",v:at(k)},n.cellDates||(V={t:"n",v:ct(V.v)}),V.z=n.dateNF||Fe[14]):V={t:"n",v:Ht(k)})),V.z===void 0&&U!=null&&(V.z=U);var q="",te=K.getElementsByTagName("A");if(te&&te.length)for(var ye=0;ye<te.length&&!(te[ye].hasAttribute("href")&&(q=te[ye].getAttribute("href"),q.charAt(0)!="#"));++ye);q&&q.charAt(0)!="#"&&(V.l={Target:q}),n.dense?(t[d+i]||(t[d+i]=[]),t[d+i][S+s]=V):t[we({c:S+s,r:d+i})]=V,c.e.c<S+s&&(c.e.c=S+s),S+=T}}++d}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),c.e.r=Math.max(c.e.r,d-1+i),t["!ref"]=Le(c),d>=l&&(t["!fullref"]=Le((c.e.r=o.length-v+d-1+i,c))),t}function jl(t,e){var r=e||{},n=r.dense?[]:{};return $l(n,t,e)}function rm(t,e){return _r(jl(t,e),e)}function za(t){var e="",r=nm(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function nm(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var im=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+yn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Be+e}}(),qa=function(){var t=function(s){return _e(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+_e(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,p=_t(s["!ref"]||"A1"),u=s["!merges"]||[],f=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=p.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var d="",m=s["!rows"]||[];for(c=0;c<p.s.r;++c)d=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+d+`></table:table-row>
`);for(;c<=p.e.r;++c){for(d=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+d+`>
`),h=0;h<p.s.c;++h)l.push(e);for(;h<=p.e.c;++h){var S=!1,A={},T="";for(f=0;f!=u.length;++f)if(!(u[f].s.c>h)&&!(u[f].s.r>c)&&!(u[f].e.c<h)&&!(u[f].e.r<c)){(u[f].s.c!=h||u[f].s.r!=c)&&(S=!0),A["table:number-columns-spanned"]=u[f].e.c-u[f].s.c+1,A["table:number-rows-spanned"]=u[f].e.r-u[f].s.r+1;break}if(S){l.push(r);continue}var R=we({r:c,c:h}),H=v?(s[c]||[])[h]:s[R];if(H&&H.f&&(A["table:formula"]=_e(Sp(H.f)),H.F&&H.F.slice(0,R.length)==R)){var K=_t(H.F);A["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,A["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!H){l.push(e);continue}switch(H.t){case"b":T=H.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=H.v?"true":"false";break;case"n":T=H.w||String(H.v||0),A["office:value-type"]="float",A["office:value"]=H.v||0;break;case"s":case"str":T=H.v==null?"":H.v,A["office:value-type"]="string";break;case"d":T=H.w||at(H.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=at(H.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var k=t(T);if(H.l&&H.l.Target){var U=H.l.Target;U=U.charAt(0)=="#"?"#"+Ap(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),k=J("text:a",k,{"xlink:href":U.replace(/&/g,"&amp;")})}l.push("          "+J("table:table-cell",J("text:p",k,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var p=c["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ss(p),p.ods=o;var u=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var p=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Be],c=yn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=yn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(rl().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Wl(t,e){if(e.bookType=="fods")return qa(t,e);var r=ds(),n="",i=[],s=[];return n="mimetype",fe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",fe(r,n,qa(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",fe(r,n,im(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",fe(r,n,Be+rl()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",fe(r,n,vf(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",fe(r,n,pf(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function li(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function sm(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):It(wn(t))}function am(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function nr(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function om(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function En(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function me(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Vr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ue(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=En(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=En(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function qe(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(me(n*8+i.type)),i.type==2&&e.push(me(i.data.length)),e.push(i.data))})}),nr(e)}function bt(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=En(t,n),s=Ue(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Vr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Ue(o.data),c=Vr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Vr(s[3][0].data)>>>0>0),r.push(a)}return r}function Fr(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:me(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:me(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:me(a.data.length)}],n[2].push({data:qe(a.meta),type:2})});var s=qe(n);e.push(me(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),nr(e)}function lm(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=En(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[nr(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=nr(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ot(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(lm(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return nr(e)}function Pr(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=me(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return nr(e)}function ji(t,e){var r=new Uint8Array(32),n=li(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,om(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Wi(t,e){var r=new Uint8Array(32),n=li(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xt(t){var e=Ue(t);return En(e[1][0].data)}function cm(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Vr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=li(t[7][0].data),h=0,p=[],u=li(t[4][0].data),f=0,v=[],d=0;d<e.length;++d){if(e[d]==null){c.setUint16(d*2,65535,!0),u.setUint16(d*2,65535);continue}c.setUint16(d*2,h,!0),u.setUint16(d*2,f,!0);var m,S;switch(typeof e[d]){case"string":m=ji({t:"s",v:e[d]},r),S=Wi({t:"s",v:e[d]},r);break;case"number":m=ji({t:"n",v:e[d]},r),S=Wi({t:"n",v:e[d]},r);break;case"boolean":m=ji({t:"b",v:e[d]},r),S=Wi({t:"b",v:e[d]},r);break;default:throw new Error("Unsupported value "+e[d])}p.push(m),h+=m.length,v.push(S),f+=S.length,++l}for(t[2][0].data=me(l);d<t[7][0].data.length/2;++d)c.setUint16(d*2,65535,!0),u.setUint16(d*2,65535,!0);return t[6][0].data=nr(p),t[3][0].data=nr(v),l}function hm(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=_t(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Le(n)));var s=ci(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(C){typeof C=="string"&&a.push(C)})});var o={},l=[],c=Ee.read(e.numbers,{type:"base64"});c.FileIndex.map(function(L,C){return[L,c.FullPaths[C]]}).forEach(function(L){var C=L[0],O=L[1];if(C.type==2&&C.name.match(/\.iwa/)){var W=C.content,se=Ot(W),oe=bt(se);oe.forEach(function(ie){l.push(ie.id),o[ie.id]={deps:[],location:O,type:Vr(ie.messages[0].meta[1][0].data)}})}}),l.sort(function(L,C){return L-C});var h=l.filter(function(L){return L>1}).map(function(L){return[L,me(L)]});c.FileIndex.map(function(L,C){return[L,c.FullPaths[C]]}).forEach(function(L){var C=L[0];if(L[1],!!C.name.match(/\.iwa/)){var O=bt(Ot(C.content));O.forEach(function(W){W.messages.forEach(function(se){h.forEach(function(oe){W.messages.some(function(ie){return Vr(ie.meta[1][0].data)!=11006&&am(ie.data,oe[1])})&&o[oe[0]].deps.push(W.id)})})})}});for(var p=Ee.find(c,o[1].location),u=bt(Ot(p.content)),f,v=0;v<u.length;++v){var d=u[v];d.id==1&&(f=d)}var m=Xt(Ue(f.messages[0].data)[1][0].data);for(p=Ee.find(c,o[m].location),u=bt(Ot(p.content)),v=0;v<u.length;++v)d=u[v],d.id==m&&(f=d);for(m=Xt(Ue(f.messages[0].data)[2][0].data),p=Ee.find(c,o[m].location),u=bt(Ot(p.content)),v=0;v<u.length;++v)d=u[v],d.id==m&&(f=d);for(m=Xt(Ue(f.messages[0].data)[2][0].data),p=Ee.find(c,o[m].location),u=bt(Ot(p.content)),v=0;v<u.length;++v)d=u[v],d.id==m&&(f=d);var S=Ue(f.messages[0].data);{S[6][0].data=me(n.e.r+1),S[7][0].data=me(n.e.c+1);var A=Xt(S[46][0].data),T=Ee.find(c,o[A].location),R=bt(Ot(T.content));{for(var H=0;H<R.length&&R[H].id!=A;++H);if(R[H].id!=A)throw"Bad ColumnRowUIDMapArchive";var K=Ue(R[H].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var k=0;k<=n.e.c;++k){var U=[];U[1]=U[2]=[{type:0,data:me(k+420690)}],K[1].push({type:2,data:qe(U)}),K[2].push({type:0,data:me(k)}),K[3].push({type:0,data:me(k)})}K[4]=[],K[5]=[],K[6]=[];for(var P=0;P<=n.e.r;++P)U=[],U[1]=U[2]=[{type:0,data:me(P+726270)}],K[4].push({type:2,data:qe(U)}),K[5].push({type:0,data:me(P)}),K[6].push({type:0,data:me(P)});R[H].messages[0].data=qe(K)}T.content=Pr(Fr(R)),T.size=T.content.length,delete S[46];var V=Ue(S[4][0].data);{V[7][0].data=me(n.e.r+1);var G=Ue(V[1][0].data),q=Xt(G[2][0].data);T=Ee.find(c,o[q].location),R=bt(Ot(T.content));{if(R[0].id!=q)throw"Bad HeaderStorageBucket";var te=Ue(R[0].messages[0].data);for(P=0;P<s.length;++P){var ye=Ue(te[2][0].data);ye[1][0].data=me(P),ye[4][0].data=me(s[P].length),te[2][P]={type:te[2][0].type,data:qe(ye)}}R[0].messages[0].data=qe(te)}T.content=Pr(Fr(R)),T.size=T.content.length;var ue=Xt(V[2][0].data);T=Ee.find(c,o[ue].location),R=bt(Ot(T.content));{if(R[0].id!=ue)throw"Bad HeaderStorageBucket";for(te=Ue(R[0].messages[0].data),k=0;k<=n.e.c;++k)ye=Ue(te[2][0].data),ye[1][0].data=me(k),ye[4][0].data=me(n.e.r+1),te[2][k]={type:te[2][0].type,data:qe(ye)};R[0].messages[0].data=qe(te)}T.content=Pr(Fr(R)),T.size=T.content.length;var Ge=Xt(V[4][0].data);(function(){for(var L=Ee.find(c,o[Ge].location),C=bt(Ot(L.content)),O,W=0;W<C.length;++W){var se=C[W];se.id==Ge&&(O=se)}var oe=Ue(O.messages[0].data);{oe[3]=[];var ie=[];a.forEach(function(de,nt){ie[1]=[{type:0,data:me(nt)}],ie[2]=[{type:0,data:me(1)}],ie[3]=[{type:2,data:sm(de)}],oe[3].push({type:2,data:qe(ie)})})}O.messages[0].data=qe(oe);var Q=Fr(C),Te=Pr(Q);L.content=Te,L.size=L.content.length})();var Pe=Ue(V[3][0].data);{var At=Pe[1][0];delete Pe[2];var $e=Ue(At.data);{var wt=Xt($e[2][0].data);(function(){for(var L=Ee.find(c,o[wt].location),C=bt(Ot(L.content)),O,W=0;W<C.length;++W){var se=C[W];se.id==wt&&(O=se)}var oe=Ue(O.messages[0].data);{delete oe[6],delete Pe[7];var ie=new Uint8Array(oe[5][0].data);oe[5]=[];for(var Q=0,Te=0;Te<=n.e.r;++Te){var de=Ue(ie);Q+=cm(de,s[Te],a),de[1][0].data=me(Te),oe[5].push({data:qe(de),type:2})}oe[1]=[{type:0,data:me(n.e.c+1)}],oe[2]=[{type:0,data:me(n.e.r+1)}],oe[3]=[{type:0,data:me(Q)}],oe[4]=[{type:0,data:me(n.e.r+1)}]}O.messages[0].data=qe(oe);var nt=Fr(C),ve=Pr(nt);L.content=ve,L.size=L.content.length})()}At.data=qe($e)}V[3][0].data=qe(Pe)}S[4][0].data=qe(V)}f.messages[0].data=qe(S);var ut=Fr(u),b=Pr(ut);return p.content=b,p.size=p.content.length,c}function um(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Cs(t){um([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function fm(t,e){return e.bookType=="ods"?Wl(t,e):e.bookType=="numbers"?hm(t,e):e.bookType=="xlsb"?dm(t,e):pm(t,e)}function dm(t,e){Ur=1024,t&&!t.SSF&&(t.SSF=ht(Fe)),t&&t.SSF&&(gi(),pi(t.SSF),e.revssf=vi(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,hn?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Sl.indexOf(e.bookType)>-1,i=Qo();Cs(e=e||{});var s=ds(),a="",o=0;if(e.cellXfs=[],ir(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",fe(s,a,nl(t.Props,e)),i.coreprops.push(a),xe(e.rels,2,a,pe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,fe(s,a,sl(t.Props)),i.extprops.push(a),xe(e.rels,3,a,pe.EXT_PROPS),t.Custprops!==t.Props&&Qe(t.Custprops||{}).length>0&&(a="docProps/custom.xml",fe(s,a,al(t.Custprops)),i.custprops.push(a),xe(e.rels,4,a,pe.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],u=(p||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,fe(s,a,vv(o-1,a,e,t,h)),i.sheets.push(a),xe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,pe.WS[0])}if(p){var f=p["!comments"],v=!1,d="";f&&f.length>0&&(d="xl/comments"+o+"."+r,fe(s,d,_v(f,d)),i.comments.push(d),xe(h,-1,"../comments"+o+"."+r,pe.CMNT),v=!0),p["!legacy"]&&v&&fe(s,"xl/drawings/vmlDrawing"+o+".vml",El(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&fe(s,tl(a),Wr(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,fe(s,a,xv(e.Strings,a,e)),i.strs.push(a),xe(e.wbrels,-1,"sharedStrings."+r,pe.SST)),a="xl/workbook."+r,fe(s,a,gv(t,a)),i.workbooks.push(a),xe(e.rels,1,a,pe.WB),a="xl/theme/theme1.xml",fe(s,a,wl(t.Themes,e)),i.themes.push(a),xe(e.wbrels,-1,"theme/theme1.xml",pe.THEME),a="xl/styles."+r,fe(s,a,mv(t,a,e)),i.styles.push(a),xe(e.wbrels,-1,"styles."+r,pe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",fe(s,a,t.vbaraw),i.vba.push(a),xe(e.wbrels,-1,"vbaProject.bin",pe.VBA)),a="xl/metadata."+r,fe(s,a,wv(a)),i.metadata.push(a),xe(e.wbrels,-1,"metadata."+r,pe.XLMETA),fe(s,"[Content_Types].xml",el(i,e)),fe(s,"_rels/.rels",Wr(e.rels)),fe(s,"xl/_rels/workbook."+r+".rels",Wr(e.wbrels)),delete e.revssf,delete e.ssf,s}function pm(t,e){Ur=1024,t&&!t.SSF&&(t.SSF=ht(Fe)),t&&t.SSF&&(gi(),pi(t.SSF),e.revssf=vi(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,hn?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Sl.indexOf(e.bookType)>-1,i=Qo();Cs(e=e||{});var s=ds(),a="",o=0;if(e.cellXfs=[],ir(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",fe(s,a,nl(t.Props,e)),i.coreprops.push(a),xe(e.rels,2,a,pe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,fe(s,a,sl(t.Props)),i.extprops.push(a),xe(e.rels,3,a,pe.EXT_PROPS),t.Custprops!==t.Props&&Qe(t.Custprops||{}).length>0&&(a="docProps/custom.xml",fe(s,a,al(t.Custprops)),i.custprops.push(a),xe(e.rels,4,a,pe.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},u=t.Sheets[t.SheetNames[o-1]],f=(u||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,fe(s,a,Pl(o-1,e,t,p)),i.sheets.push(a),xe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,pe.WS[0])}if(u){var v=u["!comments"],d=!1,m="";if(v&&v.length>0){var S=!1;v.forEach(function(A){A[1].forEach(function(T){T.T==!0&&(S=!0)})}),S&&(m="xl/threadedComments/threadedComment"+o+"."+r,fe(s,m,Gd(v,h,e)),i.threadedcomments.push(m),xe(p,-1,"../threadedComments/threadedComment"+o+"."+r,pe.TCMNT)),m="xl/comments"+o+"."+r,fe(s,m,Tl(v)),i.comments.push(m),xe(p,-1,"../comments"+o+"."+r,pe.CMNT),d=!0}u["!legacy"]&&d&&fe(s,"xl/drawings/vmlDrawing"+o+".vml",El(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}p["!id"].rId1&&fe(s,tl(a),Wr(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,fe(s,a,pl(e.Strings,e)),i.strs.push(a),xe(e.wbrels,-1,"sharedStrings."+r,pe.SST)),a="xl/workbook."+r,fe(s,a,Ll(t)),i.workbooks.push(a),xe(e.rels,1,a,pe.WB),a="xl/theme/theme1.xml",fe(s,a,wl(t.Themes,e)),i.themes.push(a),xe(e.wbrels,-1,"theme/theme1.xml",pe.THEME),a="xl/styles."+r,fe(s,a,xl(t,e)),i.styles.push(a),xe(e.wbrels,-1,"styles."+r,pe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",fe(s,a,t.vbaraw),i.vba.push(a),xe(e.wbrels,-1,"vbaProject.bin",pe.VBA)),a="xl/metadata."+r,fe(s,a,yl()),i.metadata.push(a),xe(e.wbrels,-1,"metadata."+r,pe.XLMETA),h.length>1&&(a="xl/persons/person.xml",fe(s,a,Kd(h)),i.people.push(a),xe(e.wbrels,-1,"persons/person.xml",pe.PEOPLE)),fe(s,"[Content_Types].xml",el(i,e)),fe(s,"_rels/.rels",Wr(e.rels)),fe(s,"xl/_rels/workbook."+r+".rels",Wr(e.wbrels)),delete e.revssf,delete e.ssf,s}function gm(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Gt(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Hl(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return bn(e.file,Ee.write(t,{type:ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ee.write(t,e)}function vm(t,e){var r=ht(e||{}),n=fm(t,r);return mm(n,r)}function mm(t,e){var r={},n=ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Ee.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(di(i))}return e.password&&typeof encrypt_agile<"u"?Hl(encrypt_agile(i,e.password),e):e.type==="file"?bn(e.file,i):e.type=="string"?an(i):i}function xm(t,e){var r=e||{},n=Nv(t,r);return Hl(n,r)}function Lt(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xn(wn(n));case"binary":return wn(n);case"string":return t;case"file":return bn(e.file,n,"utf8");case"buffer":return ge?qt(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Lt(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _m(t,e){switch(e.type){case"base64":return xn(t);case"binary":return t;case"string":return t;case"file":return bn(e.file,t,"binary");case"buffer":return ge?qt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vn(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xn(r):e.type=="string"?an(r):r;case"file":return bn(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Vl(t,e){Kh(),iv(t);var r=ht(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Vl(t,r);return r.type="array",di(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Lt(Fv(t,r),r);case"slk":case"sylk":return Lt(td.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Lt(Ul(t.Sheets[t.SheetNames[i]],r),r);case"txt":return _m(Gl(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Lt(Rs(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Lt(rd.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Vn(ed.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Lt(nd.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Lt(hd.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Lt(dl.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Lt(Wl(t,r),r);case"wk1":return Vn(ja.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Vn(ja.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Vn(Ml(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),xm(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vm(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function wm(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function ym(t,e,r){var n={};return n.type="file",n.file=e,wm(n),Vl(t,n)}function Em(t,e,r,n,i,s,a,o){var l=Ze(r),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,u=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!a||t[r])for(var f=e.s.c;f<=e.e.c;++f){var v=a?t[r][f]:t[n[f]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[f]!=null&&(u[s[f]]=c);continue}var d=v.v;switch(v.t){case"z":if(d==null)break;continue;case"e":d=d==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[f]!=null){if(d==null)if(v.t=="e"&&d===null)u[s[f]]=null;else if(c!==void 0)u[s[f]]=c;else if(h&&d===null)u[s[f]]=null;else continue;else u[s[f]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?d:Kt(v,d,o);d!=null&&(p=!1)}}return{row:u,isempty:p}}function ci(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof h){case"string":l=Ae(h);break;case"number":l=Ae(t["!ref"]),l.s.r=h;break;default:l=h}n>0&&(i=0);var p=Ze(l.s.r),u=[],f=[],v=0,d=0,m=Array.isArray(t),S=l.s.r,A=0,T={};m&&!t[S]&&(t[S]=[]);var R=c.skipHidden&&t["!cols"]||[],H=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(R[A]||{}).hidden)switch(u[A]=tt(A),r=m?t[S][A]:t[u[A]+p],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=u[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Kt(r,null,c),d=T[a]||0,!d)T[a]=1;else{do o=a+"_"+d++;while(T[o]);T[a]=d,T[o]=1}s[A]=o}for(S=l.s.r+i;S<=l.e.r;++S)if(!(H[S]||{}).hidden){var K=Em(t,l,S,u,n,s,m,c);(K.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(f[v++]=K.row)}return f.length=v,f}var Xa=/"/g;function Tm(t,e,r,n,i,s,a,o){for(var l=!0,c=[],h="",p=Ze(r),u=e.s.c;u<=e.e.c;++u)if(n[u]){var f=o.dense?(t[r]||[])[u]:t[n[u]+p];if(f==null)h="";else if(f.v!=null){l=!1,h=""+(o.rawNumbers&&f.t=="n"?f.v:Kt(f,null,o));for(var v=0,d=0;v!==h.length;++v)if((d=h.charCodeAt(v))===i||d===s||d===34||o.forceQuotes){h='"'+h.replace(Xa,'""')+'"';break}h=="ID"&&(h='"ID"')}else f.f!=null&&!f.F?(l=!1,h="="+f.f,h.indexOf(",")>=0&&(h='"'+h.replace(Xa,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function Rs(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ae(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",p=[];n.dense=Array.isArray(t);for(var u=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(u[v]||{}).hidden||(p[v]=tt(v));for(var d=0,m=i.s.r;m<=i.e.r;++m)(f[m]||{}).hidden||(h=Tm(t,i,m,p,a,l,s,n),h!=null&&(n.strip&&(h=h.replace(c,"")),(h||n.blankrows!==!1)&&r.push((d++?o:"")+h)));return delete n.dense,r.join("")}function Gl(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Rs(t,e);return r}function Sm(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ae(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=tt(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Ze(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Kl(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?He(n.origin):n.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=Ae(s["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),a==-1&&(a=p.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var u=n.header||[],f=0;e.forEach(function(d,m){Qe(d).forEach(function(S){(f=u.indexOf(S))==-1&&(u[f=u.length]=S);var A=d[S],T="z",R="",H=we({c:o+f,r:a+m+i});c=Tn(s,H),A&&typeof A=="object"&&!(A instanceof Date)?s[H]=A:(typeof A=="number"?T="n":typeof A=="boolean"?T="b":typeof A=="string"?T="s":A instanceof Date?(T="d",n.cellDates||(T="n",A=ct(A)),R=n.dateNF||Fe[14]):A===null&&n.nullError&&(T="e",A=0),c?(c.t=T,c.v=A,delete c.w,delete c.R,R&&(c.z=R)):s[H]=c={t:T,v:A},R&&(c.z=R))})}),h.e.c=Math.max(h.e.c,o+u.length-1);var v=Ze(a);if(i)for(f=0;f<u.length;++f)s[tt(f+o)+v]={t:"s",v:u[f]};return s["!ref"]=Le(h),s}function Am(t,e){return Kl(null,t,e)}function Tn(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=He(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Tn(t,we(e)):Tn(t,we({r:e,c:r||0}))}function bm(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Om(){return{SheetNames:[],Sheets:{}}}function km(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Dl(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Cm(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=bm(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Rm(t,e){return t.z=e,t}function zl(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Im(t,e,r){return zl(t,"#"+e,r)}function Fm(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Pm(t,e,r,n){for(var i=typeof e!="string"?e:Ae(e),s=typeof e=="string"?e:Le(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Tn(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Hi={encode_col:tt,encode_row:Ze,encode_cell:we,encode_range:Le,decode_col:_s,decode_row:xs,split_cell:Ku,decode_cell:He,decode_range:_t,format_cell:Kt,sheet_add_aoa:zo,sheet_add_json:Kl,sheet_add_dom:$l,aoa_to_sheet:zr,json_to_sheet:Am,table_to_sheet:jl,table_to_book:rm,sheet_to_csv:Rs,sheet_to_txt:Gl,sheet_to_json:ci,sheet_to_html:Ul,sheet_to_formulae:Sm,sheet_to_row_object_array:ci,sheet_get_cell:Tn,book_new:Om,book_append_sheet:km,book_set_sheet_visibility:Cm,cell_set_number_format:Rm,cell_set_hyperlink:zl,cell_set_internal_link:Im,cell_add_comment:Fm,sheet_set_array_formula:Pm,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Nm=t=>{const e=[];t.forEach(s=>{const a={" ":s.id," ":s.name," ":s.seller_name,:s.address,:s.phone,:s.region," ":s.ideal_time," ":s.purchase_prob,:s.description," ":s.visited?"":""};s.orders&&s.orders.length>0?s.orders.forEach(o=>{let l="";o.items&&Array.isArray(o.items)&&(l=o.items.map(c=>`${c.productName} (${c.count})`).join(", ")),e.push({...a," ":o.date," ":l," ":o.text," ":o.id})}):e.push({...a," ":"-"," ":"-"," ":"-"," ":"-"})});const r=Hi.json_to_sheet(e),n=Hi.book_new();Hi.book_append_sheet(n,r,"Reports");const i=Object.keys(e[0]||{}).map(s=>({wch:20}));r["!cols"]=i,ym(n,`Moyragi_Report_${new Date().toISOString().slice(0,10)}.xlsx`)},Gn={data:{stores:[],regions:[],products:[]},currentOrderItems:[],daysMap:{6:"",0:"",1:"",2:"",3:"",4:"",5:""},idealTimeMap:{morning:"",noon:"",night:""},async init(){await this.refreshData(),this.renderStores(),this.renderRegions(),this.setupEventListeners()},async refreshData(){try{const[t,e,r]=await Promise.all([ot.getStores(),ot.getRegions(),ot.getProducts()]);this.data.stores=t||[],this.data.regions=e||[],this.data.products=r||[]}catch(t){console.error("Error loading data:",t),alert("   .    .")}},setupEventListeners(){document.getElementById("searchInput").addEventListener("input",()=>this.renderStores()),document.getElementById("filterDay").addEventListener("change",()=>this.renderStores()),document.getElementById("filterRegion").addEventListener("change",()=>this.renderStores()),document.getElementById("filterProb").addEventListener("change",()=>this.renderStores()),document.getElementById("addStoreBtn").addEventListener("click",()=>this.openAddStoreModal()),document.getElementById("resetDailyBtn").addEventListener("click",()=>this.handleResetDaily()),document.getElementById("saveStoreBtn").addEventListener("click",()=>this.handleSaveStore()),document.getElementById("addRegionBtn").addEventListener("click",()=>this.handleAddRegion()),document.getElementById("addProductBtn").addEventListener("click",()=>this.handleAddProduct()),document.getElementById("exportExcelBtn").addEventListener("click",()=>Nm(this.data.stores)),document.getElementById("addOrderItemBtn").addEventListener("click",()=>this.addOrderItem()),document.getElementById("orderCountDown").addEventListener("click",()=>{const t=document.getElementById("orderCartonCount");t.value>1&&t.value--}),document.getElementById("orderCountUp").addEventListener("click",()=>{const t=document.getElementById("orderCartonCount");t.value++}),document.getElementById("saveOrderBtn").addEventListener("click",()=>this.handleSaveOrder()),document.getElementById("dailySalesBtn").addEventListener("click",()=>this.showDailySales()),document.getElementById("ordersViewBtn").addEventListener("click",()=>this.switchView("orders")),document.getElementById("backToDashboardBtn").addEventListener("click",()=>this.switchView("dashboard")),document.getElementById("orderDateFilter").addEventListener("change",()=>this.renderAllOrders()),document.getElementById("logoutBtn").addEventListener("click",async()=>{await Jt.logout()})},switchView(t){const e=document.getElementById("dashboardView"),r=document.getElementById("ordersView"),n=document.getElementById("fabContainer");t==="dashboard"?(e.classList.remove("d-none"),r.classList.add("d-none"),n.classList.remove("d-none"),this.renderStores()):t==="orders"&&(e.classList.add("d-none"),r.classList.remove("d-none"),n.classList.add("d-none"),this.renderAllOrders())},renderStores(){const t=document.getElementById("storesContainer"),e=document.getElementById("emptyState");t.querySelector(".spinner-border"),t.innerHTML="";const r=document.getElementById("filterDay").value,n=document.getElementById("filterRegion").value,i=document.getElementById("filterProb").value,s=document.getElementById("searchInput").value.trim().toLowerCase(),a=new Date().getDay(),o=this.data.stores.filter(l=>s&&!(l.name.toLowerCase().includes(s)||l.address&&l.address.toLowerCase().includes(s))||n!=="all"&&l.region!==n||i!=="all"&&l.purchase_prob!==i?!1:r==="all"?!0:r==="today"?l.visit_days&&l.visit_days.includes(a):l.visit_days&&l.visit_days.includes(parseInt(r)));if(o.length===0){e.classList.remove("d-none");return}e.classList.add("d-none"),o.forEach(l=>{let c="";if(l.visit_days&&l.visit_days.sort().forEach(u=>{c+=`<span class="badge ${u===a?"bg-primary":"bg-secondary"} me-1">${this.daysMap[u]}</span>`}),l.ideal_time&&(c+=`<span class="badge bg-info text-dark me-1"><i class="bi bi-clock"></i> ${this.idealTimeMap[l.ideal_time]}</span>`),l.purchase_prob){const u=l.purchase_prob==="high"?" : ":" : ",f=l.purchase_prob==="high"?"bg-success":"bg-warning text-dark";c+=`<span class="badge ${f} me-1"><i class="bi bi-graph-up"></i> ${u}</span>`}let h="";l.orders&&l.orders.length>0&&(h='<div class="order-history"><strong>  :</strong><ul class="list-unstyled mb-0 mt-1">',l.orders.slice(0,3).forEach(u=>{let f="";u.items&&u.items.length>0&&(f=u.items.map(v=>`${v.count} ${this.escapeHtml(v.productName)}`).join(" "),f=`<div class="text-primary smaller" style="font-size:0.75rem">${f}</div>`),h+=`
                        <li class="d-flex flex-column mb-2 border-bottom pb-1">
                            <div class="d-flex justify-content-between text-muted small">
                                <span>${this.escapeHtml(u.date)}: ${this.escapeHtml(u.text)}</span>
                                <div class="d-flex">
                                    <button class="btn btn-link btn-sm p-0 text-decoration-none me-2" data-action="edit-order" data-store-id="${l.id}" data-order-id="${u.id}">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button class="btn btn-link btn-sm p-0 text-decoration-none text-danger" data-action="delete-order" data-order-id="${u.id}">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                            ${f}
                        </li>
                    `}),h+="</ul></div>");const p=document.createElement("div");p.className="col-md-6 col-lg-4",p.innerHTML=`
                <div class="card h-100 ${l.visited?"visited":""}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <h5 class="card-title fw-bold mb-0">${this.escapeHtml(l.name)}</h5>
                                <button class="btn btn-link btn-sm p-0 text-decoration-none" data-action="edit-store" data-store-id="${l.id}">
                                    <i class="bi bi-pencil-square"></i> 
                                </button>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" ${l.visited?"checked":""} data-action="toggle-visit" data-store-id="${l.id}">
                            </div>
                        </div>
                        <h6 class="card-subtitle mb-2 text-muted"><i class="bi bi-geo-alt-fill"></i> ${this.escapeHtml(l.region)}</h6>
                        <p class="card-text small mb-2">${this.escapeHtml(l.address)||" "}</p>
                        ${l.description?`<p class="card-text small mb-2 text-muted">${this.escapeHtml(l.description)}</p>`:""}
                        ${l.seller_name?`<p class="card-text small mb-2"><i class="bi bi-person"></i> ${this.escapeHtml(l.seller_name)}</p>`:""}
                        ${l.phone?`<p class="card-text small mb-2"><i class="bi bi-telephone"></i> <a href="tel:${this.escapeHtml(l.phone)}" class="text-decoration-none">${this.escapeHtml(l.phone)}</a></p>`:""}

                        <div class="mb-3">${c}</div>
                        <button class="btn btn-sm btn-outline-primary w-100" data-action="new-order" data-store-id="${l.id}">
                            <i class="bi bi-cart-plus"></i>  
                        </button>
                        ${h}
                    </div>
                </div>
            `,t.appendChild(p)})},renderRegions(){const t=document.getElementById("regionList"),e=document.getElementById("filterRegion"),r=document.getElementById("storeRegion");t.innerHTML="";const n=e.value;e.innerHTML='<option value="all"> </option>',r.innerHTML="",this.data.regions.forEach(i=>{const s=document.createElement("li");s.className="list-group-item d-flex justify-content-between align-items-center",s.innerHTML=`
                ${this.escapeHtml(i.name)}
                <button class="btn btn-sm btn-outline-danger" data-action="delete-region" data-id="${i.id}">
                    <i class="bi bi-trash"></i>
                </button>
            `,t.appendChild(s);const a=document.createElement("option");a.value=i.name,a.textContent=i.name,e.appendChild(a);const o=document.createElement("option");o.value=i.name,o.textContent=i.name,r.appendChild(o)}),e.value=n,this.renderProducts()},renderProducts(){const t=document.getElementById("productList"),e=document.getElementById("orderProductSelect");t.innerHTML="",e.innerHTML='<option value=""> ...</option>',this.data.products.forEach(r=>{const n=document.createElement("li");n.className="list-group-item d-flex justify-content-between align-items-center",n.innerHTML=`
                ${this.escapeHtml(r.name)}
                <button class="btn btn-sm btn-outline-danger" data-action="delete-product" data-id="${r.id}">
                    <i class="bi bi-trash"></i>
                </button>
            `,t.appendChild(n);const i=document.createElement("option");i.value=r.id,i.textContent=r.name,i.dataset.name=r.name,e.appendChild(i)})},renderAllOrders(){const t=document.getElementById("allOrdersList"),e=document.getElementById("noOrdersMsg"),r=document.getElementById("orderDateFilter").value;let n=[];if(this.data.stores.forEach(i=>{i.orders&&i.orders.forEach(s=>{n.push({...s,storeName:i.name,storeAddress:i.address,storeId:i.id})})}),r){const[i,s,a]=r.split("-"),o=new Date(i,s-1,a).toLocaleDateString("fa-IR");n=n.filter(l=>l.date===o)}n.sort((i,s)=>new Date(s.created_at)-new Date(i.created_at)),t.innerHTML="",n.length===0?e.classList.remove("d-none"):(e.classList.add("d-none"),n.forEach(i=>{let s="-";i.items&&i.items.length&&(s=i.items.map(o=>`${o.count} ${this.escapeHtml(o.productName)}`).join(" "));const a=document.createElement("tr");a.innerHTML=`
                    <td>${this.escapeHtml(i.date)}</td>
                    <td>${this.escapeHtml(i.storeName)}</td>
                    <td><small class="text-muted">${this.escapeHtml(i.storeAddress||"-")}</small></td>
                    <td><small>${s}</small></td>
                    <td><small class="text-muted">${this.escapeHtml(i.text)}</small></td>
                    <td class="text-end">
                        <button class="btn btn-sm btn-outline-primary me-1" data-action="edit-order" data-store-id="${i.storeId}" data-order-id="${i.id}">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" data-action="delete-order" data-order-id="${i.id}">
                            <i class="bi bi-trash"></i>
                        </button>
                    </td>
                `,t.appendChild(a)}))},async handleGlobalClick(t){const e=t.target.closest("button")||t.target.closest('input[type="checkbox"]');if(!e)return;const r=e.dataset.action;if(r)if(r==="toggle-visit"){const n=e.dataset.storeId,i=e.checked;await ot.toggleVisit(n,i);const s=this.data.stores.find(a=>a.id==n);s&&(s.visited=i),this.renderStores()}else r==="delete-region"?confirm(" ")&&(await ot.deleteRegion(e.dataset.id),await this.refreshData(),this.renderRegions(),this.renderStores()):r==="delete-product"?confirm(" ")&&(await ot.deleteProduct(e.dataset.id),await this.refreshData(),this.renderRegions()):r==="edit-store"?this.openAddStoreModal(e.dataset.storeId):r==="new-order"?this.openOrderModal(e.dataset.storeId):r==="edit-order"?this.openOrderModal(e.dataset.storeId,e.dataset.orderId):r==="delete-order"&&confirm("  ")&&(await ot.deleteOrder(e.dataset.orderId),await this.refreshData(),this.currentView==="orders"?this.renderAllOrders():this.renderStores())},openAddStoreModal(t=null){if(document.getElementById("addStoreForm").reset(),document.querySelectorAll(".store-day-check").forEach(r=>r.checked=!1),t){const r=this.data.stores.find(n=>n.id==t);r&&(document.getElementById("storeId").value=r.id,document.getElementById("storeName").value=r.name,document.getElementById("storeDescription").value=r.description||"",document.getElementById("storeSellerName").value=r.seller_name||"",document.getElementById("storeAddress").value=r.address||"",document.getElementById("storePhone").value=r.phone||"",document.getElementById("storeRegion").value=r.region,document.getElementById("storeIdealTime").value=r.ideal_time||"",document.getElementById("storePurchaseProb").value=r.purchase_prob||"",document.getElementById("storeModalTitle").textContent=" ",r.visit_days&&r.visit_days.forEach(n=>{const i=document.getElementById(`d${n}`);i&&(i.checked=!0)}))}else document.getElementById("storeId").value="",document.getElementById("storeModalTitle").textContent="  ";new bootstrap.Modal(document.getElementById("addStoreModal")).show()},async handleSaveStore(){const t=document.getElementById("storeId").value,e=document.getElementById("storeName").value.trim(),r=document.getElementById("storeRegion").value;if(!e||!r){alert("    .");return}const n=[];document.querySelectorAll(".store-day-check:checked").forEach(s=>n.push(parseInt(s.value)));const i={name:e,region:r,description:document.getElementById("storeDescription").value,sellerName:document.getElementById("storeSellerName").value,address:document.getElementById("storeAddress").value,phone:document.getElementById("storePhone").value,idealTime:document.getElementById("storeIdealTime").value,purchaseProb:document.getElementById("storePurchaseProb").value,visitDays:n};try{t?await ot.updateStore(t,i):await ot.addStore(i),bootstrap.Modal.getInstance(document.getElementById("addStoreModal")).hide(),await this.refreshData(),this.renderStores()}catch(s){console.error(s),alert("   ")}},async handleAddRegion(){const t=document.getElementById("newRegionInput").value.trim();if(t)try{await ot.addRegion(t),document.getElementById("newRegionInput").value="",await this.refreshData(),this.renderRegions()}catch(e){console.error(e),alert("")}},async handleAddProduct(){const t=document.getElementById("newProductInput").value.trim();if(t)try{await ot.addProduct(t),document.getElementById("newProductInput").value="",await this.refreshData(),this.renderRegions()}catch(e){console.error(e),alert("")}},async handleResetDaily(){confirm("      .")&&(await ot.resetDailyVisits(),await this.refreshData(),this.renderStores())},openOrderModal(t,e=null){if(document.getElementById("orderStoreId").value=t,document.getElementById("orderId").value=e||"",document.getElementById("orderText").value="",document.getElementById("orderCartonCount").value=1,this.currentOrderItems=[],e){const r=this.data.stores.find(i=>i.id==t),n=r==null?void 0:r.orders.find(i=>i.id==e);n&&(document.getElementById("orderText").value=n.text||"",this.currentOrderItems=JSON.parse(JSON.stringify(n.items||[])))}this.renderOrderItems(),new bootstrap.Modal(document.getElementById("orderModal")).show()},addOrderItem(){var s;const t=document.getElementById("orderProductSelect"),e=t.value,r=(s=t.options[t.selectedIndex])==null?void 0:s.text,n=parseInt(document.getElementById("orderCartonCount").value);if(!e){alert("  ");return}const i=this.currentOrderItems.find(a=>a.productId==e);i?i.count+=n:this.currentOrderItems.push({productId:e,productName:r,count:n}),this.renderOrderItems()},renderOrderItems(){const t=document.getElementById("orderItemsList"),e=document.getElementById("noItemsMsg");t.innerHTML="",this.currentOrderItems.length===0?e.classList.remove("d-none"):(e.classList.add("d-none"),this.currentOrderItems.forEach((r,n)=>{const i=document.createElement("tr");i.innerHTML=`
                    <td>${this.escapeHtml(r.productName)}</td>
                    <td>${r.count}</td>
                    <td class="text-end"><button class="btn btn-sm text-danger" onclick="document.dispatchEvent(new CustomEvent('remove-item', {detail: ${n}}))">&times;</button></td>
                `,i.querySelector("button").onclick=()=>{this.currentOrderItems.splice(n,1),this.renderOrderItems()},t.appendChild(i)}))},async handleSaveOrder(){const t=document.getElementById("orderStoreId").value,e=document.getElementById("orderId").value,r=document.getElementById("orderText").value;if(this.currentOrderItems.length===0&&!r){alert("      ");return}const n={date:new Date().toLocaleDateString("fa-IR"),text:r,items:this.currentOrderItems};try{e?await ot.updateOrder(e,n):await ot.addOrder(t,n),bootstrap.Modal.getInstance(document.getElementById("orderModal")).hide(),await this.refreshData(),this.currentView==="orders"?this.renderAllOrders():this.renderStores()}catch(i){console.error(i),alert("   ")}},showDailySales(){const t=new Date().toLocaleDateString("fa-IR");let e=0,r={};this.data.stores.forEach(i=>{i.orders&&i.orders.forEach(s=>{s.date===t&&(e++,s.items&&s.items.forEach(a=>{r[a.productName]=(r[a.productName]||0)+a.count}))})});let n=`<div class="alert alert-info text-center"><h4>${e}</h4><small> </small></div>`;if(Object.keys(r).length){n+='<ul class="list-group">';for(const[i,s]of Object.entries(r))n+=`<li class="list-group-item d-flex justify-content-between">${i} <span class="badge bg-primary">${s}</span></li>`;n+="</ul>"}document.getElementById("dailySalesContent").innerHTML=n,new bootstrap.Modal(document.getElementById("dailySalesModal")).show()},escapeHtml(t){return t&&String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}};document.addEventListener("DOMContentLoaded",async()=>{document.getElementById("loginForm").addEventListener("submit",async e=>{e.preventDefault();const r=document.getElementById("email").value,n=document.getElementById("password").value,i=document.getElementById("loginBtn"),s=document.getElementById("loginLoading"),a=document.getElementById("loginError");i.disabled=!0,s.classList.remove("d-none"),a.textContent="";try{await Jt.login(r,n)}catch(o){console.error(o),a.textContent=" .        ."}finally{i.disabled=!1,s.classList.add("d-none")}}),document.body.addEventListener("click",e=>Gn.handleGlobalClick(e)),document.body.addEventListener("change",e=>Gn.handleGlobalClick(e)),await Jt.init(),Jt.user&&await Gn.init();const t=Jt.updateUI.bind(Jt);Jt.updateUI=()=>{t(),Jt.user&&Gn.init()}});
